---
title: Audiences
---

import { Button } from '/snippets/fr/button.mdx';

<div id="custom-audiences">
  ## Audiences personnalisées
</div>

<div id="overview">
  ### Vue d’ensemble
</div>

Il existe plusieurs façons pour les partenaires de créer des [audiences personnalisées](https://business.x.com/en/targeting/tailored-audiences.html).

* [API Audience (CRM)](#crm)
* [Web](#web)
* [Mobile](#mobile)
* [Flexible](#flexible)

Veuillez noter que vous ne pouvez pas exclure les audiences similaires (lookalike) du ciblage. De plus, vous ne pouvez pas cibler à la fois une audience personnalisée et une audience similaire au sein du même élément de ligne publicitaire (groupe de publicités).

**Gestion des audiences**

Les audiences peuvent être gérées via des partenaires d’audience et des partenaires de l’API Ads. Nous proposons une série d’endpoints dans l’API pour accéder aux audiences personnalisées et les gérer.

Pour les informations sur les audiences personnalisées, nous proposons 2 endpoints :

* [GET accounts/:account_id/custom_audiences](/fr/x-ads-api/audiences)
* [GET accounts/:account_id/custom_audiences/:custom_audience_id](/fr/x-ads-api/audiences)

Pour plus de détails sur la façon de charger et de gérer des audiences, consultez le [guide de l’API Audience](/fr/x-ads-api/audiences).

**Délais de traitement**

De manière générale, les modifications d’audience sont traitées par lots toutes les 6 à 8 heures. Pendant le traitement d’une modification, l’audience existante à mettre à jour n’est pas affectée. Nous ne recommandons pas d’effectuer plus d’une mise à jour d’ajouts et une mise à jour de suppressions par audience sur cette période.

**Ciblage**

Une audience ne peut être ciblée que si elle correspond à au moins 100 utilisateurs actifs au cours des 90 derniers jours sur les clients détenus et exploités par X. [GET accounts/:account_id/custom_audiences/:custom_audience_id](/fr/x-ads-api/audiences) indiquera si une audience ne peut pas être ciblée parce qu’elle correspond à trop peu d’utilisateurs.

**API Audience (CRM)**

<Frame>
  <img src="https://cdn.cms-twdigitalassets.com/content/dam/developer-twitter/images/crm_0.png" alt="image2" />
</Frame>

Les partenaires d’audience ou d’API fournissent une liste d’identifiants hachés, X effectue la mise en correspondance et produit des segments qui sont mis à disposition pour l’achat média sur X. Les partenaires peuvent créer ces audiences avec l’[API Audience](/fr/x-ads-api/audiences).

**Comment ça marche ?**

<Frame>
  <img src="https://cdn.cms-twdigitalassets.com/content/dam/developer-twitter/images/crm_1.png" alt="image3" />
</Frame>

**Web**

Nous proposons un processus standard d’appariement de cookies lors de la collaboration avec des partenaires d’audience MPP pour identifier des segments à cibler pour l’achat média sur X. De plus, les annonceurs peuvent configurer une [balise d’événement web X](/fr/x-ads-api/measurement/web-conversions#web-event-tags) pour collecter des données d’utilisateurs du site et créer une audience personnalisée correspondante.

**Étapes de configuration**

<Frame>
  <img src="https://cdn.cms-twdigitalassets.com/content/dam/developer-twitter/images/screen_shot_2013-11-26-cookie-usage.png" alt="image0" />
</Frame>

![]()

**Comment ça marche ?**

<Frame>
  <img src="https://cdn.cms-twdigitalassets.com/content/dam/developer-twitter/images/tailored_audience_web.png" alt="image1" />
</Frame>

**Mobile**

Veuillez consulter [l’article de blog “Custom Audiences from Mobile Apps”](https://blog.x.com/2014/introducing-tailored-audiences-from-mobile-apps) pour plus de détails.

**Flexible**

Les [audiences flexibles](/fr/x-ads-api/audiences) donnent aux annonceurs la possibilité de créer et d’enregistrer des combinaisons d’audiences à partir d’audiences personnalisées existantes ou de sous-ensembles de celles-ci. Des sous-ensembles des membres d’une audience personnalisée peuvent être ciblés en fonction de la récence et de la fréquence d’interaction.

**Cas d’utilisation restreints pour les audiences personnalisées**

[En savoir plus sur les restrictions](https://developer.x.com/en/developer-terms/more-on-restricted-use-cases "En savoir plus sur les restrictions")

<div id="audiences-faq">
  ### FAQ sur les audiences[](#real-time-tailored-audiences "Permalink to this headline")
</div>

**Q: Nous avons envoyé une énorme quantité de données, pourquoi la taille de l&#39;audience s&#39;affiche-t-elle comme TOO_SMALL ?**

R: Les données sont actuellement ajoutées à l&#39;audience en temps réel, mais la tâche qui traite les données pour calculer la taille de l&#39;audience ne s’exécute qu’après un certain délai. La taille correcte de l’audience devrait s’afficher dans l’interface au bout de quelques heures.

**Q: Nous avons fini d’envoyer les données d’audience et attendu 24 heures ou plus, mais nous ne pouvons toujours pas cibler l’audience — quelles sont les étapes suivantes ?**

R: Veuillez vérifier les points suivants :

* L’ID utilisateur transmis est correct et non corrompu.
* Les noms d’audience transmis sont corrects et correspondent aux mises à jour d’appartenance précédentes.
* Vérifiez la réponse renvoyée par les commandes POST.
* Vérifiez que le pixel ID Sync est correctement implémenté et que, comme décrit par le processus ID Sync, un nombre suffisant d’utilisateurs ont visité le site concerné pour permettre le mappage. Les utilisateurs non mappés dans les mises à jour d’appartenance ne seront pas convertis en utilisateurs ciblés.

Si tout le reste est confirmé comme correct et fonctionnel, veuillez contacter vos interlocuteurs produit chez X avec des informations aussi détaillées que possible (voir le [Guide to Partner Inbounds](/fr/x-ads-api/introduction) pour un exemple d’informations attendues).

**Q: Combien de fois pouvons-nous appeler l’endpoint, et avec quel algorithme ?**

R: Nous recommandons fortement d’appeler notre système avec des deltas incrémentaux et de ne jamais renvoyer l’ensemble complet des appartenances à l’audience. Le système a été testé pour offrir un débit suffisant afin de traiter des mises à jour de données incrémentielles pour certains des plus grands sites web au monde. Le chargement initial des audiences doit être soigneusement régulé et ce premier envoi devrait prendre un temps significatif à se terminer.

**Q: Quelle est la taille minimale d’une audience pour être utilisée pour le ciblage ?**

* La taille minimale d’une audience est de 100 utilisateurs (après correspondance). Si une audience de moins de 500 utilisateurs est appariée, elle ne sera pas disponible pour le ciblage dans l’interface X Ads.

**Q: Combien de temps faut-il pour traiter les fichiers d’audience ? Et combien de temps avant qu’ils soient prêts dans l’interface utilisateur X ?**

* Le traitement des fichiers d’audience prend généralement 4 à 6 heures, mais cela dépend de la taille du fichier. Une fois le fichier traité, les audiences sont disponibles dans l’interface X Ads.

**Q: Comment le taux de correspondance est-il calculé ?**

* Taux de correspondance = utilisateurs X actifs sur 90 jours / nombre d’utilisateurs fournis

**Q: Comment tester si un fichier d’audience fonctionne correctement ?**

* Vous pouvez fournir un fichier d’audience de test et utiliser “keltonlynn” comme handle annonceur. Nous pourrons alors vérifier que le fichier peut être correctement ingéré et chargé dans l’interface X.

**Q: Qu’est-ce qu’un identifiant utilisateur partenaire (`p_user_id`) ?**

* Il s’agit de l’identifiant utilisé par votre entreprise pour identifier de manière unique chacun de vos clients.

**Q: Qu’est-ce qu’un ID standard ?**

* Il peut s’agir d’une adresse e-mail, d’un ID d’appareil, d’un @handle X ou d’un ID.

**Q: Comment obtenir la clé HMAC ?**

* Elle sera fournie par e-mail chiffré. Veuillez fournir votre clé PGP publique à [mpp-inquiry@x.com](mailto:mpp-inquiry@x.com) ou à [mpp-inquiry%x.com](mailto:mpp-inquiry%x.com) et nous vous enverrons un e-mail de test pour vérifier que tout fonctionne. Une fois vérifié, nous vous enverrons la clé HMAC.

**Q: Comment vérifier que le processus de hachage a fonctionné avec la clé HMAC fournie ?**

* X fournira un fichier de test (contenant des adresses e-mail d’exemple, des IDs d’appareil, etc.) et un fichier de hachage résultant contre lequel vous pourrez comparer vos résultats.

**Q: Existe-t-il une limite de taille pour le fichier d’appariement de données complet ?**

* Non, il n’y a pas de limite de taille pour le fichier d’appariement de données complet.

**Q: Combien de temps faudra-t-il pour que le fichier d’appariement de données complet soit traité ?**

* Une fois le fichier reçu par X, il faudra environ 1 jour pour le traiter.

<div id="crm">
  ### CRM
</div>

<Frame>
  <img src="https://cdn.cms-twdigitalassets.com/content/dam/developer-twitter/images/crm_0.png" alt="image0" />
</Frame>

Ce document décrit les modalités d’intégration pour les partenaires CRM d’Audiences personnalisées, notamment les formats de fichiers et le processus d’échange de données.

**Résumé**

L’entreprise fournira, au nom d’un client, une liste d’identifiants utilisateur courants hachés (p. ex., adresses e‑mail) ou d’identifiants utilisateur du partenaire à X afin d’effectuer une mise en correspondance à l’aveugle et de produire une liste d’identifiants d’utilisateurs X à des fins de ciblage. Les segments de ciblage seront mis à la disposition du @handle spécifique de l’annonceur, indiqué par le nom de fichier lors de la configuration de la campagne sur ads.x.com.

Tous les fichiers provenant de l’entreprise seront fournis à X via un paquet sécurisé sur IronBox (www.golockbox.com) au moyen d’un compte spécifique accordé à l’entreprise par X. X fournira l’accès à IronBox. La documentation relative aux API IronBox est disponible à l’adresse suivante : [https://secure.goironcloud.com/Docs/Help/](https://secure.goironcloud.com/Docs/Help/).

<div id="partner-id-matching-requirements">
  #### Exigences de correspondance d’ID partenaire
</div>

Si l’entreprise utilise son propre système d’ID pour suivre les utilisateurs (c’est‑à‑dire des identifiants autres que les identifiants courants comme les adresses e‑mail, les identifiants d’appareil, l’ID utilisateur X, etc.), voici le processus recommandé.

**1. Correspondance de données complète**

Au départ, l’entreprise fournira, dans un unique fichier, une liste exhaustive de tous les enregistrements utilisateurs incluant un identifiant d’utilisateur courant unique partagé avec X, afin d’effectuer une correspondance de données complète et de produire un mappage, stocké par X, des ID partenaire (`p_user_id`) vers les ID X (`tw_id`). Cette opération sera effectuée régulièrement, tous les 2 à 3 mois, afin d’assurer une maintenance adéquate. Une fois la correspondance terminée, X communiquera à l’entreprise, par e‑mail, un taux de correspondance de référence issu de ce fichier.

Le format de ce fichier doit être :

Convention de nommage : FullDataMatch.[CompanyName].txt

Algorithme de hachage : HMAC_SHA-256

Format :

Colonne 1 : valeur HMAC hachée des identifiants courants

Colonne 2 : ID utilisateur partenaire (unique par utilisateur, non unique dans le fichier)

Délimiteur de colonne (CSV) : des virgules seront utilisées pour séparer l’identifiant d’utilisateur courant haché de l’ID partenaire

Valeurs séparées par des sauts de ligne

* Ex. : si l’enregistrement utilisateur A a l’ID utilisateur partenaire 1 et les identifiants courants 1, 2 et 3 :

|     |     |
| :--- | :--- |
| identifiant d’utilisateur courant 1 | p_user_1 |
| identifiant d’utilisateur courant 2 | p_user_1 |
| identifiant d’utilisateur courant 3 | p_user_1 |

*Voir ci‑dessous la section Instructions de hachage pour les identifiants d’utilisateur courants

**2. Listes de segments personnalisés**

L’entreprise fournira des listes d’utilisateurs sous forme de `p_user_id` afin de créer des audiences personnalisées pour le ciblage sur X.

* Valeurs séparées par des sauts de ligne
* `p_user_id`
* * (Identique à ce qui est fourni dans la section 1. Correspondance de données complète ci‑dessus. Si la valeur fournie lors de la correspondance de données complète est hachée, l’entreprise fournira la même valeur hachée dans le fichier d’audience. Si la valeur fournie n’est pas hachée, l’entreprise fournira la valeur en clair.)

<div id="standard-matching-requirements">
  #### Exigences standard de correspondance
</div>

Si l’entreprise n’utilise pas d’ID standard pour le mappage de tous les identifiants utilisateurs clients, voici le processus recommandé.

**Listes de segments personnalisés**

L’entreprise fournira directement à X, au nom de ses clients, des listes d’identifiants utilisateurs courants hachés afin de créer des audiences personnalisées.

Le format de ce fichier doit être :

* Valeurs séparées par des lignes
* Identifiant utilisateur courant haché (p. ex. adresse e-mail)
* Respecter les conventions de nommage de fichiers décrites ci-dessous
* Suivre les instructions de hachage pour les adresses e-mail ci-dessous (voir Instructions de hachage)

<div id="custom-segment-list-file-naming-operations">
  #### Nommage et opérations des fichiers de listes de segments personnalisés
</div>

L’opération appliquée à un fichier est déterminée par son nom, selon les opérations disponibles et la convention générale de nommage suivantes : audiencename_partnername.handle.operation.filetype

* audiencename : Nom de la Custom Audience. Ce champ correspond au nom affiché lors de la sélection de l’audience dans l’interface de configuration des campagnes sur ads.x.com, par exemple brand_loyalty_card_holders.
* partnername : Nom de l’entreprise fournissant les données au nom de l’annonceur, par exemple company_name.
* handle : Compte X (@handle) qui aura accès aux Custom Audiences, par exemple @pepsi, @dietpepsi
* operation : new, add, remove, removeall, replace (voir détails ci-dessous)
* timestamp : Horodatage Unix (epoch) standard en secondes, utilisé pour garantir l’unicité de chaque fichier d’audience téléversé
* filetype : le fichier doit être au format .txt

<div id="creating-and-updating-audiences">
  #### Création et mise à jour des audiences
</div>

Créez une nouvelle audience avec un seul fichier, par exemple loyalty_card_holders_partnername.pepsi.new.txt

Add - Ajoutez les correspondances d’une liste à une audience existante, par exemple loyalty_card_holders_partnername.pepsi.add..txt

Remove - Supprimez les correspondances d’une liste d’une audience existante. Ex. : loyalty_card_holders_partnername.pepsi.remove..txt

Remove All - Supprimez, dans toutes les audiences de ce client, les correspondances issues d’une liste cumulative régulièrement mise à jour (c.-à-d. la liste d’exclusion du client). Ex. : partnername.pepsi.removeall.txt

* Peut servir de liste exhaustive des utilisateurs qui se sont désinscrits auprès de l’annonceur.
* X ne prendra en compte que la dernière liste fournie dans ce fichier et l’appliquera à toutes les audiences existantes et futures pour les correspondances.

Utilisateurs X au moment où ce fichier a été fourni et traité.

Replace - Supprimez une audience existante et remplacez-la par une nouvelle liste d’audience. Ex. : loyalty_card_holders_partnername.pepsi.replace..txt

Exclusion globale de l’entreprise - L’entreprise fournira un fichier d’exclusion cumulatif pour supprimer les utilisateurs qui se sont désinscrits conformément à la politique d’exclusion de l’entreprise.

X ne prendra en compte que la dernière liste fournie dans ce fichier d’exclusion d’entreprise et l’appliquera à toutes les audiences existantes et futures pour les utilisateurs X correspondants au moment où ce fichier a été fourni et traité. Le format du fichier d’exclusion d’entreprise sera le suivant : Ex. : partnername.removeall.txt

Delete - Supprimez une audience existante de la liste actuelle des audiences, par exemple loyalty_card_holders_partnername.pepsi.delete.txt

<div id="hashing-directions">
  #### Instructions de hachage
</div>

X partagera en toute sécurité, via PGP, une clé de production encodée en base64 pour le hachage des identifiants utilisateur courants (p. ex. adresses e-mail). L’entreprise effectuera le décodage base64 de la clé afin d’obtenir une clé de 32 octets qui servira à réaliser le hachage.

Exemple de clé encodée en base64 :

BrQvOg+dACBUmKjRiNxZgJLh6zydjS0ZOv80FelTNzM=

Exemple de clé décodée en base64 :

/:� TшY

Normalisation : l’entreprise effectuera une normalisation de base sur les identifiants utilisateur courants avant le hachage (sauf pour les identifiants d’appareil, voir la section Normalisation des identifiants d’appareil).

<div id="e-mail-normalization">
  #### Normalisation des e-mails
</div>

Concrètement, supprimez les espaces au début et à la fin et mettez également l’adresse e-mail en minuscules.

Ex. : Adresse e-mail brute : testemail_Organisational_baseball+884`@`It92I6Ev2B`.`Com

Après normalisation : testemail_organisational_baseball+884`@`it92i6ev2b`.`com

Valeur hachée : 74d9584eded0ad1e5572a1c1849f3716751d371d6117a6155dad5363f4b4fbec

Remarque : Le nombre de caractères de l’HMAC encodé et de la clé peut varier en fonction de l’entrée et de l’encodage ; la longueur exacte n’est donc pas fixe.

<div id="device-id-normalization">
  #### Normalisation des identifiants d’appareil
</div>

Nous appliquerons les mêmes exigences de hachage des identifiants d’appareil à l’aide de l’algorithme SHA-256 et d’un sel commun que nous fournissons à nos partenaires de données. Nous supprimons les espaces comme pour les adresses e‑mail, mais il n’y a pas de conversion en minuscules pour les IDFA/ID Android et le format exact de l’IDFA/ID Android doit être utilisé.

Voici un exemple de format brut des identifiants d’appareil pour iOS et Android, avant hachage :

IDFA iOS : DD99CFF7-6186-4602-9DF2-ED3FD0B2D431

ID Android : b5bf2122961b3595

IDFA iOS haché : 134fb8cd95c7fd42e2793f469a447198ca5f990968db2dbadad70e723ed9750b

ID Android haché : 130dddff1939f229476f50bc8adab8fcb7e3525b0e9604fe8effc15e68cee4a4

<div id="x-user-id-normalization">
  #### Normalisation des ID X
</div>

Les ID X continueront d’être hachés, car le regroupement des données — c’est-à-dire la Customer List de @handles — reste privé pour l’annonceur, même s’il ne s’agit pas de données personnelles (PII). Les mêmes exigences s’appliquent pour le hachage des ID X, en utilisant l’algorithme SHA-256 et un sel commun que nous fournissons aux partenaires de données. Les espaces doivent être supprimés à la fois de l’ID X et du `@`username, mais les User IDs ne nécessitent aucune normalisation. Les @usernames doivent être convertis en minuscules pour la normalisation. Le symbole @ ne doit pas être inclus dans le nom d’utilisateur.

Le format d’ID brut sera :

* User ID : 27674040
* @username : testusername

Hashed User ID : bf6b57d4e861e83bea8bbed2b800b251a64c95468ee6e8cb07c3368c9ed45e85

Hashed @username : 12201ae78ad1afa907c7112d17f498154ffb0bf9ea523f5390e072a06d7d9812

<div id="id-sync-integration">
  ### Intégration de synchronisation d’identifiants
</div>

Les partenaires qui envoient des données avec un `p_id` doivent effectuer un processus de synchronisation d’identifiants afin de générer une correspondance entre les identifiants utilisateur de l’annonceur ou du partenaire et les identifiants utilisateur X. Cela permet aux annonceurs de cibler directement leurs propres segments d’utilisateurs sur X. Les partenaires doivent également définir la valeur du paramètre `user_identifier_type` sur `TALIST_PARTNER_USER_ID` ou `TAWEB_PARTNER_USER_ID` lors de l’envoi de leurs mises à jour d’appartenance.

* **Web uniquement** : cela peut être fait en plaçant un pixel sur le site de l’annonceur, comme indiqué ci-dessous.
* **Liste** : cela peut être fait en utilisant l’une des méthodes décrites sur la page [CRM](/fr/x-ads-api/audiences#crm).

<div id="pixel-url">
  #### URL du pixel
</div>

|     |
| :--- |
| **URL de base** |
| [https://analytics.x.com/i/adsct](https://analytics.x.com/i/adsct) |

<div id="pixel-parameters">
  #### Paramètres du pixel
</div>

|     |     |
| :--- | :--- |
| **Paramètre** | **Description** |
| `p_id` | Votre identifiant de partenaire attribué par X |
| `p_user_id` | L’identifiant de l’utilisateur dans le système du partenaire |

<div id="id-sync-pixel">
  #### Pixel de synchronisation d’ID :
</div>

Avec un ID de partenaire d’exemple 111 et un `p_user_id` d’exemple abc, le pixel construit serait le suivant :

```json
    <pre class="brush: xml">
    <img height="1" width="1" src="https://analytics.x.com/i/adsct?p_id=111&p_user_id=abc" style="display:none" />
    </pre>
```

**Configuration du fichier de désinscription et envoi des fichiers de désinscription**

Les partenaires doivent fournir à X une liste d’utilisateurs qui, à leur connaissance, ont choisi de se désinscrire de la diffusion d’annonces ciblées. Le fichier doit être au format suivant :

|     |     |     |     |
| :--- | :--- | :--- | :--- |
| **Numéro de colonne** | **Nom de la colonne** | **Type de colonne** | **Description** |
| 1   | Partner ID | string | Le « partner id » est l’ID que X attribue au partenaire afin d’identifier de manière unique chaque partenaire. |
| 2   | ID de l’utilisateur dans le système du partenaire | string | Le `p_user_id` est l’ID unique utilisé par le partenaire pour identifier l’utilisateur. Le fichier contenant ces utilisateurs désinscrits doit être téléversé via l’endpoint [TON upload](/fr/x-ads-api/audiences) et le chemin des données téléversées doit être envoyé à l’endpoint Global Opt Out ici : [PUT accounts/:account_id/custom_audiences/global_opt_out](/fr/x-ads-api/audiences). |

**Envoi des mises à jour d’appartenance**

Comme indiqué dans notre documentation d’endpoint, lors de l’envoi d’utilisateurs via l’endpoint [POST custom_audience_memberships](/fr/x-ads-api/audiences), vous devez transmettre un ID client pour activer une correspondance basée sur les cookies. Les partenaires envoyant des données avec un `p_id` **doivent** définir `user_identifier_type` sur `TALIST_PARTNER_USER_ID` ou `TAWEB_PARTNER_USER_ID`.

Toutes les autres étapes restent identiques à celles répertoriées dans le [Guide d’intégration de l’API Real-Time Audience](/fr/x-ads-api/audiences)

<div id="custom-audiences-user-data">
  ### Données utilisateur des Custom Audiences
</div>

Ce document décrit le format des données utilisateur des [Custom Audience]/x-ads-api/audiences.

**Normalisation des données**

**Identifiants d’appareil** :

* IDFA - en minuscules avec des tirets ; ex. : `4b61639e-47cc-4056-a16a-c8217e029462`
* AdID - le format d’origine sur l’appareil est requis, non capitalisé avec des tirets ; ex. : `2f5f5391-3e45-4d02-b645-4575a08f86e`
* Android ID - le format d’origine sur l’appareil est requis, non capitalisé, sans tirets ni espaces ; ex. : `af3802a465767e36`

**Adresses e-mail** :

* en minuscules, supprimer les espaces en début et en fin ; ex. : `support@x.com`

**Noms d’utilisateur X** :

* sans @, en minuscules, espaces de début et de fin supprimés ; ex. : `jack`

**Identifiants utilisateur X** :

* Entier standard ; ex. : `143567`

**Hachage des données**

Les données de chaque ligne doivent être hachées avec `SHA256`, sans sel. De plus, le hachage final doit être en minuscules. Par exemple, 49e0be2aeccfb51a8dee4c945c8a70a9ac500cf6f5cb08112575f74db9b1470d et **non** 49E0BE2AECCFB51A8DEE4C945C8A70A9AC500CF6F5CB08112575F74DB9B1470D

```
# hachage de l’utilisateur @AdsAPI en Python
import hashlib
hashlib.sha256("adsapi".encode()).hexdigest()

# sortie
49e0be2aeccfb51a8dee4c945c8a70a9ac500cf6f5cb08112575f74db9b1470d
```

Des exemples de code supplémentaires pour le hachage sont disponibles sur [github.com/xdevplatform/ads-platform-tools](https://github.com/xdevplatform/ads-platform-tools).

<div id="custom-audiences-web">
  ### Audiences personnalisées : Web
</div>

<Frame>
  <img src="https://cdn.cms-twdigitalassets.com/content/dam/developer-twitter/images/info.png" alt="info.png" />
</Frame>

**Informations**

Les partenaires enverront une liste d’ID (`p_user_ids`) à cibler pour le compte d’un annonceur. Cela se fait via un processus de synchronisation d’ID (ID Sync) qui établit une correspondance entre les `p_user_ids` et l’ID utilisateur X. Cette correspondance est ensuite utilisée pour produire des listes d’ID d’utilisateurs X utilisables pour le ciblage. Ces audiences personnalisées seront disponibles sur le @handle spécifique de l’annonceur, tel qu’indiqué par le libellé lors de la configuration de campagne Custom Audiences Web sur ads.x.com.

X fournira le pixel sécurisé à intégrer dans les tags et sur les sites des partenaires afin d’apparier les ID (`p_user_ids`) avec les ID d’utilisateurs X. Une fois le processus de synchronisation d’ID terminé, les fichiers de ciblage seront créés par le partenaire et mis à la disposition de X via un endpoint HTTPS. Ces fichiers de ciblage sont régulièrement ingérés par X, puis rendus disponibles dans l’interface X.

**Pixel sécurisé X**

Le pixel sécurisé X aura la forme suivante :

https://analytics.x.com/i/adsct?p_user_id=xyz&amp;p_id=123

**`p_user_id`** - xyz représente l’ID utilisateur partenaire fourni par le partenaire

**`p_id`** - 123 représente l’ID unique du partenaire (fourni par X)

**Endpoint HTTPS du partenaire et fichier d’utilisateurs de ciblage**

Le partenaire devra fournir à X un endpoint HTTPS et des identifiants (nom d’utilisateur/mot de passe) permettant d’ingérer le fichier de ciblage de manière régulière. Un exemple d’endpoint HTTPS sera le suivant :

```
https://<partnerdomain>/twitter/partner_targeting_%Y-%M-%D.tsv.gz
```

%Y - Code de format pour l’année (YYYY)

%M - Code de format pour le mois (MM)

%D - Code de format pour le jour (DD)

Les données transmises comprendront les fichiers suivants :

1. Fichier d’utilisateurs de ciblage partenaire
2. Fichier de conversion de ciblage

Tous les fichiers seront au format TSV, où les champs de chaque ligne sont séparés par un caractère de tabulation. Les valeurs valides des champs ne contiendront jamais de caractère de tabulation.

**Plage d’IP X autorisée :**

Voici la plage d’IP pouvant être autorisée pour accéder à l’endpoint du partenaire.

* 199.16.156.0/22
* 199.59.148.0/22

**Fichier d’utilisateurs de ciblage partenaire :**

| **Numéro de colonne** | **Nom de colonne** | **Type de colonne** | **Description** |
| :--- | :--- | :--- | :--- |
| 1   | partner id | string | Le « partner id » est l’ID que X fournit au partenaire afin d’identifier de manière unique chaque partenaire. |
| 2   | advertiser id | string | L’« advertiser id » est le @handle de l’annonceur. |
| 3   | p_user_id | string | Le « p_user_id » est l’ID unique utilisé par le partenaire pour identifier l’utilisateur. |
| 3   | confidence score | integer | Le « confidence score » est facultatif. Nous recommandons d’utiliser une échelle de 0 à 100. Si le cas d’usage est le reciblage, un confidence score de « 100 » correspond à un utilisateur directement reciblé. Tout score de 0 à 99 correspond au niveau de confiance du look-alike. |
| 4   | segment label | string | Le « segment label » est facultatif. Les partenaires peuvent utiliser « segment label » pour préciser, par exemple, des catégories de produits. Nous recommandons d’utiliser ce « segment label », car c’est le nom lisible par l’humain des Custom Audiences dans l’interface ads.x.com. |

**Notes :**

Chaque fois que nous recevons un nouveau fichier de ciblage partenaire, nous nous attendons à ce qu’il s’agisse de la liste complète des utilisateurs que le partenaire nous recommande de cibler, et non d’un incrément, sauf accord contraire. Nous conviendrons avec chaque partenaire de la fréquence de livraison de ce fichier de ciblage partenaire. Si nous ne recevons pas de fichier de ciblage partenaire comme prévu, nous utiliserons la version précédente avec un délai d’expiration prédéfini.

<div id="audience-api-integration">
  ## Intégration de l’API Audience
</div>

<div id="overview">
  ### Aperçu
</div>

L’Audience API a été lancée dans le cadre de la [v4](/fr/x-ads-api/introduction) de l’Ads API et apporte plusieurs améliororations aux anciens endpoints Audiences. Ce nouvel endpoint s’appuie sur un nouveau backend de traitement des audiences et offre des gains notables en matière de stabilité, de robustesse et de fiabilité. L’objectif de ce guide est de mettre en évidence les différences entre l’Audience API et les anciens processus de chargement et de gestion des audiences.

La documentation de référence est disponible sur la page de référence de l’[Audience API](/fr/x-ads-api/audiences).

**Remarque** : Toutes les données utilisateur des audiences doivent être hachées avec SHA-256 avant le chargement. Plus de détails, ainsi que les types d’identifiants utilisateur acceptés et la normalisation des données, sont disponibles sur la page [user data](/fr/x-ads-api/audiences).

**Modifications de la fonctionnalité Audience**

Les changements suivants concernant les Custom Audiences ont été introduits à partir de la v4 et tous les endpoints obsolètes ne seront plus disponibles une fois la v3 de l’Ads API retirée :

* **Obsolète** Chargement TON :
  * GET accounts/:account_id/custom_audience_changes
  * GET accounts/:account_id/custom_audience_changes/:custom_audience_change_id
  * POST accounts/:account_id/custom_audience_changes
  * PUT accounts/:account_id/custom_audiences/global_opt_out
* **Obsolète** Real Time Audiences :
  * POST custom_audience_memberships
* Custom Audience :
  * Le paramètre `list_type` sera supprimé des requêtes et réponses sur tous les endpoints [Custom Audience](/fr/x-ads-api/audiences). Ce paramètre servait auparavant à identifier le type d’identifiant utilisateur de l’audience (p. ex., email, X User ID, etc.) ; les audiences peuvent désormais accepter plusieurs identifiants utilisateur pour une même audience, rendant cette valeur sans objet.
* Général :
  * La fenêtre de lookback de l’audience a été mise à jour pour correspondre aux utilisateurs actifs au cours des 90 derniers jours (contre 30 jours)
  * Le nombre minimal d’utilisateurs correspondants requis pour qu’une audience soit ciblable a été réduit à 100 utilisateurs (contre 500)

<Note>
  **Prérequis**

  * Accès à l’Ads API
  * Pour accéder à l’endpoint Audience, vous devrez être ajouté à une allowlist. Veuillez remplir ce formulaire et accepter le nouveau [X Ads Products and Services Agreement](/fr/x-ads-api/introduction) si l’acceptation initiale est antérieure au 2018-08-01
</Note>

**Processus de chargement d’audience**

Le tableau suivant répertorie les principales différences entre les anciens et les nouveaux flux de création d’audience, avec davantage de détails plus bas :

| Étape du processus | Audience API | (Obsolète) Chargement TON |
| :--- | :--- | :--- |
| Créer une audience « shell » | Peut être créée via le [POST custom_audience endpoint]/x-ads-api/audiences | Peut être créée via le [POST custom_audience endpoint]/x-ads-api/audiences |
| Ajouter un nouvel utilisateur | Utilisez `operation_type` `Update` avec l’[Audience endpoint](/fr/x-ads-api/audiences) | Utilisez `operation` `ADD` avec l’endpoint [POST custom_audience_changes](/fr/x-ads-api/audiences) |
| Supprimer un utilisateur | Utilisez `operation_type` `Delete` avec l’[Audience endpoint](/fr/x-ads-api/audiences) | Utilisez `operation` `REMOVE` avec l’endpoint [POST custom_audience_changes](/fr/x-ads-api/audiences) |
| Désinscrire des utilisateurs | Utilisez `operation_type` `Delete` avec l’[Audience endpoint](/fr/x-ads-api/audiences) et les `custom_audience_id` correspondants auxquels l’utilisateur appartient | Utilisez l’[endpoint Global opt-out](/fr/x-ads-api/audiences) |

**Remarque** Toute audience mise à jour ou dont des utilisateurs sont désinscrits via la voie de chargement TON doit avoir une liste correspondante chargée via l’endpoint [TON Upload](/fr/x-ads-api/audiences) et associée à une audience à l’aide de l’endpoint [custom_audience_changes](/fr/x-ads-api/audiences).

**Limitation de débit**

L’endpoint Audience API est limité à 1500/1 min par compte. Il n’y a aucune limite quant au nombre d’utilisateurs pouvant être envoyés dans une même charge utile. Les seules contraintes sur la charge utile sont :

1. Nombre total d’opérations : 2500 opérations

2. Taille maximale de la charge utile : 5 000 000 octets

**Gestion des utilisateurs d’audience**

Pour créer une nouvelle audience, les étapes suivantes sont requises

<div id="create-a-new-custom-audience">
  ### Créer une nouvelle Custom Audience
</div>

Créez une nouvelle « enveloppe » de Custom Audience à l’aide de l’endpoint [POST custom_audience]/x-ads-api/audiences et récupérez l’`id` de la Custom Audience correspondante. Cette étape est requise si vous créez une Audience à partir de zéro. Si vous mettez à jour une Audience existante, passez à la section suivante.

<div id="add-users-to-an-audience">
  ### Ajouter des utilisateurs à une Audience
</div>

Utilisez [POST accounts/:account_id/custom_audiences/:custom_audience_id/users](/fr/x-ads-api/audiences) avec l’`id` de la Custom Audience et un exemple de payload comme suit :

POST https://ads-api.x.com/11/accounts/18ce54d4x5t/custom_audiences/1nmth/users

```
    # Toutes les valeurs doivent être hachées ; des valeurs en clair sont utilisées dans cet exemple à des fins d’illustration
    [
      {
        "operation_type": "Update",
        "params": {
          "effective_at": "2018-05-15T00:00:00Z",
          "expires_at": "2019-01-01T07:00:00Z",
          "users": [
            {
              "email": [
                "abc@x.com"
              ],
              "handle": [
                "x",
                "adsapi"
              ]
            },
            {
              "email": [
                "edf@x.com"
              ],
              "twitter_id": [
                "121291606",
                "17874544"
              ]
            }
          ]
        }
      }
    ]
```

Pour ajouter un utilisateur à une Audience, utilisez la valeur `Update` pour `operation_type`. La nouvelle interface Audience permet d’envoyer plusieurs clés d’utilisateur pour un même utilisateur. Chaque objet dans le tableau d’objets JSON correspond à un seul utilisateur. Avec l’exemple de payload ci-dessus, la requête ajoutera deux utilisateurs à une Audience : l’un avec un `email` et un `handle`, et l’autre avec un `email` et un `twitter_id`. 

<div id="remove-users-from-an-audience">
  #### Supprimer des utilisateurs d’une audience
</div>

Comme pour l’ajout d’utilisateurs, vous pouvez supprimer des utilisateurs d’une audience comme suit :

POST https://ads-api.x.com/11/accounts/18ce54d4x5t/custom_audiences/1nmth/users

```
    # Toutes les valeurs doivent être hachées ; des valeurs non hachées sont utilisées dans cet exemple à des fins d’illustration
    [
      {
        "operation_type": "Delete",
        "params": {
          "effective_at": "2018-05-15T00:00:00Z",
          "expires_at": "2019-01-01T07:00:00Z",
          "users": [
            {
              "email": [
                "abc@x.com"
              ],
              "twitter_id": [
                "783214",
                "1225933934"
              ]
            },
            {
              "email": [
                "edf@x.com"
              ],
              "twitter_id": [
                "121291606",
                "17874544"
              ]
            }
          ]
        }
      }
    ]
```

Le `operation_type` doit être défini sur `Delete` et les utilisateurs seront mis en correspondance avec n’importe quelle clé utilisée lors de leur ajout à l’audience. Par exemple, si un utilisateur a été ajouté à une audience avec un `email` et un `twitter_id`, alors ce même utilisateur peut être supprimé en utilisant l’une de ces clés, c’est-à-dire `email` ou `twitter_id`, ou les deux.

Il est également possible d’ajouter et de supprimer des utilisateurs d’une audience dans la même requête. Le point de terminaison prend en charge plusieurs `operation_type` par requête.

<div id="opt-out-users">
  #### Utilisateurs désinscrits
</div>

Suite à la suppression de l’endpoint de désinscription global, les partenaires doivent `Delete` tous les utilisateurs qui se sont désinscrits de n’importe quelle Audience. Il existe plusieurs façons d’y parvenir :

1. Suivre quels utilisateurs appartiennent à quelles Audiences et supprimer ces utilisateurs individuellement de chaque Audience.
2. Supprimer l’utilisateur de **toutes** les Audiences associées à un compte Ads.

**Bonnes pratiques générales**

* Nous recommandons vivement d’appeler cet endpoint par lots en quasi temps réel afin d’éviter des files d’attente en dents de scie, plus longues à traiter et générant une charge inutile sur notre système. Cela garantit également que les utilisateurs sont disponibles plus rapidement pour le ciblage des campagnes.
* Un appel API réussi renverra un `success_count` et un `total_count` correspondant au nombre d’objets `user` reçus dans la requête.
* Cet endpoint est atomique par nature : soit la requête entière réussit, soit, en cas d’erreur, la requête entière échoue. En cas de réponse d’erreur, il est recommandé aux consommateurs de l’API de corriger l’erreur et de réessayer la requête avec l’intégralité de la charge utile.
* En cas d’échec, il est recommandé aux partenaires d’utiliser une stratégie de [retrait exponentiel](https://en.wikipedia.org/wiki/Exponential_backoff) avec des tentatives de nouvelle exécution. Par exemple, réessayez immédiatement après le premier échec, réessayez après 1 minute après le deuxième échec, puis réessayez après 5 minutes après le troisième échec consécutif, et ainsi de suite.

<div id="api-reference">
  ## Référence de l’API
</div>

<div id="keyword-insights">
  ### Informations sur les mots-clés
</div>

<Button href="https://app.getpostman.com/run-collection/1d12b9fc623b8e149f87">
  Exécuter dans Postman
</Button>

<div id="get-insightskeywordssearch">
  #### GET insights/keywords/search[](#get-insights-keywords-search "Permalien vers ce titre")
</div>

Pour un groupe de mots-clés donné, récupère le volume de Tweets associé ainsi qu’un ensemble de 30 mots-clés connexes. Le volume de Tweets correspond uniquement aux mots-clés fournis en entrée, pas aux mots-clés connexes.

Une plage temporelle maximale (`end_time` - `start_time`) de 7 jours est autorisée.

Veuillez noter que les résultats sont limités à une seule zone géographique (pays).

**Resource URL[](#resource-url "Permalien vers ce titre")**

`https://ads-api.x.com/12/insights/keywords/search`

**Parameters[](#parameters "Permalien vers ce titre")**

| Name | Description |
| :--- | :--- |
| granularity  <br />*required* | Spécifie la granularité des données renvoyées pour l’intervalle de temps indiqué par `start_time` et `end_time`. Par exemple, lorsque la valeur est `HOUR`, un point de données est renvoyé pour chaque heure entre `start_time` et `end_time`.<br /><br />Type: enum<br /><br />Valeurs possibles: `DAY`, `HOUR` |
| keywords  <br />*required* | Une chaîne de mots-clés séparés par des virgules pour affiner la recherche. Tous les mots-clés sont combinés avec l’opérateur OR entre eux.<br /><br />**Remarque**: Un maximum de 10 mots-clés (combinaison de `keywords` et `negative_keywords`) peut être utilisé.<br /><br />Type: string<br /><br />Exemple: `developers` |
| start_time  <br />*required* | Restreint les données récupérées à celles collectées dans la fenêtre temporelle entre `start_time` et `end_time`. Exprimé au format [ISO 8601](https://en.wikipedia.org/wiki/ISO_8601).<br /><br />Type: string<br /><br />Exemple: `2017-07-10T00:00:00Z` |
| end_time  <br />*optional* | Restreint les données récupérées à celles collectées dans la fenêtre temporelle entre `start_time` et `end_time`. Exprimé au format [ISO 8601](https://en.wikipedia.org/wiki/ISO_8601).<br /><br />**Remarque**: Par défaut, l’heure actuelle est utilisée.<br /><br />Type: string<br /><br />Exemple: `2017-07-11T00:00:00Z` |
| location  <br />*optional* | Une valeur de ciblage obtenue via le point de terminaison [GET targeting_criteria/locations](/fr/x-ads-api/campaign-management#get-targeting-criteria-locations) pour affiner les résultats en fonction du pays où se situe l’utilisateur du compte. À l’heure actuelle, seuls les emplacements au niveau pays sont pris en charge.<br /><br />Type: string<br /><br />Exemple: `0ce8b9a7b2742f7e` |
| negative_keywords  <br />*optional* | Une chaîne de mots-clés séparés par des virgules à exclure. Tous les mots-clés négatifs sont combinés avec l’opérateur OR entre eux.<br /><br />**Remarque**: Un maximum de 10 mots-clés (combinaison de `keywords` et `negative_keywords`) peut être utilisé.<br /><br />Type: string<br /><br />Exemple: `rain` |

**Example Request[](#example-request "Permalien vers ce titre")**

```json
GET https://ads-api.x.com/12/insights/keywords/search?end_time=2018-02-02&granularity=DAY&keywords=developers&start_time=2018-02-01
```

**Example Response[](#example-response "Permalien vers ce titre")***

```
    {
      "request": {
        "params": {
          "start_time": "2018-02-01T00:00:00Z",
          "end_time": "2018-02-02T00:00:00Z",
          "granularity": "DAY",
          "keywords": [
            "developers"
          ]
        }
      },
      "data": {
        "related_keywords": [
          "dev",
          "developer",
          "coders",
          "mysql",
          "devs",
          "#technology",
          "#developers",
          "security",
          "programmers",
          "#tech",
          "javascript",
          "#iot",
          "#bigdata",
          "cloud",
          "devops",
          "php",
          "developer",
          "programmer",
          "engineer",
          "big data",
          "agile",
          "app",
          "programming",
          "ios",
          "maker",
          "startups",
          "developer's",
          "java",
          "#devops",
          "startup"
        ],
        "tweet_volume": [
          15707
        ]
      }
    }
```

<div id="tailored-audience-permissions">
  ### Autorisations pour les audiences ciblées
</div>

<Button href="https://app.getpostman.com/run-collection/369a02c0adc626ff6a06#?env%5BTwitter%20Ads%20API%5D=W3sia2V5IjoiYWNjb3VudF9pZCIsInZhbHVlIjoieW91cl9hZHNfYWNjb3VudF9pZCIsImVuYWJsZWQiOnRydWV9LHsia2V5IjoidmVyc2lvbiIsInZhbHVlIjoiNSIsImVuYWJsZWQiOnRydWV9LHsia2V5IjoiY29uc3VtZXJfa2V5IiwidmFsdWUiOiJ5b3VyX2NvbnN1bWVyX2tleSIsImVuYWJsZWQiOnRydWV9LHsia2V5IjoiY29uc3VtZXJfc2VjcmV0IiwidmFsdWUiOiJ5b3VyX2NvbnN1bWVyX3NlY3JldCIsImVuYWJsZWQiOnRydWV9LHsia2V5IjoiYWNjZXNzX3Rva2VuIiwidmFsdWUiOiJ5b3VyX2FjY2Vzc190b2tlbiIsImVuYWJsZWQiOnRydWV9LHsia2V5IjoidG9rZW5fc2VjcmV0IiwidmFsdWUiOiJ5b3VyX3Rva2VuX3NlY3JldCIsImVuYWJsZWQiOnRydWV9XQ==">
  Exécuter dans Postman
</Button>

<div id="get-accountsaccount_idtailored_audiencestailored_audience_idpermissions">
  #### GET accounts/:account_id/tailored_audiences/:tailored_audience_id/permissions[](#get-accounts-account-id-tailored-audiences-tailored-audience-id-permissions "Permalink to this headline")
</div>

Récupère les détails de tout ou partie des autorisations associées à l’audience personnalisée spécifiée.

**URL de la ressource[](#resource-url "Permalink to this headline")**

`https://ads-api.x.com/5/accounts/:account_id/tailored_audiences/:tailored_audience_id/permissions`

**Paramètres[](#parameters "Permalink to this headline")**

| Name | Description |
| :--- | :--- |
| account_id  <br />*required* | L’identifiant du compte exploité. Apparaît dans le chemin de la ressource et est généralement un paramètre requis pour toutes les requêtes de l’Advertiser API, à l’exception de [GET accounts](/fr/x-ads-api/campaign-management#accounts). Le compte spécifié doit être associé à l’utilisateur authentifié.<br /><br />Type: string<br /><br />Example: `18ce54d4x5t` |
| tailored_audience_id  <br />*required* | Référence de l’audience personnalisée ciblée par la requête.<br /><br />Type: string<br /><br />Example: `1nmth` |
| count  <br />*optional* | Spécifie le nombre d’enregistrements à récupérer par requête distincte.<br /><br />Type: int<br /><br />Default: `200`  <br />Min, Max: `1`, `1000` |
| cursor  <br />*optional* | Spécifie un curseur pour obtenir la page suivante de résultats. Voir [Pagination](/fr/x-ads-api/introduction) pour plus d’informations.<br /><br />Type: string<br /><br />Example: `8x7v00oow` |
| granted_account_ids  <br />*optional* | Restreint la réponse aux comptes souhaités en fournissant une liste d’identifiants séparés par des virgules. Jusqu’à 200 ID peuvent être fournis.<br /><br />Type: string<br /><br />Example: `18ce54aymz3` |
| sort_by  <br />*optional* | Trie selon un attribut pris en charge, par ordre croissant ou décroissant. Voir [Sorting](/fr/x-ads-api/introduction) pour plus d’informations.<br /><br />Type: string<br /><br />Example: `created_at-asc` |
| tailored_audience_permission_ids  <br />*optional* | Restreint la réponse aux autorisations d’audience personnalisée souhaitées en fournissant une liste d’identifiants séparés par des virgules. Jusqu’à 200 ID peuvent être fournis.<br /><br />Type: string<br /><br />Example: `ri` |
| with_total_count  <br />*optional* | Inclut l’attribut de réponse `total_count`.<br /><br />**Remarque** : Ce paramètre et `cursor` sont exclusifs.<br /><br />**Remarque** : Les requêtes qui incluent `total_count` sont soumises à des limites de débit plus faibles, actuellement fixées à 200 par 15 minutes.<br /><br />Type: boolean<br /><br />Default: `false`  <br />Possible values: `true`, `false` |

**Exemple de requête[](#example-request "Permalink to this headline")**

`GET https://ads-api.x.com/5/accounts/18ce54d4x5t/tailored_audiences/1nmth/permissions`

**Exemple de réponse[](#example-response "Permalink to this headline")**

```
    {
      "request": {
        "params": {
          "account_id": "18ce54d4x5t",
          "tailored_audience_id": "1nmth"
        }
      },
      "next_cursor": null,
      "data": [
        {
          "tailored_audience_id": "1nmth",
          "permission_level": "READ_ONLY",
          "id": "ri",
          "created_at": "2017-06-08T23:17:59Z",
          "granted_account_id": "18ce54aymz3",
          "updated_at": "2017-06-08T23:17:59Z",
          "deleted": false
        }
      ]
    }

```

<div id="post-accountsaccount_idtailored_audiencestailored_audience_idpermissions">
  #### POST accounts/:account_id/tailored_audiences/:tailored_audience_id/permissions[](#post-accounts-account-id-tailored-audiences-tailored-audience-id-permissions "Permalink to this headline")
</div>

Crée un nouvel objet d’autorisation permettant de partager l’audience spécifiée avec un compte donné.

**Remarque** : la création ou la modification d’autorisations pour une audience personnalisée nécessite que l’audience soit détenue par le compte qui tente de modifier les autorisations. Vous pouvez vérifier la propriété d’une audience personnalisée en consultant l’attribut de réponse `is_owner` dans la réponse pour une audience donnée.

**Remarque** : les audiences ne peuvent être partagées qu’entre des comptes publicitaires relevant de la même entreprise, ou si le compte publicitaire qui possède l’audience dispose de la fonctionnalité de compte `SHARE_AUDIENCE_OUTSIDE_BUSINESS`.

**Resource URL[](#resource-url "Permalink to this headline")**

`https://ads-api.x.com/5/accounts/:account_id/tailored_audiences/:tailored_audience_id/permissions`

**Parameters[](#parameters "Permalink to this headline")**

| Name | Description |
| :--- | :--- |
| account_id  <br />*required* | L’identifiant du compte utilisé. Apparaît dans le chemin de la ressource et constitue généralement un paramètre requis pour toutes les requêtes de l’API Advertiser, à l’exception de [GET accounts](/fr/x-ads-api/campaign-management#accounts). Le compte spécifié doit être associé à l’utilisateur authentifié.<br /><br />Type: string<br /><br />Exemple: `18ce54d4x5t` |
| granted_account_id  <br />*required* | Le compte auquel vous souhaitez accorder des autorisations sur l’audience personnalisée.<br /><br />Type: string<br /><br />Exemple: `18ce54aymz3` |
| permission_level  <br />*required* | Le type d’accès à l’audience personnalisée que `granted_account_id` doit avoir.<br /><br />Type: enum<br /><br />Valeurs possibles : `READ_ONLY`, `READ_WRITE` |
| tailored_audience_id  <br />*required* | La référence à l’audience personnalisée avec laquelle vous opérez dans la requête.<br /><br />Type: string<br /><br />Exemple: `2906h` |

**Example Request[](#example-request "Permalink to this headline")**

`POST https://ads-api.x.com/5/accounts/18ce54d4x5t/tailored_audiences/2906h/permissions?granted_account_id=18ce54aymz3&permission_level=READ_ONLY`

**Example Response[](#example-response "Permalink to this headline")**

```
    {
      "request": {
        "params": {
          "account_id": "18ce54d4x5t",
          "granted_account_id": "18ce54aymz3",
          "permission_level": "READ_ONLY",
          "tailored_audience_id": "2906h"
        }
      },
      "data": {
        "tailored_audience_id": "2906h",
        "permission_level": "READ_ONLY",
        "id": "14m",
        "created_at": "2017-09-12T23:49:34Z",
        "granted_account_id": "18ce54aymz3",
        "updated_at": "2017-09-12T23:49:34Z",
        "deleted": false
      }
    }
```

<div id="delete-accountsaccount_idtailored_audiencestailored_audience_idpermissionstailored_audience_permission_id">
  #### DELETE accounts/:account_id/tailored_audiences/:tailored_audience_id/permissions/:tailored_audience_permission_id[](#delete-accounts-account-id-tailored-audiences-tailored-audience-id-permissions-tailored-audience-permission-id "Permalink to this headline")
</div>

Révoquez l’autorisation de partage de la Tailored Audience spécifiée.

**Remarque** : La création ou la modification d’autorisations pour une Tailored Audience requiert que l’audience appartienne au compte qui tente de modifier ces autorisations. Vous pouvez vérifier la propriété d’une Tailored Audience en consultant l’attribut de réponse `is_owner` dans la réponse pour une audience donnée.

Une fois révoquée, nous garantissons que le compte bénéficiaire (`granted_account_id`) ne pourra pas cibler l’audience dans de futures campagnes. Les campagnes existantes continueront de s’exécuter avec les audiences partagées ; les campagnes ne s’arrêtent pas et l’audience n’est pas supprimée de la campagne. Il n’est pas possible de copier cette campagne après la révocation de l’autorisation de partage d’audience.

**Resource URL[](#resource-url "Permalink to this headline")**

`https://ads-api.x.com/5/accounts/:account_id/tailored_audiences/:tailored_audience_id/permissions/:tailored_audience_permission_id`

**Parameters[](#parameters "Permalink to this headline")**

| Name | Description |
| :--- | :--- |
| account_id  <br />*required* | L’identifiant du compte utilisé. Apparaît dans le chemin de la ressource et est généralement un paramètre requis pour toutes les requêtes de l’API Advertiser, à l’exception de [GET accounts](/fr/x-ads-api/campaign-management#accounts). Le compte spécifié doit être associé à l’utilisateur authentifié.<br /><br />Type: string<br /><br />Exemple : `18ce54d4x5t` |
| tailored_audience_id  <br />*required* | Référence à la Tailored Audience concernée par la requête.<br /><br />Type: string<br /><br />Exemple : `1nmth` |
| tailored_audience_permission_id  <br />*required* | Référence à l’autorisation de Tailored Audience concernée par la requête.<br /><br />Type: string<br /><br />Exemple : `ri` |

**Example Request[](#example-request "Permalink to this headline")**

`DELETE https://ads-api.x.com/5/accounts/18ce54d4x5t/tailored_audiences/1nmth/permissions/ri`

**Example Response[](#example-response "Permalink to this headline")**

```
    {
      "request": {
        "params": {
          "account_id": "18ce54d4x5t",
          "tailored_audience_permission_id": "ri",
          "tailored_audience_id": "1nmth"
        }
      },
      "data": {
        "tailored_audience_id": "1nmth",
        "permission_level": "READ_ONLY",
        "id": "ri",
        "created_at": "2017-06-08T23:17:59Z",
        "granted_account_id": "18ce54aymz3",
        "updated_at": "2017-08-30T18:29:35Z",
        "deleted": true
      }
    }
```

<div id="targeted-audiences">
  ### Audiences cibles
</div>

<Button href="https://app.getpostman.com/run-collection/1d12b9fc623b8e149f87">
  Exécuter dans Postman
</Button>

<div id="get-accountsaccount_idcustom_audiencescustom_audience_idtargeted">
  #### GET accounts/:account_id/custom_audiences/:custom_audience_id/targeted[](#get-accounts-account-id-custom-audiences-custom-audience-id-targeted "Permalink to this headline")
</div>

Récupère la liste des éléments de campagne (line items) et des campagnes actifs, ou de l’ensemble de ceux qui ciblent un `custom_audience_id` donné

| Name | Description |
| :--- | :--- |
| account_id  <br />*required* | L’identifiant du compte utilisé. Apparaît dans le chemin de la ressource et est généralement un paramètre requis pour toutes les requêtes de l’API Advertiser, à l’exception de [GET accounts](/fr/x-ads-api/campaign-management#accounts). Le compte spécifié doit être associé à l’utilisateur authentifié.<br /><br />Type : string<br /><br />Exemple : `18ce54d4x5t` |
| custom_audience_id  <br />*required* | Référence de l’audience personnalisée visée par la requête.<br /><br />Type : string<br /><br />Exemple : `2906h` |
| with_active  <br />*optional* | Lorsque la valeur est `false`, inclut les éléments de campagne dont le statut est `servable=false`<br /><br />Type : boolean<br /><br />Valeur par défaut : `true`  <br />Valeurs possibles : `true`, `false` |
| cursor  <br />*optional* | Spécifie un curseur pour obtenir la page suivante de résultats. Voir [Pagination](/fr/x-ads-api/introduction) pour plus d’informations.  <br />  <br />Type : string  <br />  <br />Exemple : `8x7v00oow` |

**Exemple de requête[](#example-request "Permalink to this headline")**

`GET https://ads-api.x.com/12/accounts/18ce54d4x5t/custom_audiences/2906h/targeted`

**Exemple de réponse[](#example-response "Permalink to this headline")**

```
    {
      "request": {
        "params": {
          "account_id": "18ce54d4x5t",
          "custom_audience_id": "2906h",
        }
      },
      "next_cursor": null,
      "data": [
        {
          "campaign_id": "59hod",
          "campaign_name": "test-campaign",
          "line_items": [
            {
              "id": "5gzog",
              "name": "test-line-item",
              "servable": true
            }
          ]
        },
        {
          "campaign_id": "arja7",
          "campaign_name": "Untitled campaign",
          "line_items": [
            {
              "id": "bjw1q",
              "name": null,
              "servable": true
            }
          ]
        }
      ]
    }
```

<div id="custom-audiences-users">
  ### Utilisateurs d’audiences personnalisées
</div>

<Button href="https://app.getpostman.com/run-collection/1d12b9fc623b8e149f87">
  Exécuter dans Postman
</Button>

<div id="post-accountsaccount_idcustom_audiencescustom_audience_idusers">
  #### POST accounts/:account_id/custom_audiences/:custom_audience_id/users[](#post-accounts-account-id-custom-audiences-custom-audience-id-users "Permalink to this headline")
</div>

Cet endpoint permet aux partenaires d’ajouter, de mettre à jour et de supprimer des utilisateurs d’un `custom_audience_id` donné. L’endpoint accepte également plusieurs types d’identifiants par utilisateur.

Toutes les données fournies dans le champ `users` de la requête **à l’exception de** `partner_user_id` doivent être hachées avec `SHA256` et [normalisées](/fr/x-ads-api/audiences#twitter-user-id-normalization).

**Requêtes par lots**

* La taille maximale actuelle d’un lot est de `2500` **pour cet endpoint**. La taille du lot est déterminée par le nombre d’opérations (`Update`/`Delete`) par requête. Par exemple, plus de 2500 objets d’opération (`{"operation_type": "Update/Delete", [..] }`) dans un même tableau entraînent une erreur.
* La taille maximale du corps de la requête POST que cet endpoint peut accepter est de `5,000,000` octets.
* Les limites de débit pour cet endpoint sont de 1500 par fenêtre d’1 minute.
* Tous les paramètres sont envoyés dans le corps de la requête et un `Content-Type` de `application/json` est requis.
* Les requêtes par lots échouent ou réussissent ensemble en tant que groupe, et toutes les réponses de l’API, qu’il s’agisse d’erreur ou de succès, préservent l’ordre des éléments de la requête initiale.

**Réponses par lots**

La réponse renvoyée par l’Ads API contient deux champs, `success_count` et `total_count`. Ces valeurs doivent toujours être égales et correspondent au nombre d’enregistrements de la requête traités par le backend. Si le nombre d’enregistrements envoyés dans le corps de la requête n’est **pas** égal à `success_count` et `total_count`, cela doit être traité comme une erreur nécessitant une nouvelle tentative.

**Erreurs par lots**

* Les erreurs au niveau de la requête (ex. taille maximale du lot dépassée) apparaissent dans la réponse sous l’objet `errors`.
* Les erreurs au niveau des éléments (ex. paramètres obligatoires manquants) apparaissent dans la réponse sous l’objet `operation_errors`.
* L’index de l’erreur dans `operation_errors` correspond à l’index de l’élément d’entrée, avec le message d’erreur associé.

<div id="resource-url">
  #### URL de la ressource[](#resource-url "Lien permanent vers ce titre")
</div>

`https://ads-api.x.com/12/accounts/:account_id/custom_audiences/:custom_audience_id/users`

<div id="parameters">
  #### Paramètres[](#parameters "Permalink to this headline")
</div>

| Nom | Description |
| :--- | :--- |
| operation_type  <br />*obligatoire* | Le type d’opération appliqué par groupe `users`.<br /><br />Type : enum<br /><br />Valeurs possibles : `Update`, `Delete` |
| params  <br />*obligatoire* | Un objet JSON contenant le tableau `users`, ainsi que les horodatages `effective_at` et `expires_at`.<br /><br />Type : JSON |
| users  <br />*obligatoire* | Un tableau d’objets JSON contenant tous les paramètres pour un utilisateur donné.<br /><br />Type : JSON |
| effective_at  <br />*facultatif* | L’heure UTC à laquelle la ou les associations d’audience personnalisée doivent prendre effet. Exprimée au format [ISO 8601](https://en.wikipedia.org/wiki/ISO_8601). Par défaut : la date et l’heure actuelles.<br /><br />Type : string<br /><br />Exemple : `2017-07-05T07:00:00Z` |
| expires_at  <br />*facultatif* | L’heure UTC à laquelle la ou les associations d’audience personnalisée doivent expirer. L’heure spécifiée doit être postérieure à la valeur de `effective_at`. Exprimée au format [ISO 8601](https://en.wikipedia.org/wiki/ISO_8601). Par défaut : 13 mois après l’horodatage de la requête.<br /><br />Type : string<br /><br />Exemple : `2017-07-05T07:00:00Z` |

Étant donné l’approche multi-clés de l’objet `users`, chaque élément de cet objet est documenté ci-dessous :

| Nom | Description |
| :--- | :--- |
| email  <br />*facultatif* | Adresse(s) e-mail de l’utilisateur.<br /><br />Type : Array[String] |
| device_id  <br />*facultatif* | IDFA/AdID/Android ID<br /><br />Type : Array[String] |
| handle  <br />*facultatif* | Le(s) @handle de l’utilisateur<br /><br />Type : Array[String] |
| twitter_id  <br />*facultatif* | L’ID X de l’utilisateur<br /><br />Type : Array[String] |
| phone_number  <br />*facultatif* | Numéro(s) de téléphone de l’utilisateur<br /><br />Type : Array[String] |
| partner_user_id  <br />*facultatif* | L’ID de l’utilisateur dans le système du partenaire.<br /><br />Type : Array[String] |

<div id="example-request">
  #### Exemple de requête[](#example-request "Permalink to this headline")
</div>

`POST https://ads-api.x.com/12/accounts/18ce54d4x5t/custom_audiences/1nmth/users`

```
    [
      {
        "operation_type": "Update",
        "params": {
          "effective_at": "2018-05-15T00:00:00Z",
          "expires_at": "2019-01-01T07:00:00Z",
          "users": [
            {
              "email": [
                "4798b8bbdcf6f2a52e527f46a3d7a7c9aefb541afda03af79c74809ecc6376f3"
              ],
              "handle": [
                "7352f353c460e74c7ae226952d04f8aa307b12329c5512ec8cb6f1a0f8f9b2cb",
                "49e0be2aeccfb51a8dee4c945c8a70a9ac500cf6f5cb08112575f74db9b1470d"
              ]
            },
            {
              "email": [
                "5bf13d5ad4200407c5bc8b9bb578e425d05ef936fd488e3799a9d0806669223c"
              ],
              "twitter_id": [
                "34d56c7159a7eea941f359653029410f813f65a1d2d13ecc5ccbdd5a8cb755cf",
                "00e7b76c9739dec57f4c4a20ec021a20ffcf26bd00f519b17ea00f0ed6048f85"
              ]
            }
          ]
        }
      },
      {
        "operation_type": "Delete",
        "params": {
          "effective_at": "2018-05-15T00:00:00Z",
          "expires_at": "2019-01-01T07:00:00Z",
          "users": [
            {
              "device_id": [
                "8d969eef6ecad3c29a3a629280e686cf0c3f5d5a86aff3ca12020c923adc6c92"
              ],
              "email": [
                "4798b8bbdcf6f2a52e527f46a3d7a7c9aefb541afda03af79c74809ecc6376f3"
              ],
              "handle": [
                "461222f5dd690a20651c3d19848015cb0369db3f8e937571ffb775de70750847"
              ],
              "twitter_id": [
                "c623c7e163984493b46c547088542e95d0aaa529bc52bbecce3ff91eb6b7843b"
              ]
            },
            {
              "email": [
                "5bf13d5ad4200407c5bc8b9bb578e425d05ef936fd488e3799a9d0806669223c"
              ],
              "twitter_id": [
                "858cdc7f313f84a3f3c48e9a6323307c1ef1bb7439b8e3623e140454b0fd8fa5",
                "bb074e154657b91d99bd1bb3757409149670e8ae7a0fe9136fae29a26a7881c8"
              ]
            }
          ]
        }
      }
    ]
```

<div id="example-response">
  #### Exemple de réponse[](#example-response "Permalink to this headline")
</div>

```
    {
      "request": {
        "params": {
          "account_id": "18ce54d4x5t",
          "custom_audience_id": "1nmth"
        }
      },
      "data": {
        "success_count": 4,
        "total_count": 4
      }
    }
```

<div id="custom-audience-permissions">
  ### Autorisations des audiences personnalisées
</div>

<Button href="https://app.getpostman.com/run-collection/369a02c0adc626ff6a06#?env%5BTwitter%20Ads%20API%5D=W3sia2V5IjoiYWNjb3VudF9pZCIsInZhbHVlIjoieW91cl9hZHNfYWNjb3VudF9pZCIsImVuYWJsZWQiOnRydWV9LHsia2V5IjoidmVyc2lvbiIsInZhbHVlIjoiNSIsImVuYWJsZWQiOnRydWV9LHsia2V5IjoiY29uc3VtZXJfa2V5IiwidmFsdWUiOiJ5b3VyX2NvbnN1bWVyX2tleSIsImVuYWJsZWQiOnRydWV9LHsia2V5IjoiY29uc3VtZXJfc2VjcmV0IiwidmFsdWUiOiJ5b3VyX2NvbnN1bWVyX3NlY3JldCIsImVuYWJsZWQiOnRydWV9LHsia2V5IjoiYWNjZXNzX3Rva2VuIiwidmFsdWUiOiJ5b3VyX2FjY2Vzc190b2tlbiIsImVuYWJsZWQiOnRydWV9LHsia2V5IjoidG9rZW5fc2VjcmV0IiwidmFsdWUiOiJ5b3VyX3Rva2VuX3NlY3JldCIsImVuYWJsZWQiOnRydWV9XQ==">
  Exécuter dans Postman
</Button>

<div id="get-accountsaccount_idcustom_audiencescustom_audience_idpermissions">
  #### GET accounts/:account_id/custom_audiences/:custom_audience_id/permissions[](#get-accounts-account-id-custom-audiences-custom-audience-id-permissions "Permalink to this headline")
</div>

Récupère les détails de tout ou partie des autorisations associées à l’audience personnalisée spécifiée.

**Resource URL[](#resource-url "Permalink to this headline")**

`https://ads-api.x.com/12/accounts/:account_id/custom_audiences/:custom_audience_id/permissions`

**Parameters[](#parameters "Permalink to this headline")**

| Name | Description |
| :--- | :--- |
| account_id  <br />*required* | L’identifiant du compte utilisé. Apparaît dans le chemin de la ressource et est généralement un paramètre requis pour toutes les requêtes de l’Ads API, à l’exception de [GET accounts](/fr/x-ads-api/campaign-management#accounts). Le compte spécifié doit être associé à l’utilisateur authentifié.<br /><br />Type: string<br /><br />Example: `18ce54d4x5t` |
| custom_audience_id  <br />*required* | Référence à l’audience personnalisée ciblée par la requête.<br /><br />Type: string<br /><br />Example: `1nmth` |
| count  <br />*optional* | Spécifie le nombre d’enregistrements à récupérer par requête.<br /><br />Type: int<br /><br />Default: `200`  <br />Min, Max: `1`, `1000` |
| cursor  <br />*optional* | Spécifie un curseur pour obtenir la page suivante de résultats. Voir [Pagination](/fr/x-ads-api/introduction) pour plus d’informations.<br /><br />Type: string<br /><br />Example: `8x7v00oow` |
| granted_account_ids  <br />*optional* | Restreint la réponse aux comptes souhaités en indiquant une liste d’identifiants séparés par des virgules. Jusqu’à 200 ID peuvent être fournis.<br /><br />Type: string<br /><br />Example: `18ce54aymz3` |
| sort_by  <br />*optional* | Trie selon un attribut pris en charge, par ordre croissant ou décroissant. Voir [Sorting](/fr/x-ads-api/fundamentals/sorting) pour plus d’informations.<br /><br />Type: string<br /><br />Example: `created_at-asc` |
| custom_audience_permission_ids  <br />*optional* | Restreint la réponse aux autorisations d’audience personnalisée souhaitées en indiquant une liste d’identifiants séparés par des virgules. Jusqu’à 200 ID peuvent être fournis.<br /><br />Type: string<br /><br />Example: `ri` |
| with_total_count  <br />*optional* | Inclut l’attribut de réponse `total_count`.<br /><br />**Remarque** : ce paramètre et `cursor` sont mutuellement exclusifs.<br /><br />**Remarque** : les requêtes qui incluent `total_count` ont des limites de débit plus faibles, actuellement fixées à 200 par 15 minutes.<br /><br />Type: boolean<br /><br />Default: `false`  <br />Possible values: `true`, `false` |

**Example Request[](#example-request "Permalink to this headline")**

`GET https://ads-api.x.com/12/accounts/18ce54d4x5t/custom_audiences/1nmth/permissions`

**Example Response[](#example-response "Permalink to this headline")**

```
    {
      "request": {
        "params": {
          "account_id": "18ce54d4x5t",
          "custom_audience_id": "1nmth"
        }
      },
      "next_cursor": null,
      "data": [
        {
          "custom_audience_id": "1nmth",
          "permission_level": "READ_ONLY",
          "id": "ri",
          "created_at": "2017-06-08T23:17:59Z",
          "granted_account_id": "18ce54aymz3",
          "updated_at": "2017-06-08T23:17:59Z",
          "deleted": false
        }
      ]
    }
```

<div id="post-accountsaccount_idcustom_audiencescustom_audience_idpermissions">
  #### POST accounts/:account_id/custom_audiences/:custom_audience_id/permissions[](#post-accounts-account-id-custom-audiences-custom-audience-id-permissions "Permalink to this headline")
</div>

Crée un nouvel objet d’autorisation permettant de partager l’audience spécifiée avec un compte donné.

**Remarque** : La création ou la modification d’autorisations pour une audience personnalisée exige que l’audience appartienne au compte qui tente de modifier les autorisations. Vous pouvez vérifier la propriété d’une audience personnalisée en consultant l’attribut de réponse `is_owner` dans la réponse pour une audience donnée.

**Remarque** : Les audiences ne peuvent être partagées qu’entre des comptes publicitaires relevant de la même entreprise, ou si le compte publicitaire propriétaire de l’audience dispose de la fonctionnalité de compte `SHARE_AUDIENCE_OUTSIDE_BUSINESS`.

**Resource URL[](#resource-url "Permalink to this headline")**

`https://ads-api.x.com/12/accounts/:account_id/custom_audiences/:custom_audience_id/permissions`

**Parameters[](#parameters "Permalink to this headline")**

| Name | Description |
| :--- | :--- |
| account_id  <br />*required* | L’identifiant du compte exploité. Apparaît dans le chemin de la ressource et est généralement un paramètre requis pour toutes les requêtes de l’API Advertiser, à l’exception de [GET accounts](/fr/x-ads-api/campaign-management#accounts). Le compte spécifié doit être associé à l’utilisateur authentifié.<br /><br />Type: string<br /><br />Example: `18ce54d4x5t` |
| granted_account_id  <br />*required* | Le compte auquel vous souhaitez accorder des autorisations sur l’audience personnalisée.<br /><br />Type: string<br /><br />Example: `18ce54aymz3` |
| permission_level  <br />*required* | Le type d’accès à l’audience personnalisée dont `granted_account_id` doit disposer.<br /><br />Type: enum<br /><br />Possible values: `READ_ONLY`, `READ_WRITE` |
| custom_audience_id  <br />*required* | La référence à l’audience personnalisée utilisée dans la requête.<br /><br />Type: string<br /><br />Example: `2906h` |

**Example Request[](#example-request "Permalink to this headline")**

```
POST https://ads-api.x.com/12/accounts/18ce54d4x5t/custom_audiences/2906h/permissions?granted_account_id=18ce54aymz3&permission_level=READ_ONLY
```

**Example Response[](#example-response "Permalink to this headline")**

```
    {
      "request": {
        "params": {
          "account_id": "18ce54d4x5t",
          "granted_account_id": "18ce54aymz3",
          "permission_level": "READ_ONLY",
          "custom_audience_id": "2906h"
        }
      },
      "data": {
        "custom_audience_id": "2906h",
        "permission_level": "READ_ONLY",
        "id": "14m",
        "created_at": "2017-09-12T23:49:34Z",
        "granted_account_id": "18ce54aymz3",
        "updated_at": "2017-09-12T23:49:34Z",
        "deleted": false
      }
    }
```

<div id="delete-accountsaccount_idcustom_audiencescustom_audience_idpermissionscustom_audience_permission_id">
  #### DELETE accounts/:account_id/custom_audiences/:custom_audience_id/permissions/:custom_audience_permission_id[](#delete-accounts-account-id-custom-audiences-custom-audience-id-permissions-custom-audience-permission-id "Permalink to this headline")
</div>

Révoque l’autorisation de partage de l’audience personnalisée spécifiée.

**Remarque** : la création ou la modification des autorisations pour une audience personnalisée exige que l’audience soit détenue par le compte qui tente de modifier ces autorisations. Vous pouvez vérifier la propriété d’une audience personnalisée en consultant l’attribut de réponse `is_owner` dans la réponse pour une audience donnée.

Une fois révoquée, nous garantissons que le compte destinataire (`granted_account_id`) ne pourra pas cibler l’audience dans de futures campagnes. Les campagnes existantes continueront de s’exécuter avec les audiences partagées ; les campagnes ne s’arrêtent pas et l’audience n’est pas supprimée de la campagne. Il n’est pas possible de copier cette campagne après la révocation de l’autorisation de partage de l’audience.

**URL de la ressource[](#resource-url "Permalink to this headline")**

`https://ads-api.x.com/12/accounts/:account_id/custom_audiences/:custom_audience_id/permissions/:custom_audience_permission_id`

**Paramètres[](#parameters "Permalink to this headline")**

| Nom | Description |
| :--- | :--- |
| account_id  <br />*obligatoire* | Identifiant du compte utilisé. Apparaît dans le chemin de la ressource et est généralement un paramètre requis pour toutes les requêtes de l’API Advertiser, à l’exception de [GET accounts](/fr/x-ads-api/campaign-management#accounts). Le compte spécifié doit être associé à l’utilisateur authentifié.<br /><br />Type : string<br /><br />Exemple : `18ce54d4x5t` |
| custom_audience_id  <br />*obligatoire* | Référence à l’audience personnalisée utilisée dans la requête.<br /><br />Type : string<br /><br />Exemple : `1nmth` |
| custom_audience_permission_id  <br />*obligatoire* | Référence à l’autorisation de l’audience personnalisée utilisée dans la requête.<br /><br />Type : string<br /><br />Exemple : `ri` |

**Exemple de requête[](#example-request "Permalink to this headline")**

`DELETE https://ads-api.x.com/12/accounts/18ce54d4x5t/custom_audiences/1nmth/permissions/ri`

**Exemple de réponse[](#example-response "Permalink to this headline")**

```
    {
      "request": {
        "params": {
          "account_id": "18ce54d4x5t",
          "custom_audience_permission_id": "ri",
          "custom_audience_id": "1nmth"
        }
      },
      "data": {
        "custom_audience_id": "1nmth",
        "permission_level": "READ_ONLY",
        "id": "ri",
        "created_at": "2017-06-08T23:17:59Z",
        "granted_account_id": "18ce54aymz3",
        "updated_at": "2017-08-30T18:29:35Z",
        "deleted": true
      }
    }
```

<div id="custom-audiences">
  ### Audiences personnalisées
</div>

<Button href="https://app.getpostman.com/run-collection/1d12b9fc623b8e149f87">
  Exécuter dans Postman
</Button>

<div id="get-accountsaccount_idcustom_audiences">
  #### GET accounts/:account_id/custom_audiences[](#get-accounts-account-id-custom-audiences "Permalink to this headline")
</div>

Récupère les détails d’une partie ou de l’ensemble des audiences personnalisées associées au compte actuel.

**Resource URL[](#resource-url "Permalink to this headline")**

`https://ads-api.x.com/12/accounts/:account_id/custom_audiences`

**Parameters[](#parameters "Permalink to this headline")**

| Name | Description |
| :--- | :--- |
| account_id  <br />*required* | L’identifiant du compte utilisé. Apparaît dans le chemin de la ressource et est généralement un paramètre requis pour toutes les requêtes de l’API Advertiser, à l’exception de [GET accounts](/fr/x-ads-api/campaign-management#accounts). Le compte spécifié doit être associé à l’utilisateur authentifié.<br /><br />Type: string<br /><br />Example: `18ce54d4x5t` |
| count  <br />*optional* | Spécifie le nombre d’enregistrements à tenter de récupérer par requête distincte.<br /><br />Type: int<br /><br />Default: `200`  <br />Min, Max: `1`, `1000` |
| cursor  <br />*optional* | Spécifie un curseur pour obtenir la page suivante de résultats. Voir [Pagination](/fr/x-ads-api/introduction) pour plus d’informations.<br /><br />Type: string<br /><br />Example: `8x7v00oow` |
| permission_scope  <br />*optional* | Permet de filtrer la réponse sur les listes que vous possédez ou celles qui ont été partagées avec vous. Par défaut, sans préciser ce paramètre, vous ne verrez que les audiences que vous possédez.<br /><br />Type: enum<br /><br />Default: `OWNER`  <br />Possible values: `OWNER`, `SHARED` |
| q  <br />*optional* | Requête optionnelle pour restreindre la ressource par `name`.<br /><br />**Note**: Effectue une correspondance de préfixe insensible à la casse.<br /><br />Type: string<br /><br />Min, Max length: `1`, `255` |
| sort_by  <br />*optional* | Trie selon un attribut pris en charge, par ordre croissant ou décroissant. Voir [Sorting](/fr/x-ads-api/fundamentals/sorting) pour plus d’informations.<br /><br />Type: string<br /><br />Example: `created_at-asc` |
| custom_audience_ids  <br />*optional* | Limite la réponse aux audiences personnalisées souhaitées en spécifiant une liste d’identifiants séparés par des virgules. Jusqu’à 200 ID peuvent être fournis.<br /><br />Type: string<br /><br />Example: `1nmth` |
| with_deleted  <br />*optional* | Inclure les résultats supprimés dans la réponse.<br /><br />Type: boolean<br /><br />Default: `false`  <br />Possible values: `true`, `false` |
| with_total_count  <br />*optional* | Inclure l’attribut de réponse `total_count`.<br /><br />**Note**: Ce paramètre et `cursor` sont mutuellement exclusifs.<br /><br />**Note**: Les requêtes incluant `total_count` ont des limites de débit plus faibles, actuellement fixées à 200 par tranche de 15 minutes.<br /><br />Type: boolean<br /><br />Default: `false`  <br />Possible values: `true`, `false` |

**Example Request[](#example-request "Permalink to this headline")**

`GET https://ads-api.x.com/12/accounts/18ce54d4x5t/custom_audiences?custom_audience_ids=1nmth`

**Example Response[](#example-response "Permalink to this headline")**

```
    {
      "request": {
        "params": {
          "custom_audience_ids": [
            "1nmth"
          ],
          "account_id": "18ce54d4x5t"
        }
      },
      "next_cursor": null,
      "data": [
        {
          "targetable": true,
          "name": "twurl-using-subshell-for-file",
          "targetable_types": [
            "CRM",
            "EXCLUDED_CRM"
          ],
          "audience_type": "CRM",
          "description": null,
          "permission_level": "READ_WRITE",
          "owner_account_id": "18ce54d4x5t",
          "id": "1nmth",
          "reasons_not_targetable": [],
          "created_at": "2017-01-08T08:19:58Z",
          "updated_at": "2017-01-08T16:21:13Z",
          "partner_source": "OTHER",
          "deleted": false,
          "audience_size": 1470
        }
      ]
    }
```

<div id="get-accountsaccount_idcustom_audiencescustom_audience_id">
  #### GET accounts/:account_id/custom_audiences/:custom_audience_id[](#get-accounts-account-id-custom-audiences-custom-audience-id "Permalink to this headline")
</div>

Récupérer des Custom Audiences spécifiques associées au compte en cours.

**URL de la ressource[](#resource-url "Permalink to this headline")**

`https://ads-api.x.com/12/accounts/:account_id/custom_audiences/:custom_audience_id`

**Paramètres[](#parameters "Permalink to this headline")**

| Nom | Description |
| :--- | :--- |
| account_id  <br />*obligatoire* | L’identifiant du compte utilisé. Apparaît dans le chemin de la ressource et est généralement un paramètre requis pour toutes les requêtes de l’API Advertiser, à l’exception de [GET accounts](/fr/x-ads-api/campaign-management#accounts). Le compte spécifié doit être associé à l’utilisateur authentifié.<br /><br />Type : string<br /><br />Exemple : `18ce54d4x5t` |
| custom_audience_id  <br />*obligatoire* | La référence à la Custom Audience utilisée dans la requête.<br /><br />Type : string<br /><br />Exemple : `2906h` |
| with_deleted  <br />*optionnel* | Inclure les résultats supprimés dans la réponse.<br /><br />Type : boolean<br /><br />Valeur par défaut : `false`  <br />Valeurs possibles : `true`, `false` |

**Exemple de requête[](#example-request "Permalink to this headline")**

`GET https://ads-api.x.com/12/accounts/18ce54d4x5t/custom_audiences/2906h`

**Exemple de réponse[](#example-response "Permalink to this headline")**

```
    {
      "request": {
        "params": {
          "custom_audience_id": "2906h",
          "account_id": "18ce54d4x5t"
        }
      },
      "data": {
        "targetable": false,
        "name": "developers",
        "targetable_types": [
          "CRM",
          "EXCLUDED_CRM"
        ],
        "audience_type": "CRM",
        "description": null,
        "permission_level": "READ_WRITE",
        "owner_account_id": "18ce54d4x5t",
        "id": "2906h",
        "reasons_not_targetable": [],
        "created_at": "2017-08-22T23:34:26Z",
        "updated_at": "2017-08-22T23:34:26Z",
        "partner_source": "OTHER",
        "deleted": false,
        "audience_size": 140321
      }
    }
```

<div id="post-accountsaccount_idcustom_audiences">
  #### POST accounts/:account_id/custom_audiences[](#post-accounts-account-id-custom-audiences "Permalink to this headline")
</div>

Crée une nouvelle Audience personnalisée de type espace réservé (placeholder) associée au compte actuel.

**Resource URL[](#resource-url "Permalink to this headline")**

`https://ads-api.x.com/12/accounts/:account_id/custom_audiences`

**Parameters[](#parameters "Permalink to this headline")**

| Name | Description |
| :--- | :--- |
| account_id  <br />*required* | L’identifiant du compte exploité. Apparaît dans le chemin de la ressource et est généralement un paramètre requis pour toutes les requêtes de l’API Advertiser, à l’exception de [GET accounts](/fr/x-ads-api/campaign-management#accounts). Le compte spécifié doit être associé à l’utilisateur authentifié.<br /><br />Type : string<br /><br />Exemple : `18ce54d4x5t` |
| name  <br />*required* | Le nom d’affichage de cette audience. Un nom unique doit être utilisé. Dans le cas contraire, une erreur sera renvoyée.<br /><br />Type : string<br /><br />Exemple : `ads api users` |
| description  <br />*optional* | Une description de cette audience.<br /><br />Type : string<br /><br />Exemple : `Collection of all users of the Ads API` |

**Example Request[](#example-request "Permalink to this headline")**

`POST https://ads-api.x.com/12/accounts/18ce54d4x5t/custom_audiences?name=developers`

**Example Response[](#example-response "Permalink to this headline")**

```
    {
      "data": {
        "targetable": false,
        "name": "developers",
        "targetable_types": [
          "CRM",
          "EXCLUDED_CRM"
        ],
        "audience_type": "CRM",
        "description": null,
        "permission_level": "READ_WRITE",
        "owner_account_id": "18ce54d4x5t",
        "id": "2906h",
        "reasons_not_targetable": [
          "PROCESSING",
          "TOO_SMALL"
        ],
        "created_at": "2017-08-22T23:34:26Z",
        "updated_at": "2017-08-22T23:34:26Z",
        "partner_source": "OTHER",
        "deleted": false,
        "audience_size": null
      },
      "request": {
        "params": {
          "account_id": "18ce54d4x5t",
          "name": "developers"
        }
      }
    }
```

<div id="put-accountsaccount_idcustom_audiencescustom_audience_id">
  #### PUT accounts/:account_id/custom_audiences/:custom_audience_id[](#put-accounts-account-id-custom-audiences-custom-audience-id "Permalink to this headline")
</div>

Met à jour l’Audience personnalisée spécifique associée au compte actuel.

**URL de la ressource[](#resource-url "Permalink to this headline")**

`https://ads-api.x.com/12/accounts/:account_id/custom_audiences/:custom_audience_id`

**Paramètres[](#parameters "Permalink to this headline")**

| Nom | Description |
| :--- | :--- |
| account_id  <br />*required* | L’identifiant du compte exploité. Apparaît dans le chemin de la ressource et constitue généralement un paramètre requis pour toutes les requêtes de l’Advertiser API, à l’exception de [GET accounts](/fr/x-ads-api/campaign-management#accounts). Le compte spécifié doit être associé à l’utilisateur authentifié.<br /><br />Type : string<br /><br />Exemple : `18ce54d4x5t` |
| custom_audience_id  <br />*required* | La référence à l’Audience personnalisée utilisée dans la requête.<br /><br />Type : string<br /><br />Exemple : `2906h` |
| name  <br />*optional* | Le nom d’affichage de cette audience. Une valeur de nom unique doit être utilisée, faute de quoi une erreur sera renvoyée.<br /><br />Type : string<br /><br />Exemple : `ads api users` |
| description  <br />*optional* | Une description de cette audience.<br /><br />Type : string<br /><br />Exemple : `Collection of all users of the Ads API` |

**Exemple de requête[](#example-request "Permalink to this headline")**

`PUT https://ads-api.x.com/12/accounts/18ce54d4x5t/custom_audiences/2906h?name=developers_changed`

**Exemple de réponse[](#example-response "Permalink to this headline")**

```
    {
      "data": {
        "targetable": false,
        "name": "developers_changed",
        "targetable_types": [
          "CRM",
          "EXCLUDED_CRM"
        ],
        "audience_type": "CRM",
        "description": null,
        "permission_level": "READ_WRITE",
        "is_owner": true,
        "id": "2906h",
        "reasons_not_targetable": [
          "PROCESSING",
          "TOO_SMALL"
        ],
        "created_at": "2017-08-22T23:34:26Z",
        "updated_at": "2017-08-22T23:34:26Z",
        "partner_source": "OTHER",
        "deleted": false,
        "audience_size": null
      },
      "request": {
        "params": {
          "account_id": "18ce54d4x5t",
          "name": "developers_changed"
        }
      }
    }
```

<div id="post-batchaccountsaccount_idcustom_audiences">
  #### POST batch/accounts/:account_id/custom_audiences[](#post-batch-accounts-account-id-custom-audiences "Permalink to this headline")
</div>

Permet la création d’audiences personnalisées par lot. Consultez la page [Présentation des Custom Audiences](/fr/x-ads-api/audiences) pour plus d’informations sur les audiences.

**Remarque :** Cet endpoint par lot est actuellement en **bêta fermée** et disponible pour un nombre restreint d’annonceurs. Pendant cette période de bêta, seules les Flexible Audiences basées sur des audiences personnalisées mobiles peuvent être créées.

**Requêtes par lot**

* La taille maximale actuelle d’un lot est de 10.
* Tous les paramètres sont envoyés dans le corps de la requête et un `Content-Type` de `application/json` est requis.
* Les requêtes par lot échouent ou réussissent ensemble en tant que groupe, et toutes les réponses de l’API — qu’il s’agisse d’erreurs ou de succès — conservent l’ordre des éléments de la requête initiale.

**Réponses par lot**

Les réponses de l’API par lot renvoient une collection ordonnée d’éléments. Pour le reste, elles sont identiques, dans leur structure, à leurs endpoints correspondants à élément unique.

**Erreurs par lot**

* Les erreurs au niveau de la requête (par ex. dépassement de la taille maximale du lot) apparaissent dans la réponse sous l’objet `errors`.
* Les erreurs au niveau de l’élément (par ex. paramètre requis manquant) apparaissent dans la réponse sous l’objet `operation_errors`.

**Flexible Audiences**

<Button href="https://app.getpostman.com/run-collection/1d12b9fc623b8e149f87">
  Exécuter dans Postman
</Button>

* Les Flexible Audiences sont immuables une fois créées.
* Les Custom Audiences sont transmises sous forme d’arbre, avec des combinaisons de logique booléenne, pour créer des Flexible Audiences.
* Un maximum de 10 nœuds feuilles de Custom Audiences peut être utilisé pour créer une Flexible Audience.

**URL de la ressource[](#resource-url "Permalink to this headline")**

`https://ads-api.x.com/12/batch/accounts/:account_id/custom_audiences`

**Paramètres[](#parameters "Permalink to this headline")**

| Nom | Description |
| :--- | :--- |
| account_id  <br />*obligatoire* | L’identifiant du compte utilisé. Apparaît dans le chemin de la ressource et constitue généralement un paramètre requis pour toutes les requêtes de l’API Advertiser, à l’exception de [GET accounts](/fr/x-ads-api/campaign-management#accounts). Le compte spécifié doit être associé à l’utilisateur authentifié.<br /><br />Type : string<br /><br />Exemple : `18ce54d4x5t` |
| audience_type  <br />*obligatoire* | Le type d’audience à créer.<br /><br />Type : enum<br /><br />Valeurs possibles : `FLEXIBLE`, `MOBILE_AUDIENCE` |
| child_segments  <br />*obligatoire* | Un tableau d’objets qui définissent le sous-ensemble des membres d’une Custom Audience que vous souhaitez cibler. Chaque objet doit contenir un `custom_audience_id`, `frequency`, `frequency_comparator`, `lookback_window`, `negate` et, dans certains cas, des `child_segments` supplémentaires.<br /><br />Type : array |
| name  <br />*obligatoire* | Le nom d’affichage de l’audience. Une valeur de nom unique doit être utilisée. Dans le cas contraire, une erreur se produira.<br /><br />Type : string<br /><br />Exemple : `my_flexible_audience_name` |
| operation_type  <br />*obligatoire* | Le type d’opération appliqué à chaque élément.<br /><br />Type : enum<br /><br />Valeurs possibles : `Create`, `Update`, `Delete` |
| boolean_operator  <br />*parfois obligatoire* | La relation logique entre les segments enfants dans l’objet parent (contenant). Requis si child_segments n’est pas vide pour l’objet parent.<br /><br />Type : enum<br /><br />Valeurs possibles : `AND`, `OR` |
| lookback_window  <br />*parfois obligatoire* | Valeur entière indiquant l’intervalle de jours durant lequel l’utilisateur a effectué l’action spécifique et a été qualifié pour la custom audience donnée.<br /><br />Type : int<br /><br />Valeurs possibles : `1`, `7`, `14`, `30` |
| segments  <br />*parfois obligatoire* | Un objet contenant un `boolean_operator` et des `child_segments` qui définissent le sous-ensemble des membres d’une Custom Audience que vous souhaitez cibler.<br /><br />Type : object |
| custom_audience_id  <br />*parfois obligatoire* | L’ID de la custom audience à utiliser comme segment enfant.<br /><br />Type : string<br /><br />Exemple : `tyfo` |
| frequency  <br />*optionnel* | Valeur entière indiquant la fréquence, dans la fenêtre de rétrospection, à laquelle l’utilisateur a effectué l’action spécifique et a été qualifié pour la custom audience donnée.<br /><br />Type : int<br /><br />Valeur par défaut : `1` |
| frequency_comparator  <br />*optionnel* | Le comparateur de la valeur `frequency` transmise dans la requête.<br /><br />**Remarque** : Dans les valeurs ci-dessous, `GTE` signifie supérieur ou égal, `LT` inférieur, etc.<br /><br />Type : string<br /><br />Valeurs possibles : `NUM_GTE`, `NUM_GT`, `NUM_EQ`, `NUM_LTE`, `NUM_LT` Valeur par défaut : `NUM_GTE` |
| negate  <br />*optionnel* | Inverse le segment, qui est alors exclu de la combinaison.<br /><br />Type : boolean<br /><br />Valeur par défaut : `true`  <br />Valeurs possibles : `true`, `false` |

**Exemple de requête[](#example-request "Permalink to this headline")**

`POST https://ads-api.x.com/12/batch/accounts/18ce54d4x5t/custom_audiences`

```
    [
      {
        "operation_type":"Create",
        "params":{
          "name":"my_flexible_audience_name",
          "audience_type":"FLEXIBLE",
          "segments":{
            "boolean_operator":"AND",
            "child_segments":[
              {
                "custom_audience_id":"TYIF",
                "frequency":1,
                "frequency_comparator":"NUM_GT",
                "lookback_window":30,
                "negate":true,
                "child_segments":[

                ]
              },
              {
                "boolean_operator":"OR",
                "child_segments":[
                  {
                    "custom_audience_id":"TXR1",
                    "lookback_window":30,
                    "child_segments":[

                    ]
                  },
                  {
                    "custom_audience_id":"TYFO",
                    "frequency":1,
                    "frequency_comparator":"NUM_GT",
                    "lookback_window":30,
                    "negate":true,
                    "child_segments":[

                    ]
                  }
                ]
              }
            ]
          }
        }
      }
    ]
```

**Exemple de réponse[](#example-response "Permalien vers ce titre")**

```
    {
      "data": {
        "targetable": false,
        "name": "my_flexible_audience_name",
        "targetable_types": [
          "FLEXIBLE",
          "EXCLUDED_FLEXIBLE"
        ],
        "audience_type": "FLEXIBLE",
        "id": "13ld7",
        "reasons_not_targetable": [
          "PROCESSING",
          "TOO_SMALL"
        ],
        "metadata": [
          {
            "custom_audience_id": "13ld7",
            "account_id": "qsx3w2",
            "name": "my_flexible_audience_name",
            "audience_source": "FLEXIBLE_AUDIENCE",
            "upload_status": "UPLOADED",
            "segments": {
              "boolean_operator": "AND",
              "frequency": 1,
              "frequency_comparator": "NUM_GTE",
              "negate": false,
              "child_segments": [
                {
                  "custom_audience_id": "tyif",
                  "lookback_window": 30,
                  "frequency": 1,
                  "frequency_comparator": "NUM_GT",
                  "negate": true,
                  "child_segments": [

                  ]
                },
                {
                  "boolean_operator": "OR",
                  "frequency": 1,
                  "frequency_comparator": "NUM_GTE",
                  "negate": false,
                  "child_segments": [
                    {
                      "custom_audience_id": "txr1",
                      "lookback_window": 30,
                      "frequency": 1,
                      "frequency_comparator": "NUM_GTE",
                      "negate": false,
                      "child_segments": [

                      ]
                    },
                    {
                      "custom_audience_id": "tyfo",
                      "lookback_window": 30,
                      "frequency": 1,
                      "frequency_comparator": "NUM_GT",
                      "negate": true,
                      "child_segments": [

                      ]
                    }
                  ]
                }
              ]
            }
          }
        ],
        "created_at": "2015-11-10T21:26:43Z",
        "updated_at": "2015-11-11T01:11:47Z",
        "partner_source": "OTHER",
        "deleted": false,
        "audience_size": null
      },
      "request": [
        {
          "params": {
            "name": "my_flexible_audience_name",
            "audience_type": "FLEXIBLE",
            "segments": {
              "boolean_operator": "AND",
              "child_segments": [
                {
                  "custom_audience_id": "TYIF",
                  "lookback_window": 30,
                  "frequency": 1,
                  "frequency_comparator": "NUM_GT",
                  "negate": true,
                  "child_segments": [

                  ]
                },
                {
                  "boolean_operator": "OR",
                  "child_segments": [
                    {
                      "custom_audience_id": "TXR1",
                      "lookback_window": 30,
                      "child_segments": [

                      ]
                    },
                    {
                      "custom_audience_id": "TYFO",
                      "lookback_window": 30,
                      "frequency": 1,
                      "frequency_comparator": "NUM_GT",
                      "negate": true,
                      "child_segments": [

                      ]
                    }
                  ]
                }
              ]
            },
            "account_id": "qsx3w2"
          },
          "operation_type": "Create"
        }
      ]
    }
```

<div id="delete-accountsaccount_idcustom_audiencescustom_audience_id">
  #### DELETE accounts/:account_id/custom_audiences/:custom_audience_id[](#delete-accounts-account-id-custom-audiences-custom-audience-id "Permalink to this headline")
</div>

Supprime l’Audience personnalisée spécifiée appartenant au compte actuel.

**Resource URL[](#resource-url "Permalink to this headline")**

`https://ads-api.x.com/12/accounts/:account_id/custom_audiences/:custom_audience_id`

**Parameters[](#parameters "Permalink to this headline")**

| Name | Description |
| :--- | :--- |
| account_id  <br />*required* | L’identifiant du compte exploité. Apparaît dans le chemin de la ressource et constitue généralement un paramètre requis pour toutes les requêtes de l’Advertiser API, à l’exception de [GET accounts](/fr/x-ads-api/campaign-management#accounts). Le compte spécifié doit être associé à l’utilisateur authentifié.<br /><br />Type : string<br /><br />Exemple : `18ce54d4x5t` |
| custom_audience_id  <br />*required* | Référence à l’audience personnalisée concernée par la requête.<br /><br />Type : string<br /><br />Exemple : `2906h` |

**Example Request[](#example-request "Permalink to this headline")**

`DELETE https://ads-api.x.com/12/accounts/18ce54d4x5t/custom_audiences/2906h`

**Example Response[](#example-response "Permalink to this headline")**

```
    {
      "data": {
        "targetable": false,
        "name": "developers",
        "targetable_types": [
          "CRM",
          "EXCLUDED_CRM"
        ],
        "audience_type": "CRM",
        "description": null,
        "permission_level": "READ_WRITE",
        "owner_account_id": "18ce54d4x5t",
        "id": "2906h",
        "reasons_not_targetable": [
          "TOO_SMALL"
        ],
        "created_at": "2017-08-22T23:34:26Z",
        "updated_at": "2017-08-30T18:09:00Z",
        "partner_source": "OTHER",
        "deleted": true,
        "audience_size": null
      },
      "request": {
        "params": {
          "custom_audience_id": "2906h",
          "account_id": "18ce54d4x5t"
        }
      }
    }
```

<div id="do-not-reach-lists">
  ### Listes « ne pas contacter »
</div>

<Button href="https://app.getpostman.com/run-collection/1d12b9fc623b8e149f87">
  Exécuter dans Postman
</Button>

<div id="get-accountsaccount_iddo_not_reach_lists">
  #### GET accounts/:account_id/do_not_reach_lists[](#get-accounts-account-id-do-not-reach-lists "Permalink to this headline")
</div>

Récupère les détails d’une ou de plusieurs listes Do Not Reach associées au compte actuel.

**Remarque** : Un `account_id` ne peut avoir qu’au plus une liste Do Not Reach.

**Resource URL[](#resource-url "Permalink to this headline")**

`https://ads-api.x.com/12/accounts/:account_id/do_not_reach_lists`

**Parameters[](#parameters "Permalink to this headline")**

| Name | Description |
| :--- | :--- |
| account_id  <br />*required* | L’identifiant du compte utilisé. Apparaît dans le chemin de la ressource et est généralement un paramètre requis pour toutes les requêtes de l’Advertiser API, à l’exception de [GET accounts](/fr/x-ads-api/campaign-management#accounts). Le compte spécifié doit être associé à l’utilisateur authentifié.<br /><br />Type: string<br /><br />Example: `18ce54d4x5t` |
| with_deleted  <br />*optional* | Inclure les résultats supprimés dans la réponse.<br /><br />Type: boolean<br /><br />Default: `false`  <br />Possible values: `true`, `false` |

**Example Request[](#example-request "Permalink to this headline")**

`GET https://ads-api.x.com/12/accounts/18ce54bgxky/do_not_reach_lists`

**Example Response[](#example-response "Permalink to this headline")**

```
    {
      "request": {
        "params": {
          "account_id": "18ce54bgxky"
        }
      },
      "next_cursor": null,
      "data": [
        {
          "targetable": false,
          "name": "Do Not Reach List",
          "description": "test DNRL",
          "id": "4kzrq",
          "reasons_not_targetable": [
            "TOO_SMALL"
          ],
          "created_at": "2021-10-28T22:09:29Z",
          "list_size": null,
          "updated_at": "2021-11-04T03:33:06Z",
          "deleted": false
        }
      ]
    }
```

<div id="post-accountsaccount_iddo_not_reach_lists">
  #### POST accounts/:account_id/do_not_reach_lists[](#post-accounts-account-id-do-not-reach-lists "Permalink to this headline")
</div>

Créer une nouvelle liste « Do Not Reach » associée au compte actuel.

**Remarque** : Un `account_id` ne peut avoir qu’une seule liste « Do Not Reach » au maximum.

**URL de la ressource[](#resource-url "Permalink to this headline")**

`https://ads-api.x.com/12/accounts/:account_id/do_not_reach_lists`

**Paramètres[](#parameters "Permalink to this headline")**

| Nom | Description |
| :--- | :--- |
| account_id  <br />*obligatoire* | L’identifiant du compte exploité. Apparaît dans le chemin de la ressource et constitue généralement un paramètre requis pour toutes les requêtes de l’API Advertiser, à l’exception de [GET accounts](/fr/x-ads-api/campaign-management#accounts). Le compte spécifié doit être associé à l’utilisateur authentifié.<br /><br />Type : string<br /><br />Exemple : `18ce54d4x5t` |
| description  <br />*facultatif* | Une description de cette audience.<br /><br />Type : string<br /><br />Exemple : `A list of users to exclude` |

**Exemple de requête[](#example-request "Permalink to this headline")**

`POST https://ads-api.x.com/12/accounts/18ce54bgxky/do_not_reach_lists?description=A list of users to exclude`

**Exemple de réponse[](#example-response "Permalink to this headline")**

```
    {
      "request": {
        "params": {
          "description": "A list of users to exclude",
          "account_id": "18ce54bgxky"
        }
      },
      "data": {
        "targetable": false,
        "name": "Do Not Reach List",
        "description": "A list of users to exclude",
        "id": "4ofrq",
        "reasons_not_targetable": [
          "PROCESSING",
          "TOO_SMALL"
        ],
        "created_at": "2022-02-08T23:02:48Z",
        "list_size": null,
        "updated_at": "2022-02-08T23:02:48Z",
        "deleted": false
      }
    }
```

<div id="post-batchaccountsaccount_iddo_not_reach_listsdo_not_reach_list_idusers">
  #### POST batch/accounts/:account_id/do_not_reach_lists/:do_not_reach_list_id/users[](#post-batch-accounts-account-id-do-not-reach-lists-do-not-reach-list-id-users "Permalink to this headline")
</div>

Cet endpoint permet d’ajouter, de mettre à jour et de supprimer des utilisateurs d’un `do_not_reach_list_id` donné. Cet endpoint n’accepte que les e-mails comme type d’identifiant utilisateur valide.

Toutes les données fournies dans le champ `emails` de la requête doivent être hachées avec `SHA256` et [normalisées](/fr/x-ads-api/audiences#e-mail-normalization).

**Notes**

* Un `account_id` ne peut avoir qu’une seule Do Not Reach List au maximum
* Les utilisateurs ajoutés à cette liste **doivent** avoir un horodatage `expires_at` défini à moins de 13 mois par rapport à l’horodatage actuel
* L’API Do Not Reach List n’accepte pas d’horodatage `effective_at` et utilise par défaut l’horodatage actuel
* La Do Not Reach List ne supprime pas les utilisateurs d’aucune audience personnalisée du compte, mais sert de ciblage d’exclusion pour toutes les campagnes diffusées pour le compte

**Requêtes par lot**

* La taille maximale actuelle d’un lot est de `2500` **pour cet endpoint**. La taille du lot est déterminée par le nombre d’opérations (`Update`/`Delete`) par requête. Par exemple, plus de 2500 objets d’opération (`{"operation_type": "Update/Delete", [..] }`) dans un même tableau entraînent une erreur.
* La taille maximale du corps POST de la requête que cet endpoint peut accepter est de `5,000,000` octets.
* Les limites de débit pour cet endpoint sont de 1500 par fenêtre de 1 minute.
* Tous les paramètres sont envoyés dans le corps de la requête et un `Content-Type` de `application/json` est requis.
* Les requêtes par lot échouent ou réussissent ensemble en tant que groupe et toutes les réponses de l’API, pour les erreurs comme pour les succès, conservent l’ordre des éléments de la requête initiale.

**Réponses par lot**

La réponse renvoyée par l’Ads API contient deux champs, un `success_count` et un `total_count`. Ces valeurs doivent toujours être égales et correspondent au nombre d’enregistrements de la requête qui ont été traités par le backend. Une situation où le nombre d’enregistrements envoyés dans le corps de la requête n’est **pas** égal à `success_count` et `total_count` doit être considérée comme une erreur et nécessiter une nouvelle tentative.

**Erreurs par lot**

* Les erreurs au niveau de la requête (p. ex. taille maximale du lot dépassée) sont indiquées dans la réponse sous l’objet `errors`.
* Les erreurs au niveau des éléments (p. ex. paramètres requis manquants) sont indiquées dans la réponse sous l’objet `operation_errors`.
* L’index de l’erreur dans `operation_errors` renvoie à l’index de l’élément d’entrée, avec le message d’erreur correspondant

**URL de la ressource[](#resource-url "Permalink to this headline")**

`https://ads-api.x.com/12/batch/accounts/:account_id/do_not_reach_lists/:do_not_reach_list_id/users`

**Paramètres[](#parameters "Permalink to this headline")**

| Name | Description |
| :--- | :--- |
| account_id  <br />*required* | L’identifiant du compte utilisé. Apparaît dans le chemin de la ressource et est généralement un paramètre requis pour toutes les requêtes de l’Advertiser API à l’exception de [GET accounts](/fr/x-ads-api/campaign-management#accounts). Le compte spécifié doit être associé à l’utilisateur authentifié.<br /><br />Type: string<br /><br />Example: `18ce54d4x5t` |
| do_not_reach_list_id  <br />*required* | La référence à la Do Not Reach List utilisée dans la requête<br /><br />Type: string<br /><br />Example: `2906h` |
| operation_type  <br />*required* | Le type d’opération appliqué au groupe `users`.<br /><br />Type: enum<br /><br />Possible values: `Update`, `Delete` |
| params  <br />*required* | Un objet JSON contenant le tableau `emails` et l’horodatage `expires_at`.<br /><br />Type: JSON |
| users  <br />*required* | Un tableau d’objets JSON contenant tous les paramètres pour un utilisateur individuel.<br /><br />Type: JSON |
| expires_at  <br />*optional* | L’heure UTC à laquelle l’association de l’utilisateur doit expirer. L’heure spécifiée doit être postérieure à l’horodatage actuel. Exprimée en [ISO 8601](https://en.wikipedia.org/wiki/ISO_8601). Par défaut, 13 mois à compter de l’horodatage actuel.<br /><br />Type: string<br /><br />Example: `2017-07-05T07:00:00Z` |

Compte tenu de l’approche multi-clé de l’objet `users`, chaque élément de cet objet est documenté ci-dessous :

| Nom | Description |
| :--- | :--- |
| email  <br />*facultatif* | Adresse(s) e-mail de l’utilisateur.<br /><br />Type : Array[String] |
| phone_number  <br />*facultatif* | Numéro(s) de téléphone de l’utilisateur.<br /><br />Type : Array[String] |

**Exemple de requête[](#example-request "Permalink to this headline")**

```
`POST https://ads-api.x.com/12/batch/accounts/18ce54bgxky/do_not_reach_lists/4kzro/users`

    [
      {
        "operation_type": "Update",
        "params": {
          "expires_at": "2023-01-22T00:00:00Z",
          "users": [
            {
              "email": [
                "FEAD76F6ADF99FFFB997AA4E3C8AD38FF531BC4C956DBD03CD0163F744D8AABC"
              ],
              "phone_number": [
                "CCABF1B62A202E0FE28BC6C014983C89A65451DD4482BD66A0ADB65366F38A9A"
              ]
            },
            {
              "email": [
                "FEAD76F6ADF99FFFB997AA4E3C8AD38FF531BC4C956DBD03CD0163F744D8AABA"
              ],
              "phone_number": [
                "CCABF1B62A202E0FE28BC6C014983C89A65451DD4482BD66A0ADB65366F38A9E"
              ]
            }
          ]
        }
      }
    ]
```

**Exemple de réponse[](#example-response "Permalink to this headline")**

```
    {
      "data": [
        {
          "success_count": 2,
          "total_count": 2
        }
      ],
      "request": [
        {
          "params": {
            "do_not_reach_list_id": "4ofrq",
            "expires_at": "2023-01-22T00:00:00Z",
            "account_id": "18ce54bgxky"
          },
          "operation_type": "Update"
        }
      ]
    }
```

<div id="delete-accountsaccount_iddo_not_reach_listsdo_not_reach_list_id">
  #### DELETE accounts/:account_id/do_not_reach_lists/:do_not_reach_list_id[](#delete-accounts-account-id-do-not-reach-lists-do-not-reach-list-id "Permalink to this headline")
</div>

Supprime la liste « Do Not Reach » spécifiée appartenant au compte actuel.

**URL de la ressource[](#resource-url "Permalink to this headline")**

`https://ads-api.x.com/12/accounts/:account_id/do_not_reach_lists/:do_not_reach_list_id`

**Paramètres[](#parameters "Permalink to this headline")**

Aucun

**Exemple de requête[](#example-request "Permalink to this headline")**

`DELETE https://ads-api.x.com/12/accounts/18ce54bgxky/do_not_reach_lists/4ofrp`

**Exemple de réponse[](#example-response "Permalink to this headline")**

```
    {
      "request": {
        "params": {
          "do_not_reach_list_id": "4ofrp",
          "account_id": "18ce54bgxky"
        }
      },
      "data": {
        "targetable": false,
        "name": "Do Not Reach List",
        "description": null,
        "id": "4ofrp",
        "reasons_not_targetable": [
          "PROCESSING",
          "TOO_SMALL"
        ],
        "created_at": "2022-02-08T23:02:07Z",
        "list_size": null,
        "updated_at": "2022-02-08T23:02:21Z",
        "deleted": true
      }
    }
```