---
title: Reprise et redondance
sidebarTitle: Reprise et redondance
---

<div id="introduction">
  #### Introduction
</div>

Lors de la consommation de données en continu, maximiser le temps de connexion et recevoir l’intégralité des données correspondantes est un objectif fondamental. Cela implique d’exploiter les connexions redondantes, de détecter automatiquement les déconnexions, de se reconnecter rapidement et de prévoir un plan de récupération des données perdues.

Dans ce guide d’intégration, nous aborderons différentes fonctionnalités de reprise et de redondance : connexions redondantes, backfill et récupération.
 

**Connexions redondantes**

Une connexion redondante vous permet d’établir plus d’une connexion simultanée au flux filtré. Cela apporte de la résilience en vous permettant de vous connecter au même flux avec deux consommateurs distincts et de recevoir les mêmes données via les deux connexions. Ainsi, votre application dispose d’un basculement à chaud pour diverses situations, par exemple si un flux est interrompu ou si le serveur principal de votre application tombe en panne.

Le flux filtré n’autorise actuellement que les projets disposant d’un accès Enterprise à établir jusqu’à deux connexions redondantes. Pour utiliser un flux redondant, connectez-vous simplement à la même URL que celle de votre connexion principale. Les données de votre flux seront envoyées via les deux connexions.

<div id="recovering-missed-data-after-a-disconnection-backfill">
  #### Récupération des données manquées après une déconnexion : Backfill
</div>

Après avoir détecté une déconnexion, votre système doit être capable de se reconnecter au flux. Si possible, il doit aussi consigner la durée de la déconnexion afin que vous puissiez utiliser la fonctionnalité de récupération adaptée pour reconstituer les données.

Si vous utilisez un Projet avec accès Enterprise et avez constaté que la déconnexion a duré cinq minutes ou moins, vous pouvez utiliser le paramètre de backfill, backfill_minutes. Si vous transmettez ce paramètre avec votre requête [GET /tweets/search/stream](/fr/x-api/posts/filtered-stream#get-2-tweets-search-stream), vous recevrez les Posts correspondant à vos règles sur la période allant d’une à cinq minutes dans le passé. En général, nous livrons d’abord ces Posts plus anciens avant tout nouveau Post correspondant, et nous ne dédupliquons pas les Posts. Cela signifie que si vous avez été déconnecté pendant 90 secondes, mais demandez deux minutes de données de backfill, vous recevrez 30 secondes de Posts en double, ce à quoi votre système doit être tolérant. Voici un exemple de requête avec le paramètre de backfill :

`curl 'https://api.x.com/2/tweets/search/stream?backfill_minutes=5' -H "Authorization: Bearer $ACCESS_TOKEN"`

Si vous n’avez pas l’accès Enterprise, ou avez constaté que la déconnexion a duré plus de cinq minutes, vous pouvez utiliser le [recent search endpoint](/fr/x-api/posts/search/introduction) ou la fonctionnalité de récupération pour demander les données manquées. Notez toutefois que les endpoints de recherche de Posts n’incluent pas les opérateurs sample:, bio:, bio_name: ou bio_location:, et présentent certaines différences de comportement de correspondance lors de l’utilisation des accents et des diacritiques avec les opérateurs keyword et #hashtag. Ces différences peuvent faire que vous ne récupériez pas complètement tous les Posts qui auraient pu être reçus via les endpoints de flux filtré.

**Récupération des données manquées après une déconnexion : Recovery**

Si vous utilisez un Projet avec accès Enterprise, vous pouvez utiliser la fonctionnalité Recovery pour récupérer les données manquées au cours des dernières 24 heures si vous ne parvenez pas à vous reconnecter dans la fenêtre de backfill de 5 minutes.

La fonctionnalité de récupération du streaming vous permet de bénéficier d’une fenêtre de backfill étendue de 24 heures. Recovery vous permet de « rejouer » la période de données manquées. Un flux de récupération démarre lorsque vous effectuez une requête de connexion en utilisant les paramètres de requête &#39;start_time&#39; et &#39;end_time&#39;. Une fois connecté, Recovery rediffusera la période indiquée, puis se déconnectera.

Vous pourrez effectuer 2 requêtes simultanées vers Recovery en même temps, c’est-à-dire « deux jobs de récupération ». Recovery fonctionne techniquement de la même manière que le backfill, sauf qu’une heure de début et une heure de fin sont définies. Une période de récupération correspond à une plage temporelle unique.

|     |     |     |
| :--- | :--- | :--- |
| **Name** | **Type** | **Description** |
| start_time | date (ISO 8601) | YYYY-MM-DDTHH:mm:ssZ (ISO 8601/RFC 3339).<br /><br />Date en UTC indiquant l’heure de début à partir de laquelle récupérer. |
| end_time | date (ISO 8601) | YYYY-MM-DDTHH:mm:ssZ (ISO 8601/RFC 3339).<br /><br />Date en UTC indiquant l’heure de fin jusqu’à laquelle récupérer. |

Exemple d’URL de requête : [https://api.x.com/2/tweets/search/stream?start_time=2022-07-12T15:10:00Z&amp;end_time=2022-07-12T15:20:00Z](https://api.x.com/2/tweets/search/stream?start_time=1985-04-12T23:20:50.52Z\&end_time=1985-04-13T00:20:50.52Z)