---
title: API d’Engagement
---

<div id="overview">
  ## Présentation
</div>

[`Enterprise`](https://developer.x.com/en/products/x-api/enterprise)

*Ceci est une API Enterprise disponible uniquement dans nos niveaux d’accès gérés. Pour utiliser cette API, vous devez d’abord ouvrir un compte auprès de notre équipe commerciale Enterprise. [En savoir plus](/fr/x-api/enterprise-gnip-2.0/enterprise-gnip)*

L’Engagement API permet d’accéder aux métriques d’impressions et d’engagement des Posts. Bien que la plupart des métriques et des endpoints nécessitent une authentification via [OAuth 1.0a User Context](/fr/resources/fundamentals/authentication), vous pouvez accéder aux métriques publiques Favorite, Retweet, Reply et Video Views en utilisant [OAuth 2.0 Bearer Token](/fr/resources/fundamentals/authentication#oauth-2-0) et l’endpoint /totals.

**Remarque :** Vous pouvez constater des différences entre les données affichées sur certains tableaux de bord Web de X et celles renvoyées par l’Engagement API. Ces différences s’expliquent par le fait que les tableaux de bord Web n’affichent généralement que les engagements et/ou impressions survenus dans l’intervalle de temps sélectionné. Par exemple, un tableau de bord Web peut afficher l’engagement sur des Posts au cours d’un mois calendaire, tandis que l’Engagement API peut indiquer des engagements au-delà de la durée de ce mois, mais dans l’intervalle de temps demandé. Dans ces cas, l’Engagement API doit être considérée comme la source de référence.
 

<div id="request-endpoints">
  ### Points de terminaison de requête
</div>

L’API Engagement propose trois points de terminaison :

<div id="current-totals-totals">
  #### Totaux actuels : [/totals]
</div>

* Les requêtes renvoient un total pour les impressions et un total pour les engagements pour les Posts souhaités
* Limité aux métriques suivantes : Impressions, Engagements, Favoris, Réponses, Retweets, Tweets cités et Vues de vidéo
* Permet de récupérer les métriques **Impressions** et **Engagements** pour les Posts créés **au cours des 90 derniers jours** à l&#39;aide d&#39;OAuth 1.0a User Context
* Permet de récupérer les métriques **Favoris, Retweets, Tweets cités, Réponses** et **Vues de vidéo** pour **n&#39;importe quel Post** à l&#39;aide d&#39;un jeton Bearer OAuth 2.0
* Les résultats reflètent le total actuel des impressions et des engagements au moment de la requête
* Idéal pour alimenter un tableau de bord et calculer les taux d&#39;engagement sur une variété de @handles
* Permet de demander des métriques pour jusqu&#39;à 250 Posts par requête
   

<div id="last-28-hours-28hr">
  #### Dernières 28 heures : [/28hr]
</div>

* Les requêtes peuvent renvoyer une métrique totale pour les impressions, une métrique totale pour les engagements, ainsi qu’une ventilation des métriques d’engagement individuelles survenues au cours des dernières 28 heures
* Les données peuvent être regroupées par ID de post, et en séries temporelles de manière agrégée, par jour ou par heure
* Idéal pour suivre les performances du contenu récemment créé
* Prend en charge toutes les métriques disponibles
* Prend en charge la demande de métriques pour jusqu’à 25 posts par requête
   

<div id="historical-historical">
  #### Historique : [/historical]
</div>

* Les requêtes peuvent renvoyer les impressions, les engagements et une ventilation des métriques d’engagement individuelles pour la dernière année, en fonction de l’heure de l’engagement (et non de la création du Post).
* Les requêtes acceptent des paramètres de date de début et de date de fin, offrant la flexibilité de cibler une période spécifique d’une durée maximale de 4 semaines.
* Les données d’engagement des Posts sont limitées aux 365 jours précédents.
* Les données peuvent être regroupées par ID de Post et, en séries chronologiques agrégées, par jour ou par heure.
* Idéal pour évaluer les performances récentes par rapport à une référence historique ou construire une vue historique des performances d’un @handle.
* Prend en charge toutes les métriques disponibles.
* Permet de demander des métriques pour jusqu’à 25 Posts par requête.

<div id="available-metrics">
  ### Indicateurs disponibles
</div>

Le tableau ci-dessous décrit les types d’indicateurs accessibles via l’Engagement API.

Veuillez consulter notre [page Interprétation des indicateurs](/fr/x-api/enterprise-gnip-2.0/fundamentals/engagement-api#interpreting-the-metrics) pour en savoir plus sur les indicateurs ci-dessous.

| Mesure | Disponibilité de l’endpoint | Contexte utilisateur requis | Description |
| :--- | :--- | :--- | :--- |
| impressions | Tous | Oui | Nombre de fois où la Publication a été vue. Cette mesure n’est disponible que pour les Publications publiées au cours des 90 derniers jours. |
| engagements | Tous | Oui | Nombre de fois qu’un utilisateur a interagi avec la Publication. Cette mesure n’est disponible que pour les Publications publiées au cours des 90 derniers jours. |
| favorites | Tous | Oui - /28hrs &amp; /Historical<br /><br />Non - /totals | Nombre de fois où la Publication a été ajoutée aux favoris. |
| retweets | Tous | Oui - /28hrs &amp; /Historical<br /><br />Non - /totals | Nombre de fois où la Publication a été retweetée. |
| quote_tweets | /totals | Non - /totals | Nombre de fois qu’une Publication a été retweetée avec un commentaire (également appelé Citation). |
| replies | Tous | Oui - /28hrs &amp; /Historical<br /><br />Non - /totals | Nombre de fois où la Publication a reçu une réponse. |
| video_views | Tous | Oui - /28hrs &amp; /Historical<br /><br />Non - /totals | Nombre de fois où une vidéo dans la Publication donnée a été visible à 50 % pendant au moins deux secondes.<br /><br />Les vues vidéo ne sont disponibles que pour les Publications âgées de 1800 jours ou moins. Si vous tentez de demander des vues vidéo pour des Publications de plus de 1800 jours, vous recevrez l’objet suivant dans votre réponse, ainsi qu’un objet séparé contenant les autres mesures demandées :<br /><br />&quot;unsupported_for_video_views_tweet_ids&quot;: [&quot;TWEET_ID&quot;]<br /><br />**Veuillez noter :** Vous pouvez constater un écart entre la mesure des vues vidéo affichée sur les plateformes détenues et exploitées par X (application mobile et site web) et le nombre que vous recevez via les endpoints /28hr et /historical.  <br /><br />*   Les vues vidéo affichées dans l’interface utilisateur de X et avec l’endpoint /totals présentent les vues vidéo agrégées sur toutes les Publications dans lesquelles la vidéo donnée a été publiée. Cela signifie que la mesure affichée dans l’UI inclut les vues combinées de toute instance où la vidéo a été retweetée ou republiée dans des Publications distinctes. Cette mesure n’inclut pas les vues vidéo sur les GIF.<br />*   Les vues vidéo fournies par les endpoints /28hr et /historical incluent uniquement les vues générées par la Publication spécifique pour laquelle vous récupérez des mesures. Cette mesure n’inclut pas les vues vidéo sur les GIF. |
| media_views | /28hr /historical | Oui | Nombre total de vues (lecture automatique et clic) de vos médias, comptabilisées sur les vidéos, GIF et images. |
| media_engagements<br /><br />([anciennement Media Clicks](/fr/x-api/enterprise-gnip-2.0/fundamentals/engagement-api#recent-changes-to-the-engagement-api)) | /28hr /historical | Oui | Nombre de fois qu’un média tel qu’une image ou une vidéo dans la Publication a été cliqué. |
| url_clicks | /28hr /historical | Oui | Nombre de fois qu’une URL dans la Publication a été cliquée. |
| hashtag_clicks | /28hr /historical | Oui | Nombre de fois qu’un hashtag dans la Publication a été cliqué. |
| detail_expands | /28hr /historical | Oui | Nombre de fois où la Publication a été cliquée pour afficher plus de détails. |
| permalink_clicks | /28hr /historical | Oui | Nombre de fois où le lien permanent vers la Publication (la page Web individuelle dédiée à cette Publication) a été cliqué. |
| app_install_attempts | /28hr /historical | Oui | Nombre de fois où un événement d’installation d’application s’est produit depuis la Publication. |
| app_opens | /28hr /historical | Oui | Nombre de fois où un événement d’ouverture d’application s’est produit depuis la Publication. |
| email_tweet | /28hr /historical | Oui | Nombre de fois où la Publication a été partagée par e‑mail. |
| user_follows | /28hr /historical | Oui | Nombre de fois où l’Utilisateur (auteur de la Publication) a été suivi depuis cette Publication. || user_profile_clicks | /28hr /historical | Yes | Nombre de fois où le profil de l’utilisateur (auteur du Post) a été cliqué depuis ce Post. |

<div id="engagement-groupings">
  ### Regroupements d’engagement
</div>

Les regroupements permettent d’organiser de façon personnalisée les métriques d’engagement renvoyées. Vous pouvez inclure au maximum 3 regroupements par requête. Vous pouvez choisir de regrouper les métriques selon une ou plusieurs des valeurs suivantes :

*Les trois endpoints prennent en charge :*

* tweet.id
* engagement.type
   

*Les endpoints `/28hr` et `/historical` peuvent fournir des métriques sous forme de séries temporelles et prennent donc en charge :*

* engagement.day
* engagement.hour

Pour en savoir plus sur le regroupement, veuillez consulter la page [Engagement API Grouping](/fr/x-api/enterprise-gnip-2.0/fundamentals/engagement-api#engagement-api-groupings) dans la section Guides.

<div id="guides">
  ## Guides
</div>

<div id="developer-getting-started-guide">
  ### Guide de démarrage pour développeurs
</div>

<div id="introduction">
  #### Introduction
</div>

Cette documentation a pour objectif de présenter aux développeurs les bases de l’intégration à l’Engagement API. Nous commencerons par expliquer les raisons d’intégrer cette API, puis nous aborderons les aspects techniques du « comment ».

<div id="what-does-the-engagement-api-provide">
  ##### **Que fournit l’API Engagement ?**
</div>

* L’API Engagement fournit des données d’impressions et d’engagement pour les Posts détenus par n’importe quel compte X au cours des 90 derniers jours, à condition que ce compte ait autorisé votre App à demander des métriques en son nom via [l’OAuth à 3 voies](/fr/resources/fundamentals/authentication#obtaining-access-tokens-using-3-legged-oauth-flow). Cette solution puissante mais facile à implémenter donne un accès immédiat aux impressions et à des interactions approfondies, telles que les clics sur des URL, les clics sur des #hashtags, et bien plus encore.
* L’API Engagement fournit des métriques agrégées totales pour les favoris, les Retweets, les Quote Tweets, les réponses et les vues vidéo de n’importe quel Post. Cela peut servir à obtenir, de manière efficace, des données d’engagement de base sur un Post ou un ensemble de Posts.
* L’API Engagement apporte une valeur nouvelle aux plateformes d’écoute sociale, de marketing et de publication en permettant aux clients de mesurer le ROI sur X en évaluant efficacement la performance de leur contenu à l’aide de plus de 15 métriques de performance.
* L’API Engagement est une API de type requête/réponse qui permet aux développeurs d’applications d’envoyer des requêtes avec des IDs de Post, les métriques souhaitées et une période temporelle, pour lesquelles l’API renvoie instantanément des données.
   

<div id="why-integrate-example-use-cases">
  ##### **Pourquoi intégrer ? Exemples d’utilisations**
</div>

* Comprendre la portée totale de votre contenu pour savoir combien de personnes le voient. Voir combien de personnes regardent les vidéos, cliquent sur des liens, cliquent sur des mots-dièse ou installent mes applications.
* Générer des métriques d’engagement globales et en séries temporelles.
* Comprendre les métriques d’engagement de base (favoris, Retweets, Tweets cités, réponses) pour n’importe quelle publication publique.
* Utiliser ces métriques pour déterminer quels types de publications fonctionnent afin que je puisse en publier plus souvent et obtenir davantage d’impressions et d’engagements pour mon contenu.
* Automatiser des actions marketing (comme retweeter du contenu depuis un autre compte détenu) chaque fois que l’une de mes publications atteint 100 J’aime, ou un autre seuil.
* Établir des références et comparer mes campagnes entre elles comme outil de tests A/B.
* Analyser quels types de contenus trouvent un écho auprès de mon service client afin de déterminer comment et quand répondre.
* Afficher des analyses pour le contenu publié depuis ma plateforme.
   

L’[Engagement API a été lancée en 2016](https://blog.x.com/official/en_us/a/2016/gnip-s-engagement-api-is-now-generally-available.html) et fut la première API X à fournir ces métriques d’engagement approfondies à grande échelle. L’Engagement API est facile à utiliser et permet aux clients d’automatiser le processus. Voici une étude de cas décrivant un exemple d’intégration :

* [Mesurer le succès d’une campagne avec la Croix-Rouge](https://blog.x.com/developer/en_us/topics/spotlight/2016/measuring-campaign-success-with-the-red-cross.html)[](https://simplymeasured.com/blog/true-twitter-impressions-and-url-clicks-new-from-simply-measured/#sm.0007werel134td8zqf02m2mduumr6)

Maintenant que nous avons exploré les « pourquoi » de l’Engagement API, passons aux détails techniques.

<div id="integrating-the-engagement-api">
  #### Intégrer l’API Engagement
</div>

<div id="introduction-to-api">
  ##### **Introduction à l’API**
</div>

L’API Engagement est une API RESTful simple qui reçoit des requêtes encodées en JSON et renvoie des métriques d’engagement encodées en JSON. Les requêtes se composent de trois parties principales (suivez les liens pour plus de documentation) :

* Tableau d’***ID de Post***.
* Tableau spécifiant les [types de métriques](https://developer.x.com/en/docs/x-api/v1/metrics/get-tweet-engagement/overview#EngagementTypes) d’intérêt. Ces types incluent notamment « impressions », « retweets », « hashtag_clicks » et « user_follows ».
* [Regroupements d’engagement](/fr/x-api/enterprise-gnip-2.0/fundamentals/engagement-api#engagement-api-groupings), une structure JSON indiquant la façon dont vous souhaitez organiser les données d’engagement dans la réponse de l’API.

Dans de nombreux cas, les types d’engagement et les regroupements restent relativement constants d’une requête à l’autre, seuls les ID de Post étant mis à jour.

L’API Engagement expose [trois endpoints](https://developer.x.com/en/docs/x-api/v1/metrics/get-tweet-engagement/overview#RequestEndpoints) :

* **Totals** - Fournit les totaux globaux des engagements pour les Posts. Certaines métriques sont disponibles pour tous les Posts, tandis que d’autres ne le sont que pour les 90 derniers jours.
* **28 hour** - Fournit des métriques d’engagement en séries temporelles sur les 28 dernières heures.
* **Historical** - Fournit des métriques d’engagement en séries temporelles pour jusqu’à quatre semaines consécutives pour les Posts publiés depuis le 1er septembre 2014.

L’endpoint **/totals** permet de demander des métriques pour jusqu’à **250 Posts par requête**. Les endpoints **/28hour** et **/historical** permettent **25 par requête**.

Après avoir abordé l’accès à l’API Engagement, nous verrons comment effectuer une requête d’API, proposerons un aperçu d’OAuth et fournirons des liens vers d’autres ressources techniques.

<div id="getting-api-access">
  ##### **Obtenir l’accès à l’API**
</div>

Si vous lisez ce document, vous avez très probablement déjà obtenu l’accès à l’API Engagement. Sinon, veuillez contacter votre responsable de compte Enterprise ou demander un accès Enterprise [ici](/fr/x-api/enterprise-gnip-2.0/enterprise-gnip).

La première étape consiste à créer une [application X](/fr/resources/fundamentals/developer-apps) à l’aide d’un compte développeur approuvé via le [portail développeur](/fr/resources/fundamentals/developer-portal). Votre responsable de compte aura besoin de l’ID numérique de l’application associé à cette application pour activer l’accès. Si vous devez demander un compte développeur, vous pouvez le faire [ici](/fr/resources/fundamentals/developer-apps).

<div id="making-a-request">
  ##### **Effectuer une requête**
</div>

La bonne nouvelle, c’est qu’effectuer des requêtes vers l’Engagement API est simple. Pour notre requête, nous lui demanderons le total des Retweets, Tweets cités, Favoris et réponses pour les deux Posts [@XDevelopers](https://x.com/XDevelopers) suivants :

> 1/ Aujourd’hui, nous partageons notre vision de l’avenir de la plateforme X API ![https://t.co/XweGngmxlP](https://t.co/XweGngmxlP)
>
> — Twitter Dev (@TwitterDev) [6 avril 2017](https://x.com/TwitterDev/status/850006245121695744)

> Ne manquez pas les Posts à propos de votre Post.
>
> Désormais sur iOS, vous pouvez voir les Retweets avec commentaires au même endroit. [pic.x.com/oanjZfzC6y](https://t.co/oanjZfzC6y)
>
> — X (@X) [12 mai 2020](https://x.com/status/1260294888811347969?ref_src=twsrc%5Etfw)

La première étape consiste à construire la requête API en JSON, composée de ces deux ID de Post placés dans un tableau, d’un tableau des types d’engagement qui nous intéressent, et d’un objet JSON « groupings » nommé personnalisablement qui indique comment nous souhaitons organiser les métriques dans la réponse. Voici à quoi ressemble notre requête :

```json
{
  "tweet_ids": [
    1260294888811347969, 850006245121695744
  ],
  "engagement_types": [
    "retweets", "quote_tweets", "favorites", "replies"
  ],
  "groupings": {
    "engagement-types-by-id": {
      "group_by": [
        "Tweet.id", "engagement.type"
      ]
    }
  }
}
```

Pour récupérer ces métriques totales, nous envoyons cette requête JSON en POST vers l’endpoint https://data-api.x.com/insights/engagement/totals.

Nous incluons les en-têtes suivants pour indiquer que notre requête est encodée en JSON et qu’elle est compressée en Gzip (les corps de requête peuvent devenir volumineux) :

* Content-Type: application/json
* Accept-Encoding: gzip
   

Lors de l’envoi des requêtes, nous nous authentifions à l’aide d’OAuth, que nous aborderons plus en détail dans la section suivante.

L’API renvoie la charge utile suivante :

```json
{
  "grouping name": {
    "1260294888811347969": {
      "favorites": "17111",
      "quote_tweets": "3254",
      "replies": "1828",
      "retweets": "5218"
    },
    "850006245121695744": {
      "favorites": "492",
      "quote_tweets": "66",
      "replies": "42",
      "retweets": "324"
    }
  }
}
```

Notez que la réponse contient les métriques demandées selon la structure définie par « groupings », avec les métriques répertoriées d’abord par ID de Post, puis par type d’engagement au niveau suivant.

C’était assez simple. Si vous débutez avec l’authentification OAuth, consultez la section suivante.

<div id="authenticating-with-oauth">
  #### Authentification avec OAuth
</div>

OAuth est une norme d’authentification très courante dans le secteur technologique. Si vous utilisez déjà OAuth (peut-être avec d’autres API X), vous utilisez probablement une bibliothèque OAuth spécifique à un langage qui masque tous les détails complexes. Si vous découvrez OAuth, consultez notre page [OAuth avec l’API X](/fr/resources/fundamentals/authentication) ou rendez-vous directement sur [https://oauth.net](https://oauth.net/) pour en savoir plus. Nous vous recommandons ensuite de choisir un package OAuth pour le langage d’intégration de votre choix et de commencer par là. Avec ces bibliothèques, l’authentification consiste généralement à configurer vos clés et jetons, créer un objet HTTP, puis effectuer des requêtes avec cet objet.

Par exemple, dans l’écosystème Ruby, le pseudo-code suivant illustre comment créer une application compatible OAuth à l’aide du gem Ruby « oauth » et effectuer une requête POST :

```js
require 'oauth'

# Assemble JSON request (as above).
request = make_json_request()

# Build an app consumer object with my app consumer key and secret.
consumer = OAuth::Consumer.new(keys['consumer_key'], keys['consumer_secret'], {:site => 'https://data-api.x.com'})
# Build a user token with tokens provided by account providing permission. If making app-only
# request (checking Tweets that do not require permission with /totals endpoint), this step can be skipped.
token = {:oauth_token => keys['access_token'], :oauth_token_secret => keys['access_token_secret']}

# Create oauth-enabled app object.
app = OAuth::AccessToken.from_hash(consumer, token)
# Make POST request.
result = app.post("/insights/engagement/totals", request, {"content-type" => "application/json", "Accept-Encoding" => "gzip"})
```

L’API Engagement prend en charge l’authentification « application-only » et « user-context ». Si vous collectez des métriques d’engagement pour des Posts publics non détenus avec l’endpoint /totals, aucune autorisation utilisateur n’est requise et vous pouvez utiliser l’authentification « application-only ». Dans ce cas, vous utiliserez uniquement la clé et le secret de votre application pour vous authentifier.

OAuth permet également à une application d’effectuer une requête API « au nom d’un autre utilisateur », à l’aide de jetons liés à cet utilisateur. Si vous générez des métriques d’engagement pour des Posts détenus, c’est‑à‑dire des Posts publiés par un utilisateur pour lequel vous disposez de jetons utilisateur, vous effectuerez des requêtes en contexte utilisateur, c’est‑à‑dire en vous authentifiant à la fois avec vos clés d’application et des jetons d’accès spécifiques à l’utilisateur. Ces jetons d’accès utilisateur sont généralement fournis via le processus « [Se connecter avec X](/fr/resources/fundamentals/authentication#log-in-with-x) » ou obtenus directement auprès de l’utilisateur (veuillez noter que vous devez utiliser [twurl](https://github.com/xdevplatform/xurl) si vous obtenez les jetons directement auprès de l’utilisateur). Une fois fournis, ces jetons n’expirent pas et peuvent être utilisés avec l’API Engagement pour effectuer des requêtes en son nom, tant que l’utilisateur ne réinitialise pas ses jetons et ne change pas son mot de passe ; dans ce cas, il devra vous fournir de nouveaux jetons.

Vous pouvez consulter quelles métriques nécessitent quel type d’authentification via [ce tableau](/fr/x-api/enterprise-gnip-2.0/fundamentals/engagement-api#engagement-api-groupings).
 

<div id="selecting-an-engagement-api-endpoint">
  ### Sélection d’un endpoint de l’Engagement API
</div>

L’Engagement API propose trois endpoints distincts :

* **[Totals](/fr/x-api/enterprise-gnip-2.0/fundamentals/engagement-api#post-insights-engagement)** - fournit des totaux globaux de certaines métriques pour des Posts « owned » ou « unowned ». Certaines métriques sont disponibles pour tous les Posts, tandis que d’autres ne le sont que pour les Posts publiés au cours des 90 derniers jours. Prend en charge 250 Posts par requête.
* **[28 hour](/fr/x-api/enterprise-gnip-2.0/fundamentals/engagement-api#post-insights-engagement)** - fournit des métriques d’engagement en séries temporelles pour les Posts « owned » des 28 dernières heures. Prend en charge 25 Posts par requête.
* **[Historical](/fr/x-api/enterprise-gnip-2.0/fundamentals/engagement-api#post-insights-engagement-historical)** - fournit des métriques d’engagement en séries temporelles pour jusqu’à quatre semaines consécutives concernant les Posts « owned » publiés depuis le 1er septembre 2014. Prend en charge 25 Posts par requête.
   

Chaque endpoint a ses propres caractéristiques. Que vous prévoyiez d’utiliser les trois ou que vous cherchiez à déterminer lequel correspond le mieux à votre cas d’usage, il est important d’en comprendre les différences.

Ci‑dessous, nous présentons quelques concepts clés, explorons plus en détail les trois endpoints, puis proposons des exemples de cas d’usage généralement associés à un endpoint spécifique. Nous espérons que ces informations vous aideront à intégrer plus efficacement les trois endpoints ou à choisir celui qui correspond le mieux à votre objectif.
 

<div id="key-concepts">
  #### Concepts clés
</div>

Plusieurs notions clés permettent d’illustrer les différentes fonctionnalités et les données fournies par les trois points de terminaison de l’API Engagement.
 

<div id="impressions-and-engagement-metrics">
  ##### Impressions et mesures d’engagement
</div>

Les impressions correspondent au nombre de fois qu’une publication donnée a été affichée sur la plateforme X dans un contexte organique. Les impressions générées par des publications vues dans un contexte sponsorisé ou payant ne sont pas incluses. Avant l’Engagement API, les impressions de publication ne représentaient qu’une estimation des vues potentielles. Elles étaient calculées à partir du nombre d’abonnés du compte de l’auteur et de ceux de tout compte retweetant le contenu, sans tenir compte de la situation fréquente où un utilisateur ne voit pas réellement la publication.

Les mesures d’impression générées par l’Engagement API reflètent le nombre réel de fois qu’une publication a été rendue à l’affichage. Si un abonné de votre compte passe à côté de votre publication, cela ne compte pas comme une impression.

L’Engagement API fournit des mesures sur 14 types de métriques d’engagement uniques, chacun représentant une action distincte qu’un utilisateur peut effectuer lorsqu’une publication lui est présentée. Ces actions incluent le retweet, l’aime, la réponse, le clic sur des éléments comme les #hashtags, les liens et les médias, le suivi de l’auteur et la consultation du profil de l’auteur. Toutes ces actions individuelles sont agrégées dans une seule métrique, Engagements. Pour la liste complète, voir les [types de métriques disponibles](/fr/x-api/enterprise-gnip-2.0/fundamentals/engagement-api#available-metrics).

<div id="owned-and-unowned-x-content">
  ##### Contenu X détenu et non détenu
</div>

L’API Engagement distingue clairement les Posts détenus et non détenus. Les Posts détenus sont des Posts publiés depuis votre compte ou des Posts pour lesquels vous avez obtenu l’autorisation de demander des données d’engagement. Comme avec les autres API X, vous obtenez cette autorisation lorsque d’autres utilisateurs/comptes X partagent des jetons d’accès qui vous permettent d’effectuer des requêtes API en leur nom. Une façon courante d’obtenir ces jetons est le [processus « Sign in with X »](/fr/resources/fundamentals/authentication#log-in-with-x).

L’endpoint /totals fournit des données d’engagement pour les Posts détenus et non détenus. Pour les Posts non détenus, vous pouvez demander les métriques d’engagement affichées publiquement dans un Post : Favorite, Retweet et Reply. Pour ces métriques, ce que l’API Engagement apporte, c’est la capacité de les récupérer à grande échelle de manière automatisée. Pour les Posts détenus, l’endpoint /totals fournit également les métriques Impression et Engagement (total).

Les endpoints /28hr et /historical fournissent des métriques uniquement pour les Posts détenus, ce qui signifie que vous devez transmettre un contexte utilisateur lors de l’envoi de la requête à ces endpoints.

<div id="total-and-time-series-engagement-data">
  ##### Données d’engagement totales et séries chronologiques
</div>

L’endpoint /totals fournit, comme son nom l’indique, uniquement des totaux globaux pour ses types d’engagement. Ses chiffres représentent les totaux à jour depuis la publication du Post. Si un Post vient d’être publié et que vous interrogez ses métriques à plusieurs reprises, ces totaux évolueront généralement à chaque requête.

Les endpoints /28hr et /historical peuvent fournir à la fois des totaux globaux et des séries chronologiques. Lors d’une requête de séries chronologiques, les métriques d’engagement peuvent être agrégées par jour ou par heure.   

Consultez notre documentation sur les [groupements d’engagement](/fr/x-api/enterprise-gnip-2.0/fundamentals/engagement-api#engagement-api-groupings) pour savoir comment demander des séries chronologiques avec les endpoints /28hr et /historical.

<div id="endpoints-and-example-use-cases">
  #### Endpoints et exemples de cas d’usage
</div>

Compte tenu des caractéristiques et des différences évoquées ci‑dessus, chaque endpoint correspond en général à différents types de cas d’usage. Pour vous aider à déterminer quel endpoint répond le mieux à votre besoin, vous trouverez ci‑dessous quelques exemples de déclarations d’utilisateurs et l’endpoint qui y répond le mieux.

<div id="totals">
  ##### **/totals**
</div>

* J’ai seulement besoin d’accéder à certains types de métriques (impressions, engagements, favoris, retweets, tweets avec citation, réponses et vues vidéo).
* J’ai besoin d’accéder aux données d’engagement de base pour n’importe quelle publication, pas seulement les publications dont je suis le propriétaire.
* Je veux comparer les performances à celles d’un concurrent.
* Je veux suivre des statistiques d’engagement de base pour un hashtag ou une campagne qui inclut des publications qui ne m’appartiennent pas.
* Je n’ai pas besoin de données ventilées par jour ou par heure, j’ai seulement besoin du total actuel lorsque j’effectue une requête.
* J’ai besoin d’une seule métrique à afficher dans un rapport ou un tableau de bord et je ne veux stocker aucune donnée.
* Je veux afficher des données au chargement de la page et j’ai seulement besoin d’effectuer une requête et d’obtenir une réponse.
* J’ai besoin d’accéder aux données pour des centaines de milliers, voire des millions, de publications par jour.
   

<div id="28hr">
  ##### **/28hr**
</div>

* J’ai besoin d’accéder aux 17 types de métriques.
* Je veux afficher les données pour des Posts très récents publiés au cours des 28 dernières heures.
* J’ai une tâche qui s’exécute une fois par jour pour récupérer les données qui m’intéressent et je n’ai besoin d’obtenir des données que pour les dernières 24 heures.
* J’ai besoin que les métriques soient ventilées par jour ou par heure.
* Je veux afficher, dans un tableau de bord, des séries chronologiques de l’activité par heure.
* J’ai besoin d’un niveau d’accès élevé pour des centaines de milliers de Posts par jour.
* Je dispose de capacités de stockage et je peux actualiser les données une fois par jour et conserver un cumul.
   

<div id="historical">
  ##### **/historical**
</div>

* J’ai besoin d’accéder aux 17 types de métriques.
* J’ai besoin d’obtenir des données historiques pour les publications créées remontant jusqu’à septembre 2014.
* Je veux afficher une analyse historique détaillée comparant des campagnes.
* J’ai besoin que les métriques soient ventilées par jour ou par heure.
* Je n’ai pas besoin d’un niveau d’accès élevé à l’Engagement API et j’ai seulement besoin d’obtenir des données pour quelques centaines ou quelques milliers de publications par jour.

<div id="engagement-api-key-characteristics">
  ### Principales caractéristiques de l’API Engagement
</div>

* **API RESTful** fournissant des données JSON et prenant en charge les requêtes POST avec des corps JSON.
* **Types de requêtes :** Les applications clientes peuvent effectuer les types de requêtes suivants :
  * **Engagements totaux** -- requête HTTP POST vers le point de terminaison /totals
  * **Engagements sur les dernières 28 heures** -- requête HTTP POST vers le point de terminaison /28hr
  * **Engagements historiques** -- requête HTTP POST vers le point de terminaison /historical
* **Authentification OAuth :**
  * [OAuth 1.0 Contexte utilisateur](/fr/resources/fundamentals/authentication) : Toutes les métriques sont disponibles pour les Posts appartenant à un utilisateur ayant autorisé votre application via l’[OAuth à 3 volets](https://developer.x.com/resources/fundamentals/authentication/obtaining-user-access-tokens). Vous devez utiliser les jetons d’accès de cet utilisateur lors de votre requête.[](/fr/resources/fundamentals/authentication)
  * [Jeton porteur OAuth 2.0](/fr/resources/fundamentals/authentication#oauth-2-0) : Certaines métriques (Retweets, Quote Tweets, Replies, Favorites et Video Views) sont disponibles pour tout Post public.
* **Métadonnées et structure de la requête** : Les données de la requête sont un objet JSON composé d’un tableau d’ID de Post, d’un tableau de types d’engagement et d’une structure de regroupement d’engagement.
* **Posts par requête :**
  * point de terminaison /totals : 250 ID de Post
  * point de terminaison /28hr : 25 ID de Post
  * point de terminaison /historical : 25 ID de Post
* **Disponibilité des métriques d’engagement :**
  * **/totals** -- Totaux des métriques depuis la publication du Post. Les Impressions et Engagements sont disponibles pour les Posts publiés au cours des 90 derniers jours, tandis que Retweets, Quote Tweets, Replies, Favorites et Video Views sont disponibles pour tous les Posts.
  * **/28hr** -- Les 28 dernières heures à partir du moment de la requête.
  * **/historical** -- Toute période de 28 jours à partir du 1er septembre 2014.
* **Types de métriques** : Chaque requête inclut un tableau de [Types de métriques](http://support.gnip.com/apis/engagement_api/overview.html#EngagementTypes). Leur disponibilité dépend du point de terminaison et, pour /totals, du fait que les Posts soient autorisés par l’utilisateur.
  * point de terminaison /totals :
    * Tous les Posts : Favorites, Retweets, Quote Tweets, Replies et Video Views
    * Nécessite le Contexte utilisateur OAuth 1.0a : Impressions, Engagements, Favorites, Replies et Retweets
  * points de terminaison /28hr et /historical (Nécessite le Contexte utilisateur OAuth 1.0a avec le jeton d’accès du propriétaire du Post) : Impressions, Engagements, Favorites, Replies, Retweets, URL Clicks, Hashtag Clicks, Detail Click, Permalink Clicks, Media Clicks, App Install Attempts, App Opens, Post Emails, Video Views et Media Views
* **Regroupements d’engagement :** Chaque requête inclut un tableau de [Regroupements d’engagement](/fr/x-api/enterprise-gnip-2.0/fundamentals/engagement-api#engagement-api-groupings). Grâce à ces regroupements, vous pouvez personnaliser l’organisation des métriques renvoyées. Jusqu’à trois regroupements peuvent être inclus par requête. Les métriques peuvent être organisées selon les valeurs suivantes :
  * Tous les points de terminaison : Post ID, Engagement Type
  * points de terminaison /28hr et /historical : Ces points de terminaison fournissent des séries temporelles si ces regroupements supplémentaires sont spécifiés : Engagement Day, Engagement Hour
* **Attentes d’intégration :** Votre équipe sera responsable de ce qui suit.
  * Créer et maintenir une application cliente capable d’envoyer des requêtes HTTP à l’API Engagement et de renvoyer des métriques d’engagement pour les Post ID inclus dans la requête.
* **Limitations**
* Les vues vidéo ne sont disponibles que pour les Posts âgés de 1 800 jours ou moins.

<div id="authenticating-with-the-engagement-api">
  ### Authentification avec l’Engagement API
</div>

> **Remarque** : 
>
> X doit activer l’accès à l’Engagement API pour votre application développeur avant que vous ne puissiez commencer à utiliser l’API. À cette fin, veillez à communiquer l’ID de l’application que vous comptez utiliser pour l’authentification à votre responsable de compte ou à l’équipe d’assistance technique.

Deux méthodes d’authentification sont disponibles avec l’Engagement API : [OAuth 1.0a](/fr/resources/fundamentals/authentication#oauth-1-0a-2) et [OAuth 2.0 Bearer Token](/fr/resources/fundamentals/authentication#bearer-token-also-known-as-app-only). 

**OAuth 2.0 Bearer Token** (également appelé « application-only ») permet d’accéder aux métriques d’engagement publiques. Cette méthode d’authentification peut être utilisée pour obtenir les totaux des Favoris (Likes), Retweets, Tweets cités, Réponses et vues vidéo pour tout Post public lors des requêtes vers l’[/endpoint totals](/fr/x-api/enterprise-gnip-2.0/fundamentals/engagement-api#post-insights-engagement-totals). 

**OAuth 1.0a** (également appelé « user context ») permet d’effectuer des requêtes au nom d’un utilisateur et d’accéder aux métriques d’engagement privées propres à cet utilisateur. 

Cette méthode d’authentification est requise pour :

* Toutes les requêtes envoyées aux [/endpoint 28hr](/fr/x-api/enterprise-gnip-2.0/fundamentals/engagement-api#post-insights-engagement-28hr) et [/endpoint historical](/fr/x-api/enterprise-gnip-2.0/fundamentals/engagement-api#post-insights-engagement-historical)
* L’accès à l’une des métriques privées suivantes : Impressions, Engagements, Vues de médias, Engagements avec médias, Clics sur URL, Clics sur hashtag, Développements de détail, Clics sur permalien, Tentatives d’installation d’app, Ouvertures d’app, Envoi par e-mail, Abonnements utilisateur et Clics sur profil utilisateur

Lorsque vous envoyez une requête avec OAuth 1.0a, vous devez inclure les jetons d’accès (Access Token et Secret) de l’utilisateur qui possède le Post ou la ressource protégée concernée. Si vous ne fournissez pas les bons jetons d’accès utilisateur lors d’une demande de données utilisateur protégées, l’Engagement API renverra une erreur `403 Forbidden`.

L’Engagement API ne vous permettra pas de récupérer des données d’engagement pour les [Posts protégés](https://help.x.com/en/safety-and-security/public-and-protected-tweets), même si vous vous authentifiez au nom du propriétaire de ces Posts. Toute tentative en ce sens renverra une erreur `400 Bad Request`, avec le message `"Tweet ID(s) are unavailable"`.

Si vous envoyez une requête au nom de votre propre compte X (autrement dit, le compte propriétaire de l’application développeur), vous pouvez générer les jetons d’accès requis directement depuis le [developer portal](https://developer.x.com/en/portal/projects-and-apps), sous l’onglet « Keys and tokens » de l’application développeur.

Si vous faites une requête au nom d’un autre utilisateur, vous devrez utiliser le flux OAuth à 3 étapes pour obtenir les jetons d’accès requis. La documentation suivante fournit plus d’informations sur la marche à suivre : [OAuth 1.0a: how to obtain a user’s access tokens](/fr/resources/fundamentals/authentication#oauth-1-0a-2).

Pour des exemples supplémentaires, notamment sur l’authentification avec OAuth 1.0a, consultez le [code Python d’exemples XDevelopers pour l’Engagement API](https://github.com/xdevplatform/enterprise-scripts-python/tree/master/Engagement-API).

<div id="recent-changes-to-the-engagement-api">
  ### Modifications récentes de l’Engagement API
</div>

L’Engagement API fournit des métriques d’impressions et d’engagement précieuses qui vous permettent de suivre les performances de votre activité sur X. Dans notre effort continu pour favoriser des décisions marketing fondées sur nos données, nous sommes heureux de partager des modifications récentes de l’Engagement API qui renforcent l’harmonisation des métriques sur l’ensemble de X.  

Nous avons récemment déployé des changements pour moderniser l’Engagement API afin d’utiliser la même méthodologie d’agrégation de métriques que celle du tableau de bord Analytics de X (analytics.x.com). Nous avons adopté une approche réfléchie pour minimiser les changements incompatibles dans l’API lors du déploiement de ces nouvelles métriques et avons diffusé le premier lot de modifications le 9 octobre 2017. Ces changements améliorent la cohérence entre tous les points où vous ou vos clients pouvez suivre vos performances sur X. Veuillez consulter ci-dessous la description détaillée des changements :

|     |     |
| :--- | :--- |
| **Metric** | **Change** |
| engagements | Nous avons mis à jour les métriques agrégées dans les engagements globaux pour les aligner sur le tableau de bord Analytics des Posts. Les engagements mesurent « le nombre de fois où des personnes ont interagi avec ce Post ».<br /><br />Pour les Posts incluant des médias, comme une vidéo ou un GIF, la métrique engagements n’inclura plus les vues de médias. Les vues de médias sont désormais accessibles via une nouvelle métrique, *media_views*. |
| media_clicks* | Cette métrique a été remplacée par une nouvelle métrique appelée « *media_engagements* ». |
| video_views | Depuis le 6 juillet 2018, cette métrique est disponible pour les Posts « non détenus » via l’endpoint [/totals](/fr/x-api/enterprise-gnip-2.0/fundamentals/engagement-api#post-insights-engagement). Cela signifie que vous pouvez accéder aux vues vidéo pour **tous** les Posts en utilisant l’authentification « app-only ». <br /><br />Vous ne pouvez demander que des vues vidéo âgées de moins de 1800 jours. Si vous tentez de demander des vues vidéo pour un Post plus ancien que 1800 jours, vous recevrez ce qui suit :<br /><br />&quot;unsupported_for_video_views_tweet_ids&quot;: [&quot;TWEET_ID&quot;]<br /><br />**Veuillez noter** que cela diffère de media_views, car video_views repose sur le standard MRC selon lequel 50 % de la vidéo doivent être visibles pendant au moins deux secondes.  <br /><br />**De plus,** notez qu’un écart peut exister entre la métrique de vues vidéo affichée sur les plateformes détenues et exploitées par X (application mobile et site web) et le nombre que vous recevez via les endpoints /28hr et /historical.<br /><br />* Les vues vidéo affichées dans l’interface utilisateur de X et fournies via l’endpoint /totals présentent l’agrégat des vues de la vidéo sur tous les Posts dans lesquels elle a été publiée. Cela signifie que la métrique affichée dans l’UI inclut les vues combinées de toute instance où la vidéo a été retweetée ou repostée dans des Posts distincts.<br />* Les vues vidéo fournies par les endpoints /28hr et /historical n’incluent que les vues générées par le Post spécifique pour lequel vous extrayez des métriques. |
| media_views | Inclut toutes les vues (lecture automatique et après clic) de vos médias, comptabilisées sur les vidéos, vines, GIFs et images.<br /><br />**Veuillez noter** que les Posts avec images n’affichent pas la métrique media_views dans le tableau de bord Analytics, mais elle est renvoyée par l’Engagement API. |
| media_engagements* | Inclut le nombre de clics sur vos médias pour les vidéos, vines, GIFs et images. Cette métrique remplace *media_clicks*. |
| quote_tweets | Depuis le 7 juillet 2020, cette métrique est disponible pour les Posts « non détenus » via l’endpoint /totals. Cela signifie que vous pouvez accéder au nombre de Quotes pour tous les Posts en utilisant l’authentification « app-only ». |

<div id="interpreting-the-metrics">
  ### Interpreting the metrics
</div>

**Remarque :** Vous pouvez constater des écarts entre les données affichées sur certains tableaux de bord web de X et celles renvoyées par l’Engagement API. Ces écarts s’expliquent par le fait que les tableaux de bord web n’affichent généralement que les engagements et/ou les impressions survenus dans l’intervalle de temps sélectionné. Par exemple, un tableau de bord web peut afficher les engagements sur des Posts sur la durée d’un mois calendaire, tandis que l’Engagement API peut inclure des engagements au-delà de ce mois, mais toujours dans la plage temporelle demandée. Dans ces cas, l’Engagement API doit être considérée comme la source de référence.
 

<div id="impressions-and-engagement-data">
  #### Données d’impressions et d’engagement
</div>

L’API Engagement fournit des données d’impressions et d’engagement **organiques**.

Les impressions correspondent au nombre de fois qu’une publication a été vue sur la plateforme X dans un contexte organique. Les impressions générées lorsque des publications sont vues dans un contexte Promoted ou Paid ne sont **pas** incluses.

Les engagements correspondent au nombre de fois qu’une publication a suscité une interaction de la part d’un·e visiteur·euse, à la fois dans un contexte **organique** et **promoted**. Les engagements incluent, sans s’y limiter, les retweets, favoris, réponses, clics sur des URL, clics sur des hashtags, clics sur des mentions et vues de médias. Pour la liste complète des actions d’engagement incluses, veuillez consulter la section Engagement Data.

Pour calculer un taux d’engagement de base, utilisez le nombre total d’engagements divisé par le nombre total d’impressions pour une publication donnée sur la période analysée.

Les données d’impressions et d’engagement ne peuvent être récupérées que pour des publications provenant de @handles détenus, ou de @handles ayant autorisé votre application à consulter les détails de leurs publications. En interne, l’API Engagement suivra le nombre de @handles uniques qui ont été demandés par rapport à la limite contractuelle de @handles. Il est recommandé de suivre également l’utilisation des requêtes @handle côté client tout au long du mois.  

<div id="video-metrics">
  #### Statistiques vidéo
</div>

Il existe plusieurs métriques différentes qui représentent les impressions des médias sur X. La première est notre métrique de vues vidéo, qui s’appuie sur le standard MRC de 50 % de la surface vidéo visible pendant au moins deux secondes. La seconde est Media Views, qui inclut toutes les vues (lecture automatique et clic) de vos médias, comptabilisées pour les vidéos, Vines, GIF et images.

La métrique de vues vidéo est disponible pour les Posts détenus via les endpoints /28hour et /historical, ainsi que pour tous les Posts non détenus via l’endpoint /totals.

Bien que la métrique de vues vidéo dans l’interface utilisateur de X utilise le même standard MRC, veuillez noter qu’un écart peut apparaître entre la métrique de vues vidéo affichée sur les plateformes détenues et exploitées par X (application mobile et site web) et le nombre que vous recevez via les différents endpoints de l’Engagement API.

* Les vues vidéo fournies par l’endpoint /totals et l’interface utilisateur X affichent le cumul des vues vidéo sur tous les Posts dans lesquels la vidéo donnée a été publiée. Autrement dit, la métrique fournie via /totals et affichée dans l’UI X inclut les vues combinées de toute instance où la vidéo a été retweetée ou repostée dans des Posts distincts.
* Les vues vidéo fournies par les endpoints /28hour et /historical de l’Engagement API incluent uniquement les vues générées par le Post spécifique pour lequel vous extrayez des métriques.

Veuillez noter que nous ne fournissons pas de vues vidéo pour les Posts âgés de plus de 1 800 jours. À la place, nous renvoyons un objet qui répertorie les Posts de plus de 1 800 jours. Vous recevrez toujours toutes les autres métriques pour les Posts demandés dans un objet séparé. Voici un exemple de réponse :

```json
{
  "unsupported_for_video_views_tweet_ids": [
    "479311209565413376",
    "477139122520219648"
  ],
  "grouping name": {
    "479311209565413376": {
      "favorites": "69",
      "impressions": "1692",
      "retweets": "142",
      "video_views": "0"
    },
    "477139122520219648": {
      "favorites": "10",
      "impressions": "1023",
      "retweets": "6",
      "video_views": "0"
    },
    "1397568983931392004": {
      "favorites": "268",
      "impressions": "26803",
      "retweets": "56",
      "video_views": "17902"
    }
  }
}
```

La métrique Media Views n’est disponible que pour les Posts détenus via les endpoints /28hour et /historical.

<div id="engagement-api-groupings">
  ### Regroupements de l’API Engagement
</div>

Les regroupements permettent d’organiser de manière personnalisée les métriques d’engagement renvoyées. Vous pouvez inclure un maximum de 3 regroupements par requête. Vous pouvez choisir de regrouper les métriques selon une ou plusieurs des valeurs suivantes :

*Les trois endpoints prennent en charge :*

* tweet.id
* engagement.type
   

*Les endpoints `/28hr` et `/historical` peuvent fournir des métrriques sous forme de séries temporelles et prennent donc en charge :*

* engagement.day
* engagement.hour

Les regroupements sont appliqués séquentiellement, ce qui vous permet de modifier le format de résultat souhaité en changeant l’ordre de vos valeurs `group_by`. Les regroupements qui contiennent quatre valeurs `group_by` ne seront pris en charge que dans l’un des deux formats suivants :
 

```bash
"group_by": [
    "tweet.id",
    "engagement.type",
    "engagement.day",
    "engagement.hour"
  ]
```

OU

```bash
"group_by": [
    "engagement.type",
    "tweet.id",
    "engagement.day",
    "engagement.hour"
]
```

Par exemple, si vous souhaitez générer des totaux globaux par type de métrique, incluez la spécification de « groupings » suivante dans votre requête (et consultez la page [API Reference](/fr/x-api/enterprise-gnip-2.0/fundamentals/engagement-api#post-insights-engagement) pour plus d’informations sur l’assemblage des requêtes) :
 

```json
{
  "engagement_types": [
    "favorites",
    "replies",
    "retweets"
  ],
  "groupings": {
    "Grand Totals": {
      "group_by": [
        "engagement.type"
      ]
    }
  }
}
```

Avec ce regroupement, la réponse JSON de l’API Engagement inclura un attribut de niveau racine &quot;Grand Totals&quot; qui contient les totaux globaux par type de métrique :

```json
{
  "Grand Totals": {
    "favorites": "12",
    "replies": "2",
    "retweets": "2"
  }
}
```

Pour générer une série chronologique de 4 heures de métriques pour une seule publication, regroupée par ID de publication, la spécification de regroupement suivante ferait partie de la requête :

```json
{
  "start": "2016-02-10T17:00:00Z",
  "end": "2016-02-10T21:00:00Z",
  "tweet_ids": [
    "697506383516729344"
  ],
  "engagement_types": [
    "impressions",
    "engagements"
  ],
  "groupings": {
    "Tweets_MetricType_TimeSeries": {
      "group_by": [
        "tweet.id",
        "engagement.type",
        "engagement.hour"
      ]
    }
  }
}
```

Avec ce regroupement, la réponse JSON de l’API Engagement inclura un attribut de niveau racine &quot;Tweets_MetricType_TimeSeries&quot; qui contient les métriques ventilées par ID de publication, puis par type de métrique, ainsi que la série chronologique horaire correspondante :

```json
{
  "Tweets_MetricType_TimeSeries": {
    "697506383516729344": {
      "impressions": {
        "2016-02-10": {
          "17": "551",
          "18": "412",
          "19": "371",
          "20": "280"
        }
      },
      "engagements": {
        "2016-02-10": {
          "17": "8",
          "18": "6",
          "19": "3",
          "20": "0"
        }
      }
    }
  }
}
```

<div id="frequently-asked-questions">
  ## Foire aux questions
</div>

`Enterprise`

<div id="engagement-api">
  ### API d’engagement
</div>

<AccordionGroup>
  <Accordion title="Comment puis-je accéder à l’API d’engagement ?">
    L’accès à l’API d’engagement est proposé via un abonnement Entreprise. Veuillez remplir [ce formulaire](/fr/x-api/enterprise-gnip-2.0/enterprise-gnip) pour contacter notre équipe commerciale.
  </Accordion>

  <Accordion title="Comment mon utilisation est-elle suivie par « @handle » ?">
    Si votre contrat inclut une limite du nombre de handles uniques pouvant être utilisés avec l’API d’engagement, le système interne de X suivra le nombre d’utilisateurs authentifiés propriétaires de Posts faisant l’objet de requêtes via l’API d’engagement. Les clients doivent également suivre ce nombre unique côté client. Actuellement, il n’existe ni API ni interface pour consulter l’utilisation des @handles pour l’API d’engagement. Le système ne bloque pas les dépassements s’il y a plus de @handles demandés que prévu au contrat. À la fin du mois de facturation, le nombre de @handles uniques interrogés est comparé au montant contractuel et un dépassement est facturé conformément aux conditions du contrat.
  </Accordion>

  <Accordion title="Puis-je vérifier mon utilisation des @handles pour l’API d’engagement ?">
    Actuellement, il n’existe ni API ni interface pour consulter l’utilisation des @handles pour l’API d’engagement. Le système ne bloque pas les dépassements s’il y a plus de @handles demandés que prévu au contrat. À la fin du mois de facturation, le nombre de @handles uniques interrogés est comparé au montant contractuel et un dépassement est facturé conformément aux conditions du contrat.

    **Le champ de métadonnées `engagements` renvoyé dans la charge utile n’est pas égal à la somme de tous les totaux des différentes métriques d’engagement. Pourquoi ?**

    C’est normal. Le champ de métadonnées `engagements` peut ne pas toujours correspondre à la somme de toutes les métriques d’engagement individuelles renvoyées par l’API. En effet, ce champ peut inclure des engagements supplémentaires qui n’ont pas de métriques spécifiques détaillées dans la charge utile. Autrement dit, additionner tous les totaux des différentes métriques d’engagement peut ne pas donner la valeur que vous voyez dans le champ `engagements` renvoyé dans la charge utile.

    Vous pouvez considérer le champ de métadonnées `engagements` comme tout clic ou interaction effectués sur le Post.
     

    **Le champ `url_clicks` dans la réponse renvoie un nombre alors que le Post ne contient pas d’URL. Comment est-ce possible ?**

    Cela peut s’expliquer par le fait qu’un Post contenant, par exemple, un hashtag (qui crée un lien vers une autre page) sera comptabilisé comme un clic d’URL s’il est cliqué par un utilisateur.
     
  </Accordion>

  <Accordion title="Pourquoi ne puis-je pas recevoir de données d’engagement pour un Post spécifique ?">
    Il existe plusieurs raisons pour lesquelles vous pourriez ne pas être en mesure de récupérer des données d’engagement pour un Post spécifique, notamment :

    * L’ID du Post ou les IDs de Post demandés ne sont pas disponibles en fonction du jeton d’authentification que vous utilisez pour récupérer des données au nom d’un tiers.
    * L’ID du Post ou les IDs de Post demandés pour l’endpoint /totals ont plus de 90 jours et ne sont donc pas disponibles pour renvoyer les impressions ou les métriques d’engagement.
    * L’ID du Post ou les IDs de Post demandés ne sont plus disponibles, ce qui indique généralement qu’ils ont été supprimés ou ne sont plus publics pour une autre raison.

    Veuillez consulter les différents [messages d’erreur](/fr/x-api/enterprise-gnip-2.0/fundamentals/engagement-api#error-messages) que vous êtes susceptible de recevoir dans ces cas.
  </Accordion>

  <Accordion title="Comment puis-je gérer la limitation de débit avec l’API d’engagement ?">
    Vous pouvez utiliser les informations `x-per-minute-limit` et `x-per-minute-remaining` renvoyées dans l’en-tête de réponse lorsque vous effectuez une requête à l’API d’engagement pour surveiller votre consommation.

    `x-per-minute-limit` indique votre quota et `x-per-minute-remaining` indique le nombre d’appels restants.
  </Accordion>
</AccordionGroup>

<div id="error-troubleshooting-guide">
  ### Guide de dépannage des erreurs
</div>

<AccordionGroup>
  <Accordion title="J’ai des problèmes d’authentification">
    Veuillez consulter nos [consignes d’authentification](/fr/x-api/enterprise-gnip-2.0/fundamentals/engagement-api#authentication) pour l’API Engagement.
  </Accordion>

  <Accordion title="J’ai fourni la bonne consumer key et le bon secret, ainsi que l’access token et l’access token secret, mais l’erreur suivante est renvoyée. Que puis-je faire ?">
    ```bash
    [
        Your account could not be authenticated. Reason: Unknown Authorization Type;
    ]
    ```

    Assurez-vous de ne pas utiliser d’access tokens ni de secrets lorsque vous tentez de vous authentifier avec l’endpoint /totals. En effet, si vous incluez ces jetons et tentez d’extraire du contenu d’un Post non associé à ces jetons, vous recevrez probablement une erreur de type :

    ```bash
    [
        Forbidden to access tweets: 1054424731825229824;
    ]
    ```
  </Accordion>
</AccordionGroup>

<div id="still-cant-find-what-youre-looking-for">
  ### Vous ne trouvez toujours pas ce que vous cherchez ?
</div>

<AccordionGroup>
  <Accordion title="J'ai une question qui n'a pas encore de réponse">
    Veuillez contacter l’assistance technique ; nous vous répondrons rapidement.
  </Accordion>
</AccordionGroup>

<div id="api-reference">
  ## Référence de l’API
</div>

<div id="post-insightsengagement">
  ### **POST insights/engagement**
</div>

<div id="methods">
  #### **Méthodes**
</div>

| Méthode | Description |
| :--- | :--- |
| [POST /insights/engagement/totals](#Totals) | Récupérer le total des impressions et des engagements pour un ensemble de Tweets. |
| [POST /insights/engagement/historical](#Historical) | Récupérer les impressions et les engagements pour un ensemble de Tweets sur une période pouvant aller jusqu’à 4 semaines, remontant jusqu’au 1er septembre 2014. |
| [POST /insights/engagement/28hr](#api-28hr) | Récupérer les impressions et les engagements pour un ensemble de Tweets au cours des 28 dernières heures. |

<div id="authentication">
  #### **Authentification**
</div>

L’Engagement API requiert l’utilisation de HTTPS et prend en charge le User Context ainsi que l’Application-Only OAuth. La plupart des requêtes vers l’Engagement API nécessitent le 3-Legged OAuth (une variante du User Context), ce qui signifie que vous utilisez la consumer key et la consumer secret de l’application enregistrée et approuvée pour l’accès à l’Engagement API par votre account manager Twitter, ainsi que l’access token et l’access token secret des propriétaires des Tweets pour appeler l’endpoint. Les requêtes suivantes exigent ce type d’OAuth :

* Toute requête vers /totals pour obtenir les métriques Impressions et Engagements, limitées aux Tweets détenus
* Toute requête vers /28hr
* Toute requête vers /historical

Certaines requêtes vers l’Engagement API peuvent être effectuées avec l’Application-Only OAuth, ce qui signifie que vous devez simplement fournir votre consumer key et votre consumer secret, ou un bearer token. La requête suivante peut être effectuée avec ce type d’OAuth :

* Toute requête vers /totals pour obtenir les métriques Favorites, Replies, Retweets ou Video Views, qui peuvent être récupérées pour n’importe quel Tweet

Pour toute requête, vous devrez configurer une application Twitter et la clé API correspondante à l’aide de la console de gestion des applications disponible sur [developer.x.com](https://developer.x.com/en/portal/dashboard).

Veuillez noter — vous pouvez afficher et modifier vos [applications Twitter](/fr/resources/fundamentals/developer-apps) existantes via le [tableau de bord des applications Twitter](https://developer.x.com/en/apps) si vous êtes connecté à votre compte Twitter sur developer.x.com.

Une fois votre application configurée, l’ID de l’application devra être approuvé par votre account representative pour que votre application puisse effectuer des requêtes vers l’Engagement API. Les access tokens doivent être utilisés pour représenter l’« utilisateur actuel », et les requêtes effectuées au nom d’un autre utilisateur doivent être signées avec un jeton valide. Assurez-vous d’[encoder les caractères réservés](https://tools.ietf.org/html/rfc3986) correctement dans les URL et les corps de requête POST avant de préparer les chaînes de base de la signature OAuth.

Pour plus d’informations sur la mise en route avec OAuth, veuillez consulter les liens suivants :

* [Aperçu d’OAuth](/fr/resources/fundamentals/authentication)
* [Utiliser le 3-Legged OAuth, aussi appelé User Context](/fr/resources/fundamentals/authentication#obtaining-access-tokens-using-3-legged-oauth-flow)
* [Utiliser l’Application-Only OAuth](/fr/resources/fundamentals/authentication#bearer-token-also-known-as-app-only)

<div id="post-insightsengagementtotals">
  #### **POST /insights/engagement/totals**
</div>

L’endpoint totals permet de récupérer, en une seule requête, le nombre total actuel d’impressions et d’engagements pour un ensemble pouvant aller jusqu’à 250 Tweets.

|     |     |
| :--- | :--- |
| **Méthode de requête** | HTTP POST |
| **URL** | `https://data-api.x.com/insights/engagement/totals` |
| **Type de contenu** | `application/json` |
| **Compression** | Gzip. Pour effectuer une requête avec compression Gzip, envoyez un en-tête Accept-Encoding dans la requête.  <br />L’en-tête doit être le suivant :  <br />  <br />`Accept-Encoding: gzip` |
| **Format POST** | Les requêtes peuvent être envoyées en POST, avec un corps qui est un objet JSON contenant une collection d’identifiants de Tweet et un mode de regroupement souhaité. La requête POST est structurée sous forme de tableau avec des objets `tweets`, `engagements` et `groupings`. Chaque requête peut contenir au maximum 250 identifiants de Tweet.  <br />  <br />Exemple de corps POST :  <br />  <br /><br />  &#123;<br />    &quot;tweet_ids&quot;: [<br />        &quot;ID de Tweet 1&quot;,<br />        &quot;ID de Tweet 2&quot;,<br />        &quot;ID de Tweet 3&quot;<br />    ],<br />      &quot;engagement_types&quot;: [<br />        &quot;impressions&quot;,<br />        &quot;engagements&quot;,<br />        &quot;favorites&quot;,<br />        &quot;quote_tweets&quot;<br />    ],<br />    &quot;groupings&quot;: &#123;<br />      &quot;nom du regroupement&quot;: &#123;<br />        &quot;group_by&quot;: [<br />          &quot;tweet.id&quot;,<br />          &quot;engagement.type&quot;<br />        ]<br />      &#125;<br />    &#125;<br />  &#125; |
| **Identifiants de Tweet** | Un tableau contenant les identifiants des Tweets pour lesquels récupérer les données d’engagement. Notez que vous ne pouvez demander des données que pour les Tweets créés par le @handle d’authentification. Jusqu’à 250 Tweets peuvent être inclus par requête, et les identifiants de Tweet doivent être représentés sous forme de chaînes. |
| **Types d’engagement** | Un tableau contenant les types d’indicateurs d’engagement à récupérer. Le point de terminaison Totals ne prend en charge que les types d’engagement suivants : `impressions`, `engagements`, `favorites`, `retweets`, `quote_tweets`, `replies`, `video_views`.  <br />Le point de terminaison `/totals` permet de récupérer `impressions` et `engagements` pour les Tweets créés au cours des 90 derniers jours, et `favorites`, `retweets`, `quote_tweets`, `replies` et `video_views` pour n’importe quel Tweet. |
| **Regroupements** | Les résultats de l’API Engagement peuvent être renvoyés sous différents regroupements pour mieux répondre à vos besoins. Vous pouvez inclure au maximum 3 regroupements par requête.  <br />  <br />Pour chaque regroupement, vous pouvez définir un nom personnalisé afin de faciliter la référence à ce type de regroupement dans votre application.  <br />  <br />Une fois le nom de regroupement défini, vous pouvez choisir de regrouper par `tweet.id` et/ou `engagement.type`.  <br />  <br />Les regroupements sont appliqués séquentiellement, ce qui vous permet de modifier le format de résultat souhaité en changeant l’ordre des valeurs de `group_by`. Un exemple de regroupement qui affiche des métriques séparées par identifiant de Tweet et type de métrique ressemble à ceci :  <br />  <br /><br />  &quot;groupings&quot;: &#123;<br />      &quot;mon nom de regroupement&quot;: &#123;<br />        &quot;group_by&quot;: [<br />          &quot;tweet.id&quot;,<br />          &quot;engagement.type&quot;<br />        ]<br />      &#125;<br />    &#125; |
| **Limite de taille POST** | Les requêtes peuvent porter sur un maximum de 250 identifiants de Tweet à la fois. |
| **Format de réponse** | JSON. L’en-tête de votre requête doit spécifier le format JSON pour la réponse. |
| **Limitation de débit** | Vous serez soumis à une limitation par minute, comme spécifié dans votre contrat selon votre niveau d’accès. |
| **Exemple de requête (métriques publiques)** | curl --request POST <br />  --url https://data-api.x.com/insights/engagement/totals <br />  --header &#39;accept-encoding: gzip&#39; <br />  --header &#39;authorization: Bearer &#39; <br />  --header &#39;content-type: application/json&#39; <br />  --data &#39;&#123;<br />                &quot;tweet_ids&quot;: [<br />                    &quot;1070059276213702656&quot;,&quot;1021817816134156288&quot;,&quot;1067094924124872705&quot;<br />                ],<br />                &quot;engagement_types&quot;: [<br />                    &quot;favorites&quot;,&quot;retweets&quot;,&quot;replies&quot;,&quot;quote_tweets&quot;,&quot;video_views&quot;<br />                ],<br />                &quot;groupings&quot;: &#123;<br />                    &quot;perTweetMetricsUnowned&quot;: &#123;<br />                        &quot;group_by&quot;: [<br />                            &quot;tweet.id&quot;,<br />                            &quot;engagement.type&quot;<br />                        ]<br />                    &#125;<br />                &#125;<br />            &#125; <br />  --verbose <br />  --compressed |
| **Exemple de requête** | curl --request POST <br />  --url https://data-api.x.com/insights/engagement/totals <br />  --header &#39;accept-encoding: gzip&#39; <br />  --header &#39;authorization: OAuth oauth_consumer_key=&quot;consumer-key-for-app&quot;,oauth_nonce=&quot;generated-nonce&quot;,oauth_signature=&quot;generated-signature&quot;,oauth_signature_method=&quot;HMAC-SHA1&quot;, oauth_timestamp=&quot;generated-timestamp&quot;,oauth_token=&quot;access-token-for-authed-user&quot;, oauth_version=&quot;1.0&quot;&#39; <br />  --header &#39;content-type: application/json&#39; <br />  --data &#39;&#123;<br />                &quot;tweet_ids&quot;: [<br />                    &quot;1060976163948904448&quot;,&quot;1045709644067471360&quot;<br />                ],<br />                &quot;engagement_types&quot;: [<br />                    &quot;favorites&quot;,&quot;replies&quot;,&quot;retweets&quot;,&quot;video_views&quot;,&quot;impressions&quot;,&quot;engagements&quot;<br />                ],<br />                &quot;groupings&quot;: &#123;<br />                    &quot;perTweetMetricsOwned&quot;: &#123;<br />                        &quot;group_by&quot;: [<br />                            &quot;tweet.id&quot;,<br />                            &quot;engagement.type&quot;<br />                        ]<br />                    &#125;<br />                &#125;<br />            &#125;&#39; <br />  --verbose <br />  --compressed |
| **Exemple de réponse (métriques publiques)** | &#123;<br />  &quot;perTweetMetricsUnowned&quot;: &#123;<br />    &quot;1021817816134156288&quot;: &#123;<br />      &quot;favorites&quot;: &quot;530&quot;,<br />      &quot;quote_tweets&quot;: &quot;79&quot;,<br />      &quot;replies&quot;: &quot;147&quot;,<br />      &quot;retweets&quot;: &quot;323&quot;,<br />      &quot;video_views&quot;: &quot;0&quot;<br />    &#125;,<br />    &quot;1067094924124872705&quot;: &#123;<br />      &quot;favorites&quot;: &quot;1360&quot;,<br />      &quot;quote_tweets&quot;: &quot;29&quot;,<br />      &quot;replies&quot;: &quot;56&quot;,<br />      &quot;retweets&quot;: &quot;178&quot;,<br />      &quot;video_views&quot;: &quot;5754512&quot;<br />    &#125;,<br />    &quot;1070059276213702656&quot;: &#123;<br />      &quot;favorites&quot;: &quot;69&quot;,<br />      &quot;quote_tweets&quot;: &quot;5&quot;,<br />      &quot;replies&quot;: &quot;7&quot;,<br />      &quot;retweets&quot;: &quot;26&quot;,<br />      &quot;video_views&quot;: &quot;0&quot;<br />    &#125;<br />  &#125;<br />&#125; |
| **Exemple de réponse** | &#123;<br />  &quot;perTweetMetricsOwned&quot;: &#123;<br />    &quot;1045709644067471360&quot;: &#123;<br />      &quot;engagements&quot;: &quot;2&quot;,<br />      &quot;favorites&quot;: &quot;0&quot;,<br />      &quot;impressions&quot;: &quot;47&quot;,<br />      &quot;replies&quot;: &quot;0&quot;,<br />      &quot;retweets&quot;: &quot;8&quot;,<br />      &quot;quote_tweets&quot;: &quot;5&quot;,<br />      &quot;video_views&quot;: &quot;0&quot;<br />    &#125;,<br />    &quot;1060976163948904448&quot;: &#123;<br />      &quot;engagements&quot;: &quot;4&quot;,<br />      &quot;favorites&quot;: &quot;0&quot;,<br />      &quot;impressions&quot;: &quot;148&quot;,<br />      &quot;replies&quot;: &quot;1&quot;,<br />      &quot;retweets&quot;: &quot;9&quot;,<br />      &quot;quote_tweets&quot;: &quot;2&quot;,<br />      &quot;video_views&quot;: &quot;0&quot;<br />    &#125;<br />  &#125;<br />&#125; |
| **Identifiants de Tweets indisponibles** | Pour les requêtes incluant des identifiants de Tweets devenus indisponibles (par exemple, supprimés), des données appropriées seront renvoyées pour tous les identifiants de Tweets disponibles, et les identifiants de Tweets indisponibles seront répertoriés dans un tableau nommé `unavailable_tweet_ids`. Par exemple :  <br /><br />  &#123;<br />    &quot;start&quot;: &quot;2015-11-17T22:00:00Z&quot;,<br />    &quot;end&quot;: &quot;2015-11-19T02:00:00Z&quot;,<br />    &quot;unavailable_tweet_ids&quot;: [<br />        &quot;323456789&quot;<br />    ],<br />    &quot;group1&quot;: &#123;<br />     &quot;423456789&quot;: &#123;<br />      &quot;favorites&quot;: &quot;67&quot;,<br />      &quot;replies&quot;: &quot;8&quot;,<br />      &quot;retweets&quot;: &quot;26&quot;,<br />      &quot;quote_tweets&quot;: &quot;2&quot;<br />     &#125;<br />    &#125;<br />  &#125; |

<div id="post-insightsengagement28hr">
  #### **POST /insights/engagement/28hr**
</div>

Le point de terminaison « 28 heures » permet de récupérer les impressions et les engagements pour un ensemble de jusqu’à 25 Tweets sur les 28 dernières heures. Il permet également de demander toutes les métriques individuelles prises en charge. Pour la liste complète des métriques prises en charge, consultez [Disponibilité des métriques](https://developer.x.com/en/docs/x-api/v1/metrics/get-tweet-engagement/overview#EngagementTypes).

|     |     |
| :--- | :--- |
| **Méthode de requête** | HTTP POST |
| **URL** | `https://data-api.x.com/insights/engagement/28hr` |
| **Type de contenu** | `application/json` |
| **Compression** | Gzip. Pour effectuer une requête avec compression Gzip, envoyez un en-tête Accept-Encoding dans la requête.  <br />L’en-tête doit être au format suivant :  <br />  <br />`Accept-Encoding: gzip` |
| **Format POST** | Les requêtes peuvent être envoyées en POST, avec un corps composé d’un objet JSON contenant une collection d’ID de Tweet et un regroupement souhaité. Le POST est formaté comme un tableau avec des objets `tweets`, `engagements` et `groupings`. Chaque requête peut contenir au maximum 25 ID de Tweet.  <br />  <br />Exemple de corps de POST :  <br />  <br /><br />  &#123;<br />    &quot;tweet_ids&quot;: [<br />       &quot;ID de Tweet 1&quot;,<br />       &quot;ID de Tweet 2&quot;,<br />       &quot;ID de Tweet 3&quot;<br />    ],<br />      &quot;engagement_types&quot;: [<br />        &quot;impressions&quot;,<br />        &quot;engagements&quot;,<br />        &quot;url_clicks&quot;,<br />        &quot;detail_expands&quot;<br />    ],<br />    &quot;groupings&quot;: &#123;<br />      &quot;nom du regroupement&quot;: &#123;<br />        &quot;group_by&quot;: [<br />          &quot;tweet.id&quot;,<br />          &quot;engagement.type&quot;,<br />          &quot;engagement.hour&quot;<br />        ]<br />      &#125;<br />    &#125;<br />  &#125; |
| **ID de Tweet** | Un tableau contenant les ID des Tweets pour lesquels interroger les données d’engagement. Notez que vous ne pouvez demander des données que pour les Tweets créés par le @handle authentifié. Le point de terminaison sur 28 heures prend en charge jusqu’à 25 Tweets par requête, et les ID de Tweet doivent être fournis sous forme de chaînes. |
| **Types d’engagement** | Un tableau des types de métriques d’engagement à interroger.  <br />  <br />Pour le point de terminaison sur 28 heures, `impressions`, `engagements` et tous les types d’engagement individuels sont des métriques prises en charge. Pour la liste complète des métriques d’engagement prises en charge, voir [Engagement Data](https://developer.x.com/en/docs/x-api/v1/metrics/get-tweet-engagement/overview#AvailableData). |
| **Regroupements** | Les résultats de l’API Engagement peuvent être renvoyés sous différents regroupements pour répondre au mieux à vos besoins. Vous pouvez inclure au maximum 3 regroupements par requête.  <br />  <br />Pour chaque regroupement, vous pouvez définir un nom personnalisé afin de faciliter sa référence dans votre application. Une fois le nom défini, vous pouvez regrouper selon une ou plusieurs des valeurs suivantes :  <br />`tweet.id`  <br />`engagement.type`  <br />`engagement.day`  <br />`engagement.hour`  <br />Les regroupements sont appliqués séquentiellement, ce qui vous permet de modifier le format de résultat souhaité en changeant l’ordre de vos valeurs `group_by`. Exemple de regroupement qui affichera des métriques séparées par ID de Tweet et type de métrique : <br /><br />  &quot;groupings&quot;: &#123;<br />    &quot;mon nom de regroupement&quot;: &#123;<br />      &quot;group_by&quot;: [<br />        &quot;tweet.id&quot;,<br />        &quot;engagement.type&quot;,<br />        &quot;engagement.day&quot;<br />      ]<br />    &#125;<br />  &#125;<br /><br />  <br />Les regroupements comportant 4 éléments `group_by` ne sont valides que s’ils utilisent l’un des deux ordres suivants. Les requêtes ayant 4 éléments `group_by` dans un même regroupement qui ne correspondent pas à l’un des ordres ci-dessous renverront une erreur. De plus, un seul regroupement avec 4 éléments `group_by` est autorisé par requête.  <br /><br />&quot;group_by&quot;: [<br />    &quot;tweet.id&quot;,<br />    &quot;engagement.type&quot;,<br />    &quot;engagement.day&quot;,<br />    &quot;engagement.hour&quot;<br />  ]<br /><br />&quot;group_by&quot;: [<br />    &quot;engagement.type&quot;,<br />    &quot;tweet.id&quot;,<br />    &quot;engagement.day&quot;,<br />    &quot;engagement.hour&quot;<br />  ] |
| **Limite de taille du POST** | Les requêtes peuvent inclure jusqu’à 25 ID de Tweet à la fois. |
| **Format de réponse** | JSON. L’en-tête de votre requête doit indiquer le format JSON pour la réponse. |
| **Limitation de débit** | Vous serez limité à la minute, comme spécifié dans votre contrat selon votre niveau d’accès. |
| **Exemple de requête** | curl -X POST &quot;https://data-api.x.com/insights/engagement/28hr&quot; <br />  -H &#39;Accept-Encoding: gzip&#39; <br />  -H &#39;Authorization OAuth oauth_consumer_key=&quot;consumer-key-for-app&quot;,oauth_nonce=&quot;generated-nonce&quot;,oauth_signature=&quot;generated-signature&quot;,oauth_signature_method=&quot;HMAC-SHA1&quot;, oauth_timestamp=&quot;generated-timestamp&quot;,oauth_token=&quot;access-token-for-authed-user&quot;, oauth_version=&quot;1.0&quot;&#39; <br />  -d &#39;&#123;<br />    &quot;tweet_ids&quot;: [<br />       &quot;123456789&quot;<br />    ],<br />      &quot;engagement_types&quot;: [<br />        &quot;impressions&quot;,<br />        &quot;engagements&quot;<br />    ],<br />    &quot;groupings&quot;: &#123;<br />      &quot;hourly-time-series&quot;: &#123;<br />        &quot;group_by&quot;: [<br />          &quot;tweet.id&quot;,<br />          &quot;engagement.type&quot;,<br />          &quot;engagement.day&quot;,<br />          &quot;engagement.hour&quot;<br />        ]<br />      &#125;<br />    &#125;<br />  &#125;&#39; |
| **Exemple de réponse** | &#123;<br />    &quot;start&quot;: &quot;2015-09-14T17:00:00Z&quot;,<br />    &quot;end&quot;: &quot;2015-09-15T22:00:00Z&quot;,<br />    &quot;hourly-time-series&quot;: &#123;<br />      &quot;123456789&quot;: &#123;<br />        &quot;impressions&quot;: &#123;<br />          &quot;2015-09-14&quot;: &#123;<br />            &quot;17&quot;: &quot;551&quot;,<br />            &quot;18&quot;: &quot;412&quot;,<br />            &quot;19&quot;: &quot;371&quot;,<br />            &quot;20&quot;: &quot;280&quot;,<br />            &quot;21&quot;: &quot;100&quot;,<br />            &quot;22&quot;: &quot;19&quot;,<br />            &quot;23&quot;: &quot;6&quot;<br />          &#125;,<br />          &quot;2015-09-15&quot;: &#123;<br />            &quot;00&quot;: &quot;5&quot;,<br />            &quot;01&quot;: &quot;2&quot;,<br />            &quot;02&quot;: &quot;7&quot;,<br />            &quot;03&quot;: &quot;3&quot;,<br />            &quot;04&quot;: &quot;1&quot;,<br />            &quot;05&quot;: &quot;0&quot;,<br />            &quot;06&quot;: &quot;0&quot;,<br />            &quot;07&quot;: &quot;0&quot;,<br />            &quot;08&quot;: &quot;0&quot;,<br />            &quot;09&quot;: &quot;0&quot;,<br />            &quot;10&quot;: &quot;0&quot;,<br />            &quot;11&quot;: &quot;0&quot;,<br />            &quot;12&quot;: &quot;0&quot;,<br />            &quot;13&quot;: &quot;0&quot;,<br />            &quot;14&quot;: &quot;0&quot;,<br />            &quot;15&quot;: &quot;0&quot;,<br />            &quot;16&quot;: &quot;0&quot;,<br />            &quot;17&quot;: &quot;0&quot;,<br />            &quot;18&quot;: &quot;0&quot;,<br />            &quot;19&quot;: &quot;0&quot;,<br />            &quot;20&quot;: &quot;0&quot;,<br />            &quot;21&quot;: &quot;0&quot;<br />          &#125;<br />        &#125;,<br />        &quot;engagements&quot;: &#123;<br />          &quot;2015-09-14&quot;: &#123;<br />            &quot;17&quot;: &quot;0&quot;,<br />            &quot;18&quot;: &quot;0&quot;,<br />            &quot;19&quot;: &quot;0&quot;,<br />            &quot;20&quot;: &quot;0&quot;,<br />            &quot;21&quot;: &quot;0&quot;,<br />            &quot;22&quot;: &quot;0&quot;,<br />            &quot;23&quot;: &quot;0&quot;<br />          &#125;,<br />          &quot;2015-09-15&quot;: &#123;<br />            &quot;00&quot;: &quot;0&quot;,<br />            &quot;01&quot;: &quot;0&quot;,<br />            &quot;02&quot;: &quot;0&quot;,<br />            &quot;03&quot;: &quot;0&quot;,<br />            &quot;04&quot;: &quot;0&quot;,<br />            &quot;05&quot;: &quot;0&quot;,<br />            &quot;06&quot;: &quot;0&quot;,<br />            &quot;07&quot;: &quot;0&quot;,<br />            &quot;08&quot;: &quot;0&quot;,<br />            &quot;09&quot;: &quot;0&quot;,<br />            &quot;10&quot;: &quot;0&quot;,<br />            &quot;11&quot;: &quot;0&quot;,<br />            &quot;12&quot;: &quot;0&quot;,<br />            &quot;13&quot;: &quot;0&quot;,<br />            &quot;14&quot;: &quot;0&quot;,<br />            &quot;15&quot;: &quot;0&quot;,<br />            &quot;16&quot;: &quot;0&quot;,<br />            &quot;17&quot;: &quot;0&quot;,<br />            &quot;18&quot;: &quot;0&quot;,<br />            &quot;19&quot;: &quot;0&quot;,<br />            &quot;20&quot;: &quot;0&quot;,<br />            &quot;21&quot;: &quot;0&quot;<br />          &#125;<br />        &#125;<br />      &#125;<br />    &#125;<br />  &#125; |
| **IDs de Tweets indisponibles** | Pour les requêtes qui incluent des IDs de Tweets devenus indisponibles (p. ex., supprimés), des données appropriées seront renvoyées pour tous les IDs de Tweets disponibles, et les IDs de Tweets indisponibles seront listés dans un tableau appelé `unavailable_tweet_ids`. Par exemple :  <br /><br />  &#123;<br />    &quot;start&quot;: &quot;2015-11-17T22:00:00Z&quot;,<br />    &quot;end&quot;: &quot;2015-11-19T02:00:00Z&quot;,<br />    &quot;unavailable_tweet_ids&quot;: [<br />        &quot;323456789&quot;<br />    ],<br />    &quot;group1&quot;: &#123;<br />     &quot;423456789&quot;: &#123;<br />      &quot;favorites&quot;: &quot;67&quot;,<br />      &quot;replies&quot;: &quot;8&quot;,<br />      &quot;retweets&quot;: 26<br />     &#125;<br />    &#125;<br />  &#125; |

<div id="post-insightsengagementhistorical">
  #### **POST /insights/engagement/historical**
</div>

Le point de terminaison historique permet de récupérer les impressions et les engagements pour un ensemble allant jusqu’à 25 Tweets sur toute période d’une durée maximale de 4 semaines. Actuellement, les données antérieures au 1er septembre 2014 ne peuvent pas être demandées via l’API. Le point de terminaison historique permet également de demander des mesures pour toutes les métriques individuelles prises en charge. Pour la liste complète des métriques prises en charge, consultez la page [Disponibilité des métriques](https://developer.x.com/en/docs/x-api/v1/metrics/get-tweet-engagement/overview#EngagementTypes).

|     |     |
| :--- | :--- |
| **Méthode de requête** | HTTP POST |
| **URL** | `https://data-api.x.com/insights/engagement/historical` |
| **Type de contenu** | `application/json` |
| **Compression** | Gzip. Pour effectuer une requête avec la compression Gzip, envoyez un en-tête Accept-Encoding dans la requête.  <br />L’en-tête doit être le suivant :  <br />  <br />`Accept-Encoding: gzip` |
| **Format POST** | Les requêtes peuvent être envoyées en POST avec un corps JSON contenant une collection d’identifiants de Tweets et un regroupement souhaité. Le POST est structuré comme un tableau comprenant les objets `tweets`, `engagements` et `groupings`. Chaque requête peut inclure au maximum 25 identifiants de Tweet. Chaque requête peut spécifier une date de début et de fin personnalisées d’une durée maximale de quatre semaines.  <br />  <br /><br />  &#123;<br />    &quot;tweet_ids&quot;: [<br />       &quot;Tweet ID 1&quot;,<br />       &quot;Tweet ID 2&quot;,<br />       &quot;Tweet ID 3&quot;<br />    ],<br />      &quot;engagement_types&quot;: [<br />        &quot;impressions&quot;,<br />        &quot;engagements&quot;,<br />        &quot;url_clicks&quot;,<br />        &quot;detail_expands&quot;<br />    ],<br />    &quot;groupings&quot;: &#123;<br />      &quot;grouping name&quot;: &#123;<br />        &quot;group_by&quot;: [<br />          &quot;tweet.id&quot;,<br />          &quot;engagement.type&quot;,<br />          &quot;engagement.hour&quot;<br />        ]<br />      &#125;<br />    &#125;<br />  &#125; |
| **Date de début et de fin** | Vous pouvez indiquer des dates de début et de fin personnalisées avec les paramètres `start` et `end` dans la requête. La période ne doit pas dépasser 4 semaines. La date de début la plus ancienne possible à ce jour est le 1er septembre 2014. Les dates de fin dans le futur ne sont pas prises en charge. Si aucune date de début et de fin n’est fournie, l’API utilise par défaut les 4 semaines immédiatement précédentes.  <br />  <br />La granularité minimale des données renvoyées par l’API Engagement est l’heure. Pour toute requête dont les valeurs start ou end ne tombent pas exactement sur une borne horaire, la requête sera ajustée à l’heure inclusive la plus proche. Par exemple, une requête avec &quot;start&quot;:&quot;2015-07-01T12:24:00Z&quot; et &quot;end&quot;:&quot;2015-07-10T08:37:00Z&quot; sera ajustée en &quot;start&quot;:&quot;2015-07-01T12:00:00Z&quot;,&quot;end&quot;:&quot;2015-07-10T09:00:00Z&quot;. |
| **Identifiants de Tweet** | Un tableau contenant les identifiants des Tweets pour lesquels récupérer les données d’engagement. Notez que vous ne pouvez demander des données que pour des Tweets créés par le @handle authentifié. Le point de terminaison historique sur 4 semaines prend en charge jusqu’à 25 Tweets par requête, et les identifiants de Tweet doivent être fournis sous forme de chaînes. |
| **Types d’engagement** | Un tableau contenant les types de métriques d’engagement à interroger.  <br />  <br />Pour le point de terminaison historique sur 4 semaines, `impressions`, `engagements` et tous les types d’engagement individuels sont pris en charge. Pour la liste complète des métriques d’engagement prises en charge, voir [Engagement Data](https://developer.x.com/en/docs/x-api/v1/metrics/get-tweet-engagement/overview#AvailableData).  <br />  <br />**Remarque :** Actuellement, trois métriques s’affichent à zéro pour les requêtes antérieures au 15 septembre 2015 : `favorites`, `replies` et `retweets`. |
| **Regroupements** | Les résultats de l’Engagement API peuvent être renvoyés dans différents regroupements pour s’adapter au mieux à vos besoins. Vous pouvez inclure au maximum 3 regroupements par requête.  <br />  <br />Pour chaque regroupement, vous pouvez définir un nom personnalisé afin de faciliter le repérage de ce type de regroupement dans votre application. Une fois que vous avez défini un nom de regroupement, vous pouvez choisir de regrouper selon une ou plusieurs des valeurs suivantes :  <br />`tweet.id`  <br />`engagement.type`  <br />`engagement.day`  <br />`engagement.hour`  <br />Les regroupements sont appliqués dans l’ordre, ce qui vous permet de modifier le format de résultat souhaité en changeant l’ordre de vos valeurs group_by. Voici un exemple de regroupement qui affiche des métriques séparées par ID de Tweet, type de métrique et jour :<br /><br />  &quot;groupings&quot;: &#123;<br />    &quot;mon nom de regroupement&quot;: &#123;<br />      &quot;group_by&quot;: [<br />        &quot;tweet.id&quot;,<br />        &quot;engagement.type&quot;,<br />        &quot;engagement.day&quot;<br />      ]<br />    &#125;<br />  &#125;<br /><br />  <br />Les regroupements comportant 4 éléments `group_by` ne sont valides que s’ils utilisent l’un des deux ordres suivants. Les requêtes comportant 4 éléments `group_by` dans un seul regroupement qui ne correspondent pas à l’un des ordres ci-dessous renverront une erreur. En outre, une seule occurrence de regroupement avec 4 éléments `group_by` est autorisée par requête.  <br /><br />&quot;group_by&quot;: [<br />    &quot;tweet.id&quot;,<br />    &quot;engagement.type&quot;,<br />    &quot;engagement.day&quot;,<br />    &quot;engagement.hour&quot;<br />  ]<br /><br />&quot;group_by&quot;: [<br />    &quot;engagement.type&quot;,<br />    &quot;tweet.id&quot;,<br />    &quot;engagement.day&quot;,<br />    &quot;engagement.hour&quot;<br />  ] |
| **Limite de taille POST** | Les requêtes peuvent porter sur un maximum de 25 ID de Tweet à la fois. |
| **Format de réponse** | JSON. L’en-tête de votre requête doit spécifier le format JSON pour la réponse. |
| **Limite de débit** | Vous ferez l’objet d’une limitation par minute, comme spécifié dans votre contrat selon votre niveau d’accès. |
| **Exemple de requête** | curl -XPOST &quot;https://data-api.x.com/insights/engagement/historical&quot; <br />  -H &#39;Accept-Encoding: gzip&#39; <br />  -H &#39;Authorization OAuth oauth_consumer_key=&quot;consumer-key-for-app&quot;,oauth_nonce=&quot;generated-nonce&quot;,oauth_signature=&quot;generated-signature&quot;,oauth_signature_method=&quot;HMAC-SHA1&quot;, oauth_timestamp=&quot;generated-timestamp&quot;,oauth_token=&quot;access-token-for-authed-user&quot;, oauth_version=&quot;1.0&quot;&#39; <br />  -d &#39;&#123;<br />    &quot;start&quot;: &quot;2015-08-01&quot;,<br />    &quot;end&quot;: &quot;2015-08-15&quot;,<br />    &quot;tweet_ids&quot;: [<br />       &quot;123456789&quot;,<br />       &quot;223456789&quot;,<br />       &quot;323456789&quot;<br />    ],<br />      &quot;engagement_types&quot;: [<br />        &quot;impressions&quot;,<br />        &quot;engagements&quot;,<br />        &quot;url_clicks&quot;,<br />        &quot;detail_expands&quot;<br />    ],<br />    &quot;groupings&quot;: &#123;<br />      &quot;types-by-tweet-id&quot;: &#123;<br />        &quot;group_by&quot;: [<br />          &quot;tweet.id&quot;,<br />          &quot;engagement.type&quot;<br />        ]<br />      &#125;<br />    &#125;<br />  &#125;&#39; |
| **Exemple de réponse** | &#123;<br />    &quot;start&quot;: &quot;2015-08-01T00:00:00Z&quot;,<br />    &quot;end&quot;: &quot;2015-08-15T00:00:00Z&quot;,<br />    &quot;types-by-tweet-id&quot;: &#123;<br />      &quot;123456789&quot;: &#123;<br />        &quot;impressions&quot;: &quot;0&quot;,<br />        &quot;engagements&quot;: &quot;0&quot;,<br />        &quot;url_clicks&quot;: &quot;0&quot;,<br />        &quot;detail_expands&quot;: &quot;0&quot;<br />      &#125;,<br />      &quot;223456789&quot;: &#123;<br />        &quot;impressions&quot;: &quot;788&quot;,<br />        &quot;engagements&quot;: &quot;134&quot;,<br />        &quot;url_clicks&quot;: &quot;30&quot;,<br />        &quot;detail_expands&quot;: &quot;1323&quot;<br />      &#125;,<br />      &quot;323456789&quot;: &#123;<br />        &quot;impressions&quot;: &quot;4&quot;,<br />        &quot;engagements&quot;: &quot;0&quot;,<br />        &quot;url_clicks&quot;: &quot;2&quot;,<br />        &quot;detail_expands&quot;: &quot;0&quot;<br />      &#125;<br />    &#125;<br />  &#125; |
| **IDs de Tweets indisponibles** | Pour les requêtes incluant des IDs de Tweet devenus indisponibles (par exemple supprimés), des données adaptées seront renvoyées pour tous les IDs de Tweet disponibles, et les IDs de Tweet indisponibles seront indiqués dans un tableau appelé `unavailable_tweet_ids`. Par exemple :<br /><br />&#123;<br />    &quot;start&quot;: &quot;2015-11-17T22:00:00Z&quot;,<br />    &quot;end&quot;: &quot;2015-11-19T02:27:50Z&quot;,<br />    &quot;unavailable_tweet_ids&quot;: [<br />        &quot;323456789&quot;<br />    ],<br />    &quot;group1&quot;: &#123;<br />     &quot;423456789&quot;: &#123;<br />      &quot;favorites&quot;: &quot;67&quot;,<br />      &quot;replies&quot;: &quot;8&quot;,<br />      &quot;retweets&quot;: 26<br />     &#125;<br />    &#125;<br />  &#125; |

<div id="response-codes">
  #### **Codes de réponse**
</div>

| Statut | Texte | Description |
| :--- | :--- | :--- |
| 200 | OK  | La requête a abouti. |
| 400 | Bad Request | En général, cette réponse survient en présence de JSON non valide dans la requête, ou lorsque aucun payload JSON n’a été envoyé. |
| 401 | Unauthorized | L’authentification HTTP a échoué en raison d’identifiants invalides. Vérifiez vos clés et jetons OAuth. |
| 404 | Not Found | La ressource est introuvable à l’URL vers laquelle la requête a été envoyée, probablement parce qu’une URL incorrecte a été utilisée. |
| 429 | Too Many Requests | Votre application a dépassé la limite de requêtes API. |
| 500 | Internal Server Error | Une erreur s’est produite du côté de Gnip. Réessayez votre requête en utilisant une stratégie de repli exponentiel. |
| 502 | Proxy Error | Une erreur s’est produite du côté de Gnip. Réessayez votre requête en utilisant une stratégie de repli exponentiel. |
| 503 | Service Unavailable | Une erreur s’est produite du côté de Gnip. Réessayez votre requête en utilisant une stratégie de repli exponentiel. |

<div id="error-messages">
  #### **Messages d’erreur**
</div>

Dans différents scénarios, l’Engagement API renvoie des messages d’erreur propres à la situation auxquels votre application doit être prête à faire face. Le tableau ci-dessous présente des exemples courants de ces messages et la manière de les interpréter. Veuillez noter que, dans de nombreux cas, l’Engagement API renvoie des résultats partiels pour les données disponibles, avec des messages d’erreur spécifiques, dans le cadre d’une réponse 200 OK fournissant des informations supplémentaires.

| Message d’erreur | Description |
| :--- | :--- |
| `"errors":["Your account could not be authenticated. Reason: Access token not found"]` | Une erreur dans le composant d’authentification de la requête. Le “Reason” doit fournir des informations utiles pour diagnostiquer l’erreur. Si vous ne parvenez pas à la résoudre, veuillez envoyer l’erreur complète, y compris le “Reason”, à notre équipe d’assistance. |
| `"errors":["1 Tweet ID(s) are unavailable"],"unavailable_tweet_ids": ["TWEET_IDS"]` | Le ou les identifiants de Tweet demandés ne sont plus disponibles, ce qui indique généralement qu’ils ont été supprimés ou ne sont plus publics pour une autre raison. |
| `"errors":["Impressions & engagements for tweets older than 90 days (*TIME_PERIOD*) are not supported"],"unsupported_for_impressions_engagements_tweet_ids":[*TWEET_IDS*]` | Le ou les identifiants de Tweet demandés pour l’endpoint /totals ont plus de 90 jours et ne peuvent donc pas retourner les métriques d’impressions ou d’engagement. |
| `"errors":["Forbidden to access tweets: *TWEET_IDS*"]` | Le ou les identifiants de Tweet demandés ne sont pas accessibles avec le jeton d’authentification que vous utilisez pour récupérer des données au nom d’un tiers. |